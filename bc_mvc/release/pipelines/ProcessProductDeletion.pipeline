<?xml version="1.0" encoding="UTF-8"?>
<!--@Group Product-->

<pipeline:Pipeline xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:pipeline="http://www.intershop.de/pipeline/2010"
    name="ProcessProductDeletion" type="process">
<!--preference: 'DeleteMultipleProductsBlockSize'
\- defines the size of a block with products
\- products will be removed block by block
@Location 15,38-->
  <nodes xsi:type="pipeline:Text" nodeID="Text0"/>
<!--remove 

old price scales
@Location 9,31-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode1"/>
<!--Get the repository for the
given product.
@Location 1,2-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode10"/>
<!--Get the domain of product
history preference.
@Location 1,3-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode11"/>
<!--Get the settings for product
history usage.
@Location 1,4-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode12"/>
<!--Different handling for recycle 
bin usage (true, false).
@Location 1,5-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode13"/>
<!--Recycle bin activated, get the
recycle bin repository.
@Location 6,6-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode14"/>
<!--Get the preference for offer
propagation (move or convert offers).
@Location 6,7-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode15"/>
<!--Different handling for
offer propagation.
@Location 6,8-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode16"/>
<!--Preference is set to
"move offers to recycle bin",
delete all offers of the given
product to the recycle bin.
@Location 6,9-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode17"/>
<!--Preference is set to
"convert offers",
convert all offers of
the given product.
@Location 8,9-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode18"/>
<!--Unassign all variation products 
from the given product an reset 
the type codes if it nessesary.
@Location 6,11-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode19"/>
<!--Unassign all bundled products 
from the given product and reset 
the type codes if it nessesary.
@Location 6,12-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode20"/>
<!--Add an entry to the product
history if it enabled.

@Location 6,16-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode21"/>
<!--Move the product to 
the recycle bin.
@Location 6,14-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode22"/>
<!--Recycle bin deactivated, get the deletion 
strategy from the DeletionPreferenceDomain.

@Location 4,4-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode23"/>
<!--Preference is set to
"convert offers",
convert all offers of
the given product.
@Location 10,3-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode24"/>
<!--Preference is set to
"delete all offers",
delete all offers of the given
product.
@Location 12,3-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode25"/>
<!--Preference is set to
"Forbid deletion",
return with an error code.
@Location 14,2-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode26"/>
<!--Add an entry to the product
history if it enabled.

@Location 11,10-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode27"/>
<!--Delete the product 
(alerts, prices, ..., 
and the product itself).

@Location 11,13-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode28"/>
<!--This pipeline deletes all offers 
of the given product.
@Location 16,0-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode29"/>
<!--remove alerts
@Location 9,28-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode3"/>
<!--Loop over all offers of 
the given product.
@Location 16,1-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode30"/>
<!--If the offer reference 
to the product itself 
do nothing.
@Location 16,2-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode31"/>
<!--Get the repository 
of the the offer.
@Location 16,3-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode32"/>
<!--Delete the offer only 
if it not in a 
partner channel.
@Location 16,4-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode33"/>
<!--This pipeline converts all offers 
of the given product.
@Location 29,27-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode34"/>
<!--Loop over all offers of 
the given product.
@Location 29,28-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode35"/>
<!--Get the repository 
of the the offer.
@Location 29,29-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode36"/>
<!--Convert the offer only 
if it not in a 
partner channel.
@Location 29,30-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode37"/>
<!--This pipeline checks the deletion strategy 
for the given product and 
DeletionPreferenceDomain. 
It ends in note DeleteOffers, 
ConvertOffers or ForbidDeletion.
@Location 20,0-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode38"/>
<!--Get the deletion strategy from 
the DeletionPreferenceDomain.
@Location 20,2-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode39"/>
<!--reset variation 

assignments


@Location 9,34-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode4"/>
<!--Deletion strategy is 
"Delete related offers",
return DeleteOffers.
@Location 20,4-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode40"/>
<!--Deletion strategy is 
"Convert related offers",
return ConvertOffers.
@Location 22,4-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode41"/>
<!--Deletion strategy is 
"Forbid deletion with offers".
Check offers count for 
the given product.

@Location 24,4-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode42"/>
<!--This pipeline returns the product history 
preference domain for the given 
product repository.
@Location 33,27-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode43"/>
<!--Product has offers or is shared, 
return ForbidDeletion with error 
code ProductDeletionFailed.
@Location 26,8-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode44"/>
<!--If the repository a master
return the owning domain 
as PreferenceDomain.

@Location 33,29-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode45"/>
<!--If the repository a channel
return the domain of the channel 
as PreferenceDomain.

@Location 35,30-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode46"/>
<!--If the repository a recycle bin
return the domain of his product
repository as PreferenceDomain.

@Location 37,31-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode47"/>
<!--reset retailset

assignments


@Location 9,35-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode5"/>
<!--Reset type code 
"Variation Master" for 
the master product.
@Location 0,28-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode51"/>
<!--Set type code 
"Item" for the master 
product.
@Location 0,29-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode52"/>
<!--Check if the master product 
itself a variation product
@Location 1,30-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode53"/>
<!--Store the product master.
@Location 1,31-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode54"/>
<!--Remove the variation 
product from the 
product master. Type code
of the variation product
is reseted..
@Location 1,32-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode55"/>
<!--Reset type code if the 
count of variation equals 0.
@Location 1,33-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode56"/>
<!--Set type code 
"Item" for the product 
master.
@Location 1,35-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode57"/>
<!--Reset type code 
"Variation Master" for 
the  product master.
@Location 1,34-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode58"/>
<!--This pipeline unassigns all bundled products 
(bundled and part of retail set) from the 
given product an reset the type codes if it 
nessesary.
@Location 5,27-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode59"/>
<!--remove related 

productlist items
@Location 9,33-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode6"/>
<!--Loop over all 
bundled products.
@Location 5,28-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode60"/>
<!--Reset type code 
"Product Bundle" for
the master product.
@Location 5,31-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode61"/>
<!--Remove the bunded 
product from the 
master. Type code 
of the bundled 
product is reseted.
@Location 5,29-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode62"/>
<!--Set type code 
"Item" for the master 
product.
@Location 5,32-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode63"/>
<!--Check if the master product 
itself part of a product bundle.
@Location 5,33-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode64"/>
<!--Remove the master 
product from the 
product bundle. 
Type code of the master 
product is reseted..
@Location 5,34-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode65"/>
<!--Reset type code if the 
count of bundles
equals 0.
@Location 5,35-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode66"/>
<!--Set type code 
"Item" for the 
product bundle.
@Location 5,37-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode67"/>
<!--Reset type code 
"Product Bundle" for
the product bundle.
@Location 5,36-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode68"/>
<!--remove product
@Location 9,40-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode7"/>
<!--Get the preference for recycle
bin usage from the given
DeletionPreferenceDomain.
@Location 1,1-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode8"/>
<!--This pipeline deletes a product considering
the preferences for product deletion 
(RecycleBin on/off, offer propagation)
and product history. 
The pipeline checks also the product type, 
unassigns the related products and 
reset the type codes if it nessesary.
@Location 4,0-->
  <nodes xsi:type="pipeline:Text" nodeID="TextNode9"/>
<!--@Location 13,38-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode19" strict="true" name="CacheClearMultipleProductsAsBlock"
      callMode="Private">
    <nodeSuccessors name="next" next="GetDomainPreference0"/>
    <parameters name="ProcessInstantCacheClearProductsIter" type="java.util.Iterator&lt;java.lang.Object>"
        optional="true"/>
    <parameters name="ProcessInstantCacheClearProductsVector" type="java.util.Vector"
        optional="true"/>
    <parameters name="DeletionPreferenceDomain" type="com.intershop.beehive.core.capi.domain.Domain"
        optional="true"/>
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
  </nodes>
<!--GetDomainPreference 'DeleteMultipleProductsBlockSize'
@Location 13,39-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetDomainPreference0">
    <configurationValues name="DefaultPreferenceKey" value="DeleteMultipleProductsBlockSize"/>
    <configurationValues name="Type" value="Double"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetDomainPreference.xml"/>
    <nodeSuccessors name="next" next="JoinNode20"/>
<!--@BendPoints 29,79-->
    <nodeSuccessors name="pipelet_error" next="VerifyInteger0"/>
    <parameterBindings name="PreferenceDomain" objectPath="DeletionPreferenceDomain"/>
    <parameterBindings name="PreferenceKey" constant="DeleteMultipleProductsBlockSize"/>
    <returnValueBindings name="PreferenceIntValue" objectPath="MultipleProductsBlockSize"/>
  </nodes>
<!--@Location 13,40-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode20">
    <nodeSuccessors name="next" next="AddObjectToVector0"/>
  </nodes>
<!--@Location 13,41-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector0">
    <configurationValues name="Mode" value="Forbid Duplicates"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
    <nodeSuccessors name="next" next="KeyMapper2"/>
    <parameterBindings name="InVector" objectPath="ProcessInstantCacheClearProductsVector"/>
    <parameterBindings name="Object" objectPath="Product"/>
    <parameterBindings name="Objects" nullBinding="true"/>
    <returnValueBindings name="Iterator" objectPath="ProcessInstantCacheClearProductsIter"/>
    <returnValueBindings name="OutVector" objectPath="ProcessInstantCacheClearProductsVector"/>
  </nodes>
<!--@Location 13,42-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper2">
    <configurationValues name="ValueType" value="Dictionary Value"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="DecisionNode21"/>
    <parameterBindings name="InValue_1" objectPath="Product:ProductRef"/>
    <returnValueBindings name="OutValue_1" objectPath="ProductRef"/>
  </nodes>
<!--@Location 13,43-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode21" conditionKey="ProcessInstantCacheClearProductsVector:Size"
      operator="gte" conditionItem="MultipleProductsBlockSize">
<!--@BendPoints 28,87-->
    <nodeSuccessors name="decision_yes" next="CallNode35"/>
    <nodeSuccessors name="decision_no" next="JoinNode26"/>
  </nodes>
<!--@Location 14,44-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode35">
<!--@BendPoints 29,90-->
    <nodeSuccessors name="next" next="AddObjectToVector2"/>
    <nodeSuccessors name="Error" next="JoinNode26"/>
    <startNode referencedName="ProcessProductDeletion-InstantCacheClearMultipleProducts"/>
  </nodes>
<!--@Location 14,45-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector2">
    <configurationValues name="Mode" value="Forbid Duplicates"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
<!--@BendPoints 28,92-->
    <nodeSuccessors name="next" next="JoinNode26"/>
    <parameterBindings name="InVector" nullBinding="true"/>
    <parameterBindings name="Object" nullBinding="true"/>
    <parameterBindings name="Objects" nullBinding="true"/>
    <returnValueBindings name="Iterator" objectPath="ProcessInstantCacheClearProductsIter"/>
    <returnValueBindings name="OutVector" objectPath="ProcessInstantCacheClearProductsVector"/>
  </nodes>
<!--@Location 13,45-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode26">
<!--@BendPoints 27,92-->
    <nodeSuccessors name="next" next="EndNode25"/>
  </nodes>
<!--@Location 13,46-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode25" strict="true">
    <returnValues name="ProcessInstantCacheClearProductsIter" type="java.util.Iterator"
        optional="true"/>
    <returnValues name="ProcessInstantCacheClearProductsVector" type="java.util.Vector"
        optional="true"/>
    <returnValues name="ProductRef" type="com.intershop.beehive.xcs.common.ProductRef"/>
  </nodes>
<!--@Location 14,40-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="VerifyInteger0">
    <pipelet href="enfinity:/bc_foundation/pipelets/VerifyInteger.xml"/>
    <nodeSuccessors name="next" next="JoinNode20"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode20"/>
    <parameterBindings name="LocalizedString" constant="100"/>
    <returnValueBindings name="IntegerObject" objectPath="MultipleProductsBlockSize"/>
  </nodes>
<!--A private branch that, cleans up the assignments that are controlled by this cartridge.
@Location 37,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode23" strict="true" visibility="Private"
      name="CleanUpKnownAssignments" callMode="Private">
    <nodeSuccessors name="next" next="CallNode14"/>
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
    <parameters name="Domains" type="java.util.Collection" optional="true"/>
  </nodes>
<!--@Location 37,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode14">
    <nodeSuccessors name="next" next="DecisionNode18" action="store"/>
    <startNode referencedName="ProcessProductDeletion-DeleteProductProductLinks"/>
  </nodes>
<!--@Location 37,2-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode18" conditionKey="Domains">
    <nodeSuccessors name="decision_yes" next="UnshareBundleAssignments0"/>
<!--@BendPoints 77,5 77,11-->
    <nodeSuccessors name="decision_no" next="JoinNode29"/>
  </nodes>
<!--@Location 37,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UnshareBundleAssignments0">
    <configurationValues name="CheckSharing" value="false"/>
    <pipelet href="enfinity:/xcs/pipelets/UnshareBundleAssignments.xml"/>
    <nodeSuccessors name="next" next="UnshareProductCompleteness0"/>
    <parameterBindings name="ProductID" objectPath="Product:UUID"/>
    <parameterBindings name="TargetDomains" objectPath="Domains"/>
  </nodes>
<!--@Location 37,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UnshareProductCompleteness0">
    <pipelet href="enfinity:/xcs/pipelets/UnshareProductCompleteness.xml"/>
    <nodeSuccessors name="next" next="JoinNode29"/>
    <parameterBindings name="Product" objectPath="Product"/>
    <parameterBindings name="TargetDomains" objectPath="Domains"/>
  </nodes>
<!--@Location 37,5-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode29">
    <nodeSuccessors name="next" next="EndNode27"/>
  </nodes>
<!--@Location 37,6-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode27" strict="true"/>
<!--@Location 35,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode22" strict="true" name="CleanUpProductAssignments"
      callMode="Private">
    <nodeSuccessors name="next" next="ExtensionPointNode0"/>
<!--The domains for which the product assignments should be processed. If the collection is undefined or empty, assignments should be cleaned from all domains.-->
    <parameters name="Domains" type="java.util.Collection" optional="true"/>
<!--The product whose assignments will be processed.-->
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
  </nodes>
<!--Takes care of cleaning up assignments of a product in the given domains.
This extension point is used when a product will be deleted of unshared.
@Location 35,1-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode0" name="CleanUpProductAssignments"
      strict="true">
    <nodeSuccessors name="next" next="CallNode43"/>
<!--The domains for which the product assignments should be processed. If the collection is undefined or empty, assignments should be cleaned from all domains.-->
    <parameters name="Domains" type="java.util.Collection" optional="true"/>
<!--The product whose assignments will be processed.-->
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
  </nodes>
<!--@Location 35,2-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode43">
    <nodeSuccessors name="next" next="EndNode1"/>
    <startNode referencedName="ProcessProductDeletion-CleanUpKnownAssignments"/>
  </nodes>
<!--@Location 35,3-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode1" strict="true"/>
<!--This pipeline converts all offers of the given product.
@Location 30,27-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode6" strict="true" name="ConvertOffers"
      callMode="Private">
<!--@BendPoints 61,56-->
    <nodeSuccessors name="next" next="LoopNode1"/>
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"
        optional="true"/>
  </nodes>
<!--@Location 30,28-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode1" loop="Product:Offers">
<!--@BendPoints 62,57-->
    <nodeSuccessors name="next" next="EndNode13"/>
    <entry key="Offer">
      <nodeSuccessors name="loop_entry_next" next="GetRepositoryByRepositoryDomain3"/>
    </entry>
  </nodes>
<!--@Location 30,29-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetRepositoryByRepositoryDomain3">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetRepositoryByRepositoryDomain.xml"/>
<!--@BendPoints 61,60-->
    <nodeSuccessors name="next" next="DecisionNode2"/>
    <parameterBindings name="RepositoryDomain" objectPath="Offer:Domain"/>
  </nodes>
<!--@Location 30,30-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode2" conditionKey="Repository"
      operator="str_eq" conditionValue="21">
    <nodeSuccessors name="decision_yes" next="JoinNode5"/>
    <nodeSuccessors name="decision_no" next="KeyMapper1"/>
  </nodes>
<!--@Location 30,33-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode5">
<!--@BendPoints 60,67 60,57-->
    <nodeSuccessors name="next" next="LoopNode1_Entry"/>
  </nodes>
<!--@Location 31,30-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper1">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
<!--@BendPoints 65,61 65,62-->
    <nodeSuccessors name="next" next="AssignOfferedProduct1"/>
    <parameterBindings name="InValue_1" objectPath="Product:UUID"/>
    <returnValueBindings name="OutValue_1" objectPath="MasterProductUUID"/>
  </nodes>
<!--@Location 32,31-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AssignOfferedProduct1">
    <pipelet href="enfinity:/bc_mvc/pipelets/AssignOfferedProduct.xml"/>
<!--@BendPoints 65,64-->
    <nodeSuccessors name="next" next="UpdateCustomAttribute1"/>
    <parameterBindings name="OfferedProduct" objectPath="Offer"/>
  </nodes>
<!--@Location 32,32-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateCustomAttribute1">
    <configurationValues name="DefaultAttributeName" value="MasterProductUUID"/>
    <configurationValues name="DefaultAttributeType" value="String"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/UpdateCustomAttribute.xml"/>
<!--@BendPoints 65,67-->
    <nodeSuccessors name="next" next="JoinNode5"/>
    <parameterBindings name="AttributeName" nullBinding="true"/>
    <parameterBindings name="AttributeType" nullBinding="true"/>
    <parameterBindings name="AttributeValue" objectPath="MasterProductUUID"/>
    <parameterBindings name="ExtensibleObject" objectPath="Offer"/>
    <parameterBindings name="LocaleInformation" nullBinding="true"/>
  </nodes>
<!--@Location 31,28-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode13" strict="true"/>
<!--@Location 12,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode20" strict="true" name="Delete"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode2"/>
<!--The domain which hold the information about the deletion strategy preferences (recycle bin and offer propagation).-->
    <parameters name="DeletionPreferenceDomain" type="com.intershop.beehive.core.capi.domain.Domain"/>
    <parameters name="ProcessInstantCacheClearProductsVector" type="java.util.Vector"
        optional="true"/>
<!--The name of the process that add, delete and update a product.-->
    <parameters name="ProcessName" type="java.lang.String" optional="true"/>
<!--The product which should be deleted.-->
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
  </nodes>
<!--@Location 12,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode2">
<!--@BendPoints 27,6-->
    <nodeSuccessors name="DeleteOffers" next="Call1"/>
<!--@BendPoints 23,5-->
    <nodeSuccessors name="ConvertOffers" next="CallNode4"/>
<!--@BendPoints 28,4 28,37-->
    <nodeSuccessors name="ForbidDeletion" next="JoinNode28"/>
    <startNode referencedName="ProcessProductDeletion-GetDeletionStrategy"/>
  </nodes>
<!--@Location 13,3-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call1">
<!--@BendPoints 27,11-->
    <nodeSuccessors name="next" next="JoinNode4"/>
    <startNode referencedName="ProcessProductDeletion-DeleteOffers"/>
  </nodes>
<!--@Location 12,5-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode4">
    <nodeSuccessors name="next" next="GetRepositoryByRepositoryDomain4"/>
  </nodes>
<!--@Location 12,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetRepositoryByRepositoryDomain4">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetRepositoryByRepositoryDomain.xml"/>
    <nodeSuccessors name="next" next="CallNode41"/>
    <parameterBindings name="RepositoryDomain" objectPath="Product:Domain"/>
  </nodes>
<!--@Location 12,7-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode41">
    <nodeSuccessors name="next" next="CallNode42"/>
    <startNode referencedName="ProcessProductDeletion-GetProductHistoryPreferenceDomain"/>
  </nodes>
<!--@Location 12,8-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode42">
    <nodeSuccessors name="next" next="CallNode8"/>
    <startNode referencedName="ProcessProductHistory-PrepareData"/>
  </nodes>
<!--@Location 12,9-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode8">
    <nodeSuccessors name="next" next="CallNode25"/>
    <startNode referencedName="ProcessProductHistory-AddDeleteEntry"/>
  </nodes>
<!--@Location 12,10-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode25">
    <nodeSuccessors name="next" next="CallNode24"/>
    <startNode referencedName="ProcessProductDeletion-DeleteProductCategoryLinks"/>
  </nodes>
<!--@Location 12,11-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode24">
    <nodeSuccessors name="next" next="CallNode17"/>
    <parameterBindings name="Domains" nullBinding="true"/>
    <startNode referencedName="ProcessProductDeletion-CleanUpProductAssignments"/>
  </nodes>
<!--@Location 12,12-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode17">
    <nodeSuccessors name="next" next="CallNode22"/>
    <parameterBindings name="Object" objectPath="Product"/>
    <startNode referencedName="ProcessLabel-UnassignAllLabels"/>
  </nodes>
<!--@Location 12,13-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode22">
    <nodeSuccessors name="next" next="CallNode7"/>
    <parameterBindings name="ContextObject" objectPath="Product"/>
    <parameterBindings name="Domain" nullBinding="true"/>
    <parameterBindings name="Site" objectPath="CurrentDomain"/>
    <startNode referencedName="ProcessPageletEntryPoint-DeletePageletEntryPointsByObject"/>
  </nodes>
<!--@Location 12,14-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode7">
    <nodeSuccessors name="next" next="CallNode6"/>
<!--@BendPoints 27,31 27,35-->
    <nodeSuccessors name="JDBC_REMOVAL" next="JoinNode27"/>
    <startNode referencedName="ProcessProductDeletion-DeleteProductData"/>
  </nodes>
<!--@Location 12,16-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode6">
    <nodeSuccessors name="next" next="JoinNode27"/>
    <startNode referencedName="ProcessProductConfigurationParameters-PutConfigurationParametersDataToSession"/>
  </nodes>
<!--@Location 12,17-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode27">
    <nodeSuccessors name="next" next="JoinNode28"/>
  </nodes>
<!--@Location 12,18-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode28">
    <nodeSuccessors name="next" next="EndNode26"/>
  </nodes>
<!--@Location 12,19-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode26" strict="true">
    <returnValues name="ProcessInstantCacheClearProductsIter" type="java.util.Iterator"
        optional="true"/>
    <returnValues name="ProcessInstantCacheClearProductsVector" type="java.util.Vector"
        optional="true"/>
    <returnValues name="ProductDeletionFailed" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 11,3-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode4">
<!--@BendPoints 23,11-->
    <nodeSuccessors name="next" next="JoinNode4"/>
    <startNode referencedName="ProcessProductDeletion-ConvertOffers"/>
  </nodes>
<!--This pipeline deletes all offers of the given product.
@Location 17,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode4" strict="true" name="DeleteOffers"
      callMode="Private">
<!--@BendPoints 35,2-->
    <nodeSuccessors name="next" next="LoopNode3"/>
<!--The product which offers should be deleted.-->
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
<!--The domain which hold the information about the deletion strategy preferences (recycle bin and offer propagation).-->
    <parameters name="DeletionPreferenceDomain" type="com.intershop.beehive.core.capi.domain.Domain"/>
  </nodes>
<!--@Location 17,1-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode3" loop="Product:Offers">
<!--@BendPoints 36,3-->
    <nodeSuccessors name="next" next="EndNode9"/>
    <entry key="Offer">
      <nodeSuccessors name="loop_entry_next" next="Decision3"/>
    </entry>
  </nodes>
<!--@Location 17,2-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="Decision3" conditionKey="Product:UUID"
      operator="str_neq" conditionItem="Offer:UUID">
    <nodeSuccessors name="decision_yes" next="GetRepositoryByRepositoryDomain2"/>
<!--@BendPoints 38,5 38,13-->
    <nodeSuccessors name="decision_no" next="JoinNode8"/>
  </nodes>
<!--@Location 17,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetRepositoryByRepositoryDomain2">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetRepositoryByRepositoryDomain.xml"/>
<!--@BendPoints 35,8-->
    <nodeSuccessors name="next" next="DecisionNode1"/>
    <parameterBindings name="RepositoryDomain" objectPath="Offer:Domain"/>
  </nodes>
<!--@Location 17,4-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode1" conditionKey="Repository"
      operator="str_eq" conditionValue="21">
    <nodeSuccessors name="decision_yes" next="JoinNode1"/>
<!--@BendPoints 37,9-->
    <nodeSuccessors name="decision_no" next="CallNode5"/>
  </nodes>
<!--@Location 17,6-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode1">
<!--@BendPoints 34,13 34,3-->
    <nodeSuccessors name="next" next="LoopNode3_Entry"/>
  </nodes>
<!--@Location 18,5-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode5">
    <nodeSuccessors name="next" next="JoinNode8"/>
    <parameterBindings name="Product" objectPath="Offer"/>
    <startNode referencedName="ProcessProductDeletion-ProcessDeleteProduct"/>
  </nodes>
<!--@Location 18,6-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode8">
    <nodeSuccessors name="next" next="JoinNode1"/>
  </nodes>
<!--@Location 18,1-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode9" strict="true">
    <returnValues name="ProductDeletionFailed" type="java.lang.String" optional="true"/>
  </nodes>
<!--This pipeline deletes a product considering the preferences for product deletion (RecycleBin on/off, offer propagation) and product history. The pipeline checks also the product type (VariationMaster, VariationProduct, ProductBundle, BundledProduct, RetailSet,..) unassigns the related products and reset the type codes if it nessesary.
@Location 0,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode21" strict="true" name="DeleteProduct"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode38"/>
<!--The product which should be deleted.-->
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
<!--The domain which hold the information about the deletion strategy preferences (recycle bin and offer propagation).-->
    <parameters name="DeletionPreferenceDomain" type="com.intershop.beehive.core.capi.domain.Domain"/>
    <parameters name="ProcessInstantCacheClearProductsVector" type="java.util.Vector"
        optional="true"/>
<!--The name of the process that add, delete and update a product.-->
    <parameters name="ProcessName" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 0,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode38">
    <nodeSuccessors name="next" next="ProcessBatchCacheClear2"/>
    <startNode referencedName="ProcessProductDeletion-ProcessDeleteProduct"/>
  </nodes>
<!--@Location 0,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ProcessBatchCacheClear2">
    <pipelet href="enfinity:/core/pipelets/ProcessBatchCacheClear.xml"/>
    <nodeSuccessors name="next" next="EndNode0"/>
    <parameterBindings name="CacheClearProcessID" constant="ProductDeletionProcess"/>
    <parameterBindings name="CacheClearProcessingDate" nullBinding="true"/>
    <parameterBindings name="CacheClearProcessorID" nullBinding="true"/>
  </nodes>
<!--@Location 0,3-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode0" strict="true">
    <returnValues name="ProductDeletionFailed" type="java.lang.String" optional="true"/>
    <returnValues name="ProcessInstantCacheClearProductsVector" type="java.util.Vector"
        optional="true"/>
    <returnValues name="ProcessInstantCacheClearProductsIter" type="java.util.Iterator"
        optional="true"/>
  </nodes>
<!--@deprecated Use CleanUpProductAssignments instead


@Location 31,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode18" strict="true" name="DeleteProductAssignments"
      callMode="Private">
<!--@BendPoints 63,2-->
    <nodeSuccessors name="next" next="CallNode33"/>
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
    <parameters name="Domain" type="com.intershop.beehive.core.capi.domain.Domain"/>
  </nodes>
<!--@deprecated
Use CleanUpProductAssignments
@Location 31,1-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="CallNode33" name="DeleteProductAssignments">
    <nodeSuccessors name="next" next="AddObjectToCollection0"/>
  </nodes>
<!--@Location 31,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToCollection0">
    <pipelet href="enfinity:/core/pipelets/AddObjectToCollection.xml"/>
    <nodeSuccessors name="next" next="CallNode1"/>
    <parameterBindings name="InCollection" nullBinding="true"/>
    <parameterBindings name="InObject" objectPath="Domain"/>
    <returnValueBindings name="OutCollection" objectPath="Domains"/>
    <returnValueBindings name="OutIterator" nullBinding="true"/>
  </nodes>
<!--@Location 31,3-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode1">
    <nodeSuccessors name="next" next="EndNode21"/>
    <startNode referencedName="ProcessProductDeletion-CleanUpProductAssignments"/>
  </nodes>
<!--@Location 31,4-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode21" strict="true"/>
<!--@Location 17,27-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode8" strict="true" name="DeleteProductCategoryLinks"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode18"/>
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
  </nodes>
<!--@Location 17,28-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode18">
<!--@BendPoints 35,58-->
    <nodeSuccessors name="next" next="LoopNode4"/>
    <startNode referencedName="ProcessTypedProductCategoryAssignment-GetByProductWithoutSharing"/>
  </nodes>
<!--@Location 17,29-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode4" loop="TypedProductCategoryAssignments">
<!--@BendPoints 36,59-->
    <nodeSuccessors name="next" next="EndNode7"/>
    <entry key="TypedProductCategoryAssignment">
<!--@BendPoints 35,60-->
      <nodeSuccessors name="loop_entry_next" next="CallNode16"/>
    </entry>
  </nodes>
<!--@Location 17,30-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode16">
<!--@BendPoints 35,62 34,59-->
    <nodeSuccessors name="next" next="LoopNode4_Entry"/>
    <startNode referencedName="ProcessTypedProductCategoryAssignment-Remove"/>
  </nodes>
<!--@Location 18,29-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode7" strict="true"/>
<!--@Location 10,27-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode2" strict="true" name="DeleteProductData"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode26"/>
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
    <parameters name="DeletionPreferenceDomain" type="com.intershop.beehive.core.capi.domain.Domain"
        optional="true"/>
    <parameters name="ProcessInstantCacheClearProductsVector" type="java.util.Vector"
        optional="true"/>
    <parameters name="ProcessName" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 10,28-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode26">
    <nodeSuccessors name="next" next="GetLocale0"/>
    <startNode referencedName="ProcessProductDeletion-ProcessProductAlert"/>
  </nodes>
<!--@Location 10,29-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetLocale0">
    <configurationValues name="LocaleFallback" value="Request Locale"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetLocale.xml"/>
    <nodeSuccessors name="next" next="GetPriceDefinitionsByProduct2"/>
    <parameterBindings name="LocaleId" nullBinding="true"/>
    <returnValueBindings name="Locale" objectPath="LocaleInformation"/>
  </nodes>
<!--@Location 10,30-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetPriceDefinitionsByProduct2">
    <configurationValues name="Type" value="All"/>
    <pipelet href="enfinity:/bc_pricing/pipelets/GetPriceDefinitionsByProduct.xml"/>
<!--@BendPoints 21,62-->
    <nodeSuccessors name="next" next="Loop1"/>
  </nodes>
<!--@Location 10,31-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="Loop1" loop="PriceDefinitions">
<!--@BendPoints 23,63 23,67-->
    <nodeSuccessors name="next" next="CallNode9"/>
    <entry key="Table">
      <nodeSuccessors name="loop_entry_next" next="Call9"/>
    </entry>
  </nodes>
<!--@Location 10,32-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call9">
<!--@BendPoints 21,66 20,63-->
    <nodeSuccessors name="next" next="Loop1_Entry"/>
    <startNode referencedName="PricingRemovePriceScaleTable-DeletePriceScaleTable"/>
  </nodes>
<!--@Location 10,33-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode9">
<!--@BendPoints 21,68-->
    <nodeSuccessors name="next" next="Call8"/>
    <parameterBindings name="ProductRef" objectPath="Product:ProductRef"/>
    <startNode referencedName="ProcessProduct-RemoveProductListItems"/>
  </nodes>
<!--@Location 10,34-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call8">
<!--@BendPoints 21,70-->
    <nodeSuccessors name="next" next="CallNode10"/>
    <startNode referencedName="ProcessProductDeletion-ResetVariationProducts"/>
  </nodes>
<!--@Location 10,35-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode10">
<!--@BendPoints 20,72 20,73-->
    <nodeSuccessors name="next" next="DecisionNode8"/>
    <startNode referencedName="ProcessProductDeletion-ResetBundledProducts"/>
  </nodes>
<!--@Location 10,36-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode8" conditionKey="JDBCProductRemoval">
<!--@BendPoints 25,73-->
    <nodeSuccessors name="decision_yes" next="EndNode11"/>
    <nodeSuccessors name="decision_no" next="DecisionNode0"/>
  </nodes>
<!--@Location 12,37-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode11" name="JDBC_REMOVAL" strict="true">
    <returnValues name="ProductDeletionFailed" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 10,37-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode0" conditionKey="ProcessName"
      operator="undef">
    <nodeSuccessors name="decision_yes" next="JoinNode0"/>
<!--@BendPoints 23,75-->
    <nodeSuccessors name="decision_no" next="DecisionNode13"/>
  </nodes>
<!--@Location 10,38-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode0">
    <nodeSuccessors name="next" next="BatchCacheClear1"/>
  </nodes>
<!--@Location 10,39-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="BatchCacheClear1">
    <pipelet href="enfinity:/core/pipelets/BatchCacheClear.xml"/>
    <nodeSuccessors name="next" next="RemoveProduct2"/>
    <parameterBindings name="CacheClearProcessID" constant="ProductDeletionProcess"/>
    <parameterBindings name="CacheClearProcessorID" nullBinding="true"/>
    <parameterBindings name="ClassNames" nullBinding="true"/>
    <parameterBindings name="DesiredCacheClearDate" nullBinding="true"/>
    <parameterBindings name="Object" objectPath="Product"/>
    <parameterBindings name="Objects" nullBinding="true"/>
  </nodes>
<!--@Location 10,40-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemoveProduct2">
    <pipelet href="enfinity:/xcs/pipelets/RemoveProduct.xml"/>
    <nodeSuccessors name="next" next="JoinNode19"/>
  </nodes>
<!--@Location 10,42-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode19">
    <nodeSuccessors name="next" next="End13"/>
  </nodes>
<!--@Location 10,43-->
  <nodes xsi:type="pipeline:EndNode" nodeID="End13" name="" strict="true">
    <returnValues name="ProductDeletionFailed" type="java.lang.String" optional="true"/>
    <returnValues name="ProductRef" type="com.intershop.beehive.xcs.common.ProductRef"
        optional="true"/>
    <returnValues name="ProductRefs" type="java.util.Iterator" optional="true"/>
    <returnValues name="ProcessInstantCacheClearProductsVector" type="java.util.Vector"
        optional="true"/>
    <returnValues name="ProcessInstantCacheClearProductsIter" type="java.util.Iterator"
        optional="true"/>
  </nodes>
<!--@Location 12,38-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode13" conditionKey="ProcessName"
      operator="str_eq" conditionValue="BatchProcess">
    <nodeSuccessors name="decision_yes" next="CallNode0"/>
    <nodeSuccessors name="decision_no" next="JoinNode0"/>
  </nodes>
<!--@Location 12,41-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode0">
<!--@BendPoints 23,83-->
    <nodeSuccessors name="next" next="JoinNode19"/>
    <startNode referencedName="This:CacheClearMultipleProductsAsBlock"/>
  </nodes>
<!--@Location 13,27-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode7" strict="true" name="DeleteProductLinks"
      callMode="Private">
<!--@BendPoints 27,56-->
    <nodeSuccessors name="next" next="CallNode19"/>
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
    <parameters name="DeletionPreferenceDomain" type="com.intershop.beehive.core.capi.domain.Domain"
        optional="true"/>
  </nodes>
<!--@Location 13,28-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode19">
<!--@BendPoints 27,58-->
    <nodeSuccessors name="next" next="CallNode20"/>
    <startNode referencedName="ProcessProductDeletion-DeleteProductProductLinks"/>
  </nodes>
<!--@Location 13,29-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode20">
<!--@BendPoints 27,60-->
    <nodeSuccessors name="next" next="End1"/>
    <startNode referencedName="ProcessProductDeletion-DeleteProductCategoryLinks"/>
  </nodes>
<!--@Location 13,30-->
  <nodes xsi:type="pipeline:EndNode" nodeID="End1" strict="true">
    <returnValues name="ProductDeletionFailed" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 15,27-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode10" strict="true" name="DeleteProductProductLinks"
      callMode="Private">
    <nodeSuccessors name="next" next="ExecuteObjectsQuery1"/>
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
    <parameters name="DeletionPreferenceDomain" type="com.intershop.beehive.core.capi.domain.Domain"
        optional="true"/>
<!--A list of domains for which the product to product links will be removed. If the variable is undefined, then the links will be removed for all domains. If the collection is empty, no links will be removed-->
    <parameters name="Domains" type="java.util.Collection" optional="true"/>
  </nodes>
<!--@Location 15,28-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ExecuteObjectsQuery1">
    <configurationValues name="Datasource" value="default"/>
    <configurationValues name="ParameterName_01" value="Product"/>
    <configurationValues name="ParameterName_02" value="Domains"/>
    <configurationValues name="QueryName" value="product/GetOutgoingProductLinkUUIDsByProductUUID"/>
    <pipelet href="enfinity:/core/pipelets/ExecuteObjectsQuery.xml"/>
    <nodeSuccessors name="next" next="ExecuteObjectsQuery2"/>
    <parameterBindings name="ParameterValue_01" objectPath="Product"/>
    <parameterBindings name="ParameterValue_02" objectPath="Domains"/>
    <returnValueBindings name="SearchResult" objectPath="OutgoingLinks"/>
  </nodes>
<!--@Location 15,29-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ExecuteObjectsQuery2">
    <configurationValues name="Datasource" value="default"/>
    <configurationValues name="ParameterName_01" value="Product"/>
    <configurationValues name="ParameterName_02" value="Domains"/>
    <configurationValues name="QueryName" value="product/GetIncomingProductLinkUUIDsByProductUUID"/>
    <pipelet href="enfinity:/core/pipelets/ExecuteObjectsQuery.xml"/>
    <nodeSuccessors name="next" next="CombineIterators1"/>
    <parameterBindings name="ParameterValue_01" objectPath="Product"/>
    <parameterBindings name="ParameterValue_02" objectPath="Domains"/>
    <returnValueBindings name="SearchResult" objectPath="IncomingLinks"/>
  </nodes>
<!--@Location 15,30-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CombineIterators1">
    <configurationValues name="ProcessMethod" value="Concatenate Iterators"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/CombineIterators.xml"/>
    <nodeSuccessors name="next" next="LoopNode5"/>
    <parameterBindings name="Iterator1" objectPath="OutgoingLinks"/>
    <parameterBindings name="Iterator2" objectPath="IncomingLinks"/>
    <returnValueBindings name="Iterator" objectPath="ProductLinks"/>
  </nodes>
<!--@Location 15,31-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode5" loop="ProductLinks">
<!--@BendPoints 32,63 32,72-->
    <nodeSuccessors name="next" next="End2"/>
    <entry key="ProductLink">
      <nodeSuccessors name="loop_entry_next" next="GetProductLinkByUUID0"/>
    </entry>
  </nodes>
<!--@Location 15,32-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetProductLinkByUUID0">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetProductLinkByUUID.xml"/>
    <nodeSuccessors name="next" next="CallNode23"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode30"/>
    <parameterBindings name="ProductLinkUUID" objectPath="ProductLink:UUID"/>
    <returnValueBindings name="ProductLink" objectPath="Link"/>
  </nodes>
<!--@displayNearNode@need to Filter \- because the 'ES_Proxy'
ProductLinks are required later to identify
the proxy products in the ProductMgr
remove(product) method; the remaning
ProductLinks will be removed by the Manager
@Location 15,33-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode23">
    <nodeSuccessors name="next" next="RemoveProductLinkObject2"/>
    <nodeSuccessors name="skip" next="JoinNode17"/>
    <parameterBindings name="ProductLink" objectPath="Link"/>
    <parameterBindings name="ProductLinkTypeCodeCompareValue" constant="ES_Proxy"/>
    <startNode referencedName="ProcessProductDeletion-ProductLinkTypeToSkip"/>
  </nodes>
<!--@Location 15,34-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemoveProductLinkObject2">
    <pipelet href="enfinity:/bc_mvc/pipelets/RemoveProductLinkObject.xml"/>
<!--@BendPoints 31,70-->
    <nodeSuccessors name="next" next="Pipelet2"/>
    <parameterBindings name="ProductLink" objectPath="Link"/>
  </nodes>
<!--@Location 15,35-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet2">
    <pipelet href="enfinity:/bc_foundation/pipelets/Touch.xml"/>
<!--@BendPoints 31,72 29,72-->
    <nodeSuccessors name="next" next="JoinNode17"/>
    <parameterBindings name="Object" objectPath="Product"/>
  </nodes>
<!--@Location 14,33-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode17">
    <nodeSuccessors name="next" next="JoinNode30"/>
  </nodes>
<!--@Location 14,32-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode30">
<!--@BendPoints 29,63-->
    <nodeSuccessors name="next" next="LoopNode5_Entry"/>
  </nodes>
<!--@Location 15,36-->
  <nodes xsi:type="pipeline:EndNode" nodeID="End2" strict="true">
    <returnValues name="ProductDeletionFailed" type="java.lang.String" optional="true"/>
  </nodes>
<!--This pipeline checks the deletion strategy for the given product and DeletionPreferenceDomain. It ends in note DeleteOffers, ConvertOffers or ForbidDeletion.
@Location 21,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode3" strict="true" name="GetDeletionStrategy"
      callMode="Private">
<!--@BendPoints 43,2-->
    <nodeSuccessors name="next" next="DecisionNode9"/>
<!--The domain which hold the information about the deletion strategy preferences (recycle bin and offer propagation).-->
    <parameters name="DeletionPreferenceDomain" type="com.intershop.beehive.core.capi.domain.Domain"
        optional="true"/>
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"
        optional="true"/>
  </nodes>
<!--@Location 21,1-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode9" conditionKey="Product:DerivedProduct"
      operator="str_neq" conditionValue="true">
<!--@BendPoints 43,4-->
    <nodeSuccessors name="decision_yes" next="GetDomainPreference3"/>
<!--@BendPoints 57,3 57,12-->
    <nodeSuccessors name="decision_no" next="SetDictionaryValue2"/>
  </nodes>
<!--@Location 21,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetDomainPreference3">
    <configurationValues name="DefaultPreferenceKey" value="ProductDeletionStrategy"/>
    <configurationValues name="Type" value="Integer"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetDomainPreference.xml"/>
    <nodeSuccessors name="next" next="DecisionNode4"/>
    <parameterBindings name="PreferenceDomain" objectPath="DeletionPreferenceDomain"/>
    <returnValueBindings name="PreferenceIntValue" objectPath="Strategy"/>
  </nodes>
<!--@Location 21,3-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode4" conditionKey="Strategy"
      operator="eq" conditionValue="2">
    <nodeSuccessors name="decision_yes" next="EndNode4"/>
<!--@BendPoints 46,7 47,6-->
    <nodeSuccessors name="decision_no" next="DecisionNode5"/>
  </nodes>
<!--@Location 21,7-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode4" name="DeleteOffers" strict="true"/>
<!--@Location 23,3-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode5" conditionKey="Strategy"
      operator="eq" conditionValue="1">
    <nodeSuccessors name="decision_yes" next="JoinNode3"/>
<!--@BendPoints 50,7 51,6-->
    <nodeSuccessors name="decision_no" next="DecisionNode6"/>
  </nodes>
<!--@Location 23,6-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode3">
<!--@BendPoints 47,14-->
    <nodeSuccessors name="next" next="EndNode3"/>
  </nodes>
<!--@Location 23,7-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode3" name="ConvertOffers" strict="true"/>
<!--@Location 25,3-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode6" conditionKey="Strategy"
      operator="eq" conditionValue="0">
<!--@BendPoints 51,8-->
    <nodeSuccessors name="decision_yes" next="Decision2"/>
<!--@BendPoints 55,7-->
    <nodeSuccessors name="decision_no" next="JoinNode6"/>
  </nodes>
<!--@Location 25,4-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="Decision2" conditionKey="Product:getOffersCount"
      operator="eq" conditionValue="0">
    <nodeSuccessors name="decision_yes" next="JoinNode2"/>
<!--@BendPoints 52,9 53,8-->
    <nodeSuccessors name="decision_no" next="Decision12"/>
  </nodes>
<!--@Location 25,6-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode2">
    <nodeSuccessors name="next" next="JoinNode3"/>
  </nodes>
<!--@Location 26,4-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="Decision12" conditionKey="Product:getOffersCount"
      operator="eq" conditionValue="1">
    <nodeSuccessors name="decision_yes" next="Decision11"/>
    <nodeSuccessors name="decision_no" next="JoinNode6"/>
  </nodes>
<!--@Location 26,5-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="Decision11" conditionKey="Product:UUID"
      operator="str_eq" conditionItem="Product:OfferedProductID">
<!--@BendPoints 53,13-->
    <nodeSuccessors name="decision_yes" next="JoinNode2"/>
    <nodeSuccessors name="decision_no" next="JoinNode25"/>
  </nodes>
<!--@Location 27,5-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode25">
<!--@BendPoints 55,12-->
    <nodeSuccessors name="next" next="SetDictionaryValue1"/>
  </nodes>
<!--@Location 27,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetDictionaryValue1">
    <configurationValues name="Name" value="ProductDeletionFailed"/>
    <configurationValues name="Value" value="OffersExist"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetDictionaryValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode13"/>
  </nodes>
<!--@Location 27,7-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode13">
<!--@BendPoints 55,16-->
    <nodeSuccessors name="next" next="EndNode5"/>
  </nodes>
<!--@Location 27,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode5" name="ForbidDeletion" strict="true">
    <returnValues name="ProductDeletionFailed" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 27,4-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode6">
    <nodeSuccessors name="next" next="JoinNode25"/>
  </nodes>
<!--@Location 28,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetDictionaryValue2">
    <configurationValues name="Name" value="ProductDeletionFailed"/>
    <configurationValues name="Value" value="ProductReferencesExist"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetDictionaryValue.xml"/>
<!--@BendPoints 57,15-->
    <nodeSuccessors name="next" next="JoinNode13"/>
  </nodes>
<!--This pipeline returns the product history preference domain for the given product repository.
@Location 34,27-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode5" strict="true" name="GetProductHistoryPreferenceDomain"
      callMode="Private">
    <nodeSuccessors name="next" next="DecisionNode11"/>
<!--The product repository to determine the history preference domain.-->
    <parameters name="Repository" type="com.intershop.component.mvc.capi.catalog.Repository"
        optional="true"/>
  </nodes>
<!--@Location 34,28-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode11" conditionKey="Repository:TypeCode"
      operator="str_eq" conditionValue="21">
<!--@BendPoints 69,58-->
    <nodeSuccessors name="decision_yes" next="Pipelet8"/>
<!--@BendPoints 73,57-->
    <nodeSuccessors name="decision_no" next="DecisionNode12"/>
  </nodes>
<!--@Location 34,29-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet8">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="JoinNode14"/>
    <parameterBindings name="InValue_1" objectPath="Repository:OwningDomain"/>
    <returnValueBindings name="OutValue_1" objectPath="PreferenceDomain"/>
  </nodes>
<!--@Location 34,32-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode14">
<!--@BendPoints 69,66-->
    <nodeSuccessors name="next" next="EndNode2"/>
  </nodes>
<!--@Location 34,33-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode2" strict="true">
    <returnValues name="PreferenceDomain" type="com.intershop.beehive.core.capi.domain.Domain"/>
  </nodes>
<!--@Location 36,29-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode12" conditionKey="Repository:TypeCode"
      operator="str_neq" conditionValue="22">
<!--@BendPoints 73,60-->
    <nodeSuccessors name="decision_yes" next="Pipelet6"/>
<!--@BendPoints 77,59-->
    <nodeSuccessors name="decision_no" next="GetRepositoryByRecycleBin2"/>
  </nodes>
<!--@Location 36,30-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet6">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="JoinNode15"/>
    <parameterBindings name="InValue_1" objectPath="Repository:Domain"/>
    <returnValueBindings name="OutValue_1" objectPath="PreferenceDomain"/>
  </nodes>
<!--@Location 36,32-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode15">
    <nodeSuccessors name="next" next="JoinNode14"/>
  </nodes>
<!--@Location 38,30-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetRepositoryByRecycleBin2">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetRepositoryByRecycleBin.xml"/>
<!--@BendPoints 77,62-->
    <nodeSuccessors name="next" next="Pipelet5"/>
    <parameterBindings name="RecycleBin" objectPath="Repository"/>
    <returnValueBindings name="Repository" objectPath="ProductRepository"/>
  </nodes>
<!--@Location 38,31-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet5">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
<!--@BendPoints 77,65-->
    <nodeSuccessors name="next" next="JoinNode15"/>
    <parameterBindings name="InValue_1" objectPath="ProductRepository:Domain"/>
    <returnValueBindings name="OutValue_1" objectPath="PreferenceDomain"/>
  </nodes>
<!--@Location 16,40-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode11" strict="true" name="InstantCacheClearMultipleProducts"
      callMode="Private">
<!--@BendPoints 33,82-->
    <nodeSuccessors name="next" next="DecisionNode19"/>
    <parameters name="ProcessInstantCacheClearProductsIter" type="java.util.Iterator&lt;java.lang.Object>"
        optional="true"/>
  </nodes>
<!--@Location 16,41-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode19" conditionKey="ProcessInstantCacheClearProductsIter"
      operator="has_elements">
    <nodeSuccessors name="decision_yes" next="BatchCacheClear0"/>
<!--@BendPoints 35,83-->
    <nodeSuccessors name="decision_no" next="EndNode24"/>
  </nodes>
<!--@Location 16,43-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="BatchCacheClear0">
    <pipelet href="enfinity:/core/pipelets/BatchCacheClear.xml"/>
    <nodeSuccessors name="next" next="RemoveProduct1"/>
    <parameterBindings name="CacheClearProcessID" constant="ProductDeletionProcess"/>
    <parameterBindings name="CacheClearProcessorID" nullBinding="true"/>
    <parameterBindings name="ClassNames" nullBinding="true"/>
    <parameterBindings name="DesiredCacheClearDate" nullBinding="true"/>
    <parameterBindings name="Object" nullBinding="true"/>
    <parameterBindings name="Objects" objectPath="ProcessInstantCacheClearProductsIter"/>
  </nodes>
<!--@Location 16,44-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemoveProduct1">
    <pipelet href="enfinity:/xcs/pipelets/RemoveProduct.xml"/>
    <nodeSuccessors name="next" next="EndNode15"/>
    <parameterBindings name="Product" nullBinding="true"/>
    <parameterBindings name="Products" objectPath="ProcessInstantCacheClearProductsIter"/>
  </nodes>
<!--@Location 16,46-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode15" strict="true"/>
<!--@Location 17,46-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode24" name="Error" strict="true"/>
<!--@Location 7,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode0" strict="true" name="MoveToRecycleBin"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode30"/>
<!--The product which should be deleted.-->
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
<!--The domain which hold the information about the deletion strategy preferences (recycle bin and offer propagation).-->
    <parameters name="DeletionPreferenceDomain" type="com.intershop.beehive.core.capi.domain.Domain"/>
  </nodes>
<!--@Location 7,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode30">
    <nodeSuccessors name="next" next="CallNode32"/>
    <startNode referencedName="ProcessProductDeletion-ProcessProductAlert"/>
  </nodes>
<!--@Location 7,2-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode32">
    <nodeSuccessors name="next" next="GetRepositoryByRepositoryDomain0"/>
    <parameterBindings name="ProductRef" objectPath="Product:ProductRef"/>
    <startNode referencedName="ProcessProduct-RemoveProductListItems"/>
  </nodes>
<!--@Location 7,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetRepositoryByRepositoryDomain0">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetRepositoryByRepositoryDomain.xml"/>
    <nodeSuccessors name="next" next="CallNode39"/>
    <parameterBindings name="RepositoryDomain" objectPath="Product:Domain"/>
  </nodes>
<!--@Location 7,4-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode39">
    <nodeSuccessors name="next" next="CallNode40"/>
    <startNode referencedName="ProcessProductDeletion-GetProductHistoryPreferenceDomain"/>
  </nodes>
<!--@Location 7,5-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode40">
    <nodeSuccessors name="next" next="GetRecycleBinByRepository2"/>
    <startNode referencedName="ProcessProductHistory-PrepareData"/>
  </nodes>
<!--@Location 7,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetRecycleBinByRepository2">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetRecycleBinByRepository.xml"/>
    <nodeSuccessors name="next" next="Pipelet16"/>
  </nodes>
<!--@Location 7,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet16">
    <configurationValues name="DefaultPreferenceKey" value="RecycleBinOfferPropagation"/>
    <configurationValues name="Type" value="String"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetDomainPreference.xml"/>
    <nodeSuccessors name="next" next="Decision4"/>
    <parameterBindings name="PreferenceDomain" objectPath="DeletionPreferenceDomain"/>
    <returnValueBindings name="PreferenceStringValue" objectPath="RecycleBinOfferPropagation"/>
  </nodes>
<!--@Location 7,8-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="Decision4" conditionKey="RecycleBinOfferPropagation"
      operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="Call3"/>
<!--@BendPoints 19,17 19,18-->
    <nodeSuccessors name="decision_no" next="CallNode11"/>
  </nodes>
<!--@Location 7,9-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call3">
    <nodeSuccessors name="next" next="JoinNode12"/>
    <startNode referencedName="ProcessProductDeletion-DeleteOffers"/>
  </nodes>
<!--@Location 7,10-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode12">
    <nodeSuccessors name="next" next="Call2"/>
  </nodes>
<!--@Location 7,11-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call2">
<!--@BendPoints 15,24-->
    <nodeSuccessors name="next" next="CallNode12"/>
    <startNode referencedName="ProcessProductDeletion-ResetVariationProducts"/>
  </nodes>
<!--@Location 7,12-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode12">
    <nodeSuccessors name="next" next="CallNode34"/>
    <startNode referencedName="ProcessProductDeletion-ResetBundledProducts"/>
  </nodes>
<!--@Location 7,13-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode34">
    <nodeSuccessors name="next" next="CallNode3"/>
    <startNode referencedName="ProcessProductDeletion-DeleteProductCategoryLinks"/>
  </nodes>
<!--@Location 7,14-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode3">
    <nodeSuccessors name="next" next="CallNode15"/>
    <parameterBindings name="Domains" nullBinding="true"/>
    <startNode referencedName="ProcessProductDeletion-CleanUpProductAssignments"/>
  </nodes>
<!--@Location 7,15-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode15">
<!--@BendPoints 15,32-->
    <nodeSuccessors name="next" next="CallNode13"/>
    <parameterBindings name="Object" objectPath="Product"/>
    <startNode referencedName="ProcessLabel-UnassignAllLabels"/>
  </nodes>
<!--@Location 7,16-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode13">
    <nodeSuccessors name="next" next="CallNode21"/>
    <startNode referencedName="ProcessProductHistory-AddDeleteEntry"/>
  </nodes>
<!--@Location 7,17-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode21">
<!--@BendPoints 15,36-->
    <nodeSuccessors name="next" next="Pipelet7"/>
    <parameterBindings name="ContextObject" objectPath="Product"/>
    <parameterBindings name="Domain" nullBinding="true"/>
    <parameterBindings name="Site" objectPath="CurrentDomain"/>
    <startNode referencedName="ProcessPageletEntryPoint-DeletePageletEntryPointsByObject"/>
  </nodes>
<!--@Location 7,18-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet7">
    <pipelet href="enfinity:/bc_foundation/pipelets/UpdateObjectWithDomain.xml"/>
    <nodeSuccessors name="next" next="CallNode29"/>
    <parameterBindings name="Domain" objectPath="RecycleBin:Domain"/>
    <parameterBindings name="Object" objectPath="Product"/>
    <parameterBindings name="Objects" nullBinding="true"/>
  </nodes>
<!--@Location 7,19-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode29">
    <nodeSuccessors name="next" next="EndNode23"/>
    <parameterBindings name="ProductRef" objectPath="Product:ProductRef"/>
    <startNode referencedName="ProcessProductConfigurationParameters-PutConfigurationParametersDataToSession"/>
  </nodes>
<!--@Location 7,20-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode23" strict="true">
    <returnValues name="ProductDeletionFailed" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 9,9-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode11">
<!--@BendPoints 19,21-->
    <nodeSuccessors name="next" next="JoinNode12"/>
    <startNode referencedName="ProcessProductDeletion-ConvertOffers"/>
  </nodes>
<!--This pipeline deletes a product considering the preferences for product deletion (RecycleBin on/off, offer propagation) and product history. The pipeline checks also the product type (VariationMaster, VariationProduct, ProductBundle, BundledProduct, RetailSet,..) unassigns the related products and reset the type codes if it nessesary.
@Location 2,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode1" strict="true" name="ProcessDeleteProduct"
      callMode="Private">
<!--@BendPoints 5,2-->
    <nodeSuccessors name="next" next="GetDomainPreference1"/>
<!--The product which should be deleted.-->
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
<!--The domain which hold the information about the deletion strategy preferences (recycle bin and offer propagation).-->
    <parameters name="DeletionPreferenceDomain" type="com.intershop.beehive.core.capi.domain.Domain"/>
    <parameters name="ProcessInstantCacheClearProductsVector" type="java.util.Vector"
        optional="true"/>
<!--The name of the process that add, delete and update a product.-->
    <parameters name="ProcessName" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 2,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetDomainPreference1">
    <configurationValues name="DefaultPreferenceKey" value="RecycleBinUsage"/>
    <configurationValues name="Type" value="String"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetDomainPreference.xml"/>
    <nodeSuccessors name="next" next="Decision1"/>
    <parameterBindings name="PreferenceDomain" objectPath="DeletionPreferenceDomain"/>
    <parameterBindings name="PreferenceKey" nullBinding="true"/>
    <returnValueBindings name="PreferenceStringValue" objectPath="RecycleBinUsage"/>
  </nodes>
<!--@Location 2,2-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="Decision1" conditionKey="RecycleBinUsage"
      operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="CallNode36"/>
    <nodeSuccessors name="decision_no" next="CallNode37"/>
  </nodes>
<!--@Location 2,3-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode36">
    <nodeSuccessors name="next" next="JoinNode7"/>
    <startNode referencedName="ProcessProductDeletion-MoveToRecycleBin"/>
  </nodes>
<!--@Location 2,4-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode7">
    <nodeSuccessors name="next" next="EndNode14"/>
  </nodes>
<!--@Location 2,5-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode14" strict="true">
    <returnValues name="ProductDeletionFailed" type="java.lang.String" optional="true"/>
    <returnValues name="ProcessInstantCacheClearProductsVector" type="java.util.Vector"
        optional="true"/>
    <returnValues name="ProcessInstantCacheClearProductsIter" type="java.util.Iterator"
        optional="true"/>
  </nodes>
<!--@Location 3,2-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode37">
<!--@BendPoints 7,9-->
    <nodeSuccessors name="next" next="JoinNode7"/>
    <startNode referencedName="This:Delete"/>
  </nodes>
<!--@Location 17,32-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode14" strict="true" name="ProcessProductAlert"
      callMode="Private">
<!--@BendPoints 35,66-->
    <nodeSuccessors name="next" next="GetAlertsByProduct1"/>
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
  </nodes>
<!--@Location 17,33-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetAlertsByProduct1">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetAlertsByProduct.xml"/>
<!--@BendPoints 35,68-->
    <nodeSuccessors name="next" next="Loop3"/>
  </nodes>
<!--@Location 17,34-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="Loop3" loop="Alerts">
    <nodeSuccessors name="next" next="EndNode16"/>
    <entry key="Alert">
      <nodeSuccessors name="loop_entry_next" next="GetProductBySKU2"/>
    </entry>
  </nodes>
<!--@Location 17,35-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetProductBySKU2">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetProductBySKU.xml"/>
<!--@BendPoints 35,72-->
    <nodeSuccessors name="next" next="KeyMapper3"/>
<!--@BendPoints 37,71-->
    <nodeSuccessors name="pipelet_error" next="KeyMapper4"/>
    <parameterBindings name="Domain" objectPath="Alert:Product:Domain"/>
    <parameterBindings name="SKU" objectPath="Alert:Product:SKU"/>
  </nodes>
<!--@Location 17,36-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper3">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="JoinNode22"/>
    <parameterBindings name="InValue_1" objectPath="Product:Name"/>
    <returnValueBindings name="OutValue_1" objectPath="AlertProductName"/>
  </nodes>
<!--@Location 17,37-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode22">
<!--@BendPoints 35,76-->
    <nodeSuccessors name="next" next="UpdateCustomAttribute2"/>
  </nodes>
<!--@Location 17,38-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateCustomAttribute2">
    <pipelet href="enfinity:/bc_foundation/pipelets/UpdateCustomAttribute.xml"/>
<!--@BendPoints 33,77 33,69-->
    <nodeSuccessors name="next" next="Loop3_Entry"/>
<!--@BendPoints 36,77-->
    <nodeSuccessors name="pipelet_error" next="EndNode20"/>
    <parameterBindings name="AttributeName" constant="AlertProductName"/>
    <parameterBindings name="AttributeType" constant="String"/>
    <parameterBindings name="AttributeValue" objectPath="AlertProductName"/>
    <parameterBindings name="ExtensibleObject" objectPath="Alert"/>
  </nodes>
<!--@Location 18,38-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode20" name="ERROR"/>
<!--@Location 18,36-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper4">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
<!--@BendPoints 37,75-->
    <nodeSuccessors name="next" next="JoinNode22"/>
    <parameterBindings name="InValue_1" objectPath="Alert:Product:Name"/>
    <returnValueBindings name="OutValue_1" objectPath="AlertProductName"/>
  </nodes>
<!--@Location 18,34-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode16" strict="true"/>
<!--@Location 21,32-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode16" strict="true" name="ProcessProductAlertUndo"
      callMode="Private">
<!--@BendPoints 43,66-->
    <nodeSuccessors name="next" next="GetAlertsByProduct2"/>
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
  </nodes>
<!--@Location 21,33-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetAlertsByProduct2">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetAlertsByProduct.xml"/>
<!--@BendPoints 43,68-->
    <nodeSuccessors name="next" next="Loop7"/>
  </nodes>
<!--@Location 21,34-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="Loop7" loop="Alerts">
    <nodeSuccessors name="next" next="EndNode19"/>
    <entry key="Alert">
<!--@BendPoints 43,70-->
      <nodeSuccessors name="loop_entry_next" next="RemoveCustomAttribute1"/>
    </entry>
  </nodes>
<!--@Location 21,35-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemoveCustomAttribute1">
    <pipelet href="enfinity:/bc_foundation/pipelets/RemoveCustomAttribute.xml"/>
<!--@BendPoints 41,71 41,69-->
    <nodeSuccessors name="next" next="Loop7_Entry"/>
    <parameterBindings name="AttributeName" constant="AlertProductName"/>
    <parameterBindings name="ExtensibleObject" objectPath="Alert"/>
  </nodes>
<!--@Location 22,34-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode19" strict="true"/>
<!--@Location 27,32-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode15" strict="true" name="ProcessProductRefsAlert"
      callMode="Private">
    <nodeSuccessors name="next" next="Loop6"/>
    <parameters name="ProductRefs" type="java.util.Iterator"/>
  </nodes>
<!--@Location 27,33-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="Loop6" loop="ProductRefs">
<!--@BendPoints 56,67-->
    <nodeSuccessors name="next" next="EndNode18"/>
    <entry key="ProductRef">
      <nodeSuccessors name="loop_entry_next" next="GetProductByProductRef1"/>
    </entry>
  </nodes>
<!--@Location 27,34-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetProductByProductRef1">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetProductByProductRef.xml"/>
    <nodeSuccessors name="next" next="CallNode28"/>
<!--@BendPoints 56,69 56,73-->
    <nodeSuccessors name="pipelet_error" next="JoinNode21"/>
  </nodes>
<!--@Location 27,35-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode28">
    <nodeSuccessors name="next" next="JoinNode21"/>
    <startNode referencedName="ProcessProductDeletion-ProcessProductAlert"/>
  </nodes>
<!--@Location 27,36-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode21">
<!--@BendPoints 52,73 52,67-->
    <nodeSuccessors name="next" next="Loop6_Entry"/>
  </nodes>
<!--@Location 28,33-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode18" strict="true"/>
<!--@Location 24,32-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode13" strict="true" name="ProcessProductsAlert"
      callMode="Private">
    <nodeSuccessors name="next" next="DecisionNode14"/>
    <parameters name="Products" type="java.util.Iterator"/>
    <parameters name="Domain" type="com.intershop.beehive.core.capi.domain.Domain"/>
  </nodes>
<!--@Location 24,33-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode14" conditionKey="Products">
    <nodeSuccessors name="decision_yes" next="DecisionNode17"/>
<!--@BendPoints 51,67-->
    <nodeSuccessors name="decision_no" next="JoinNode24"/>
  </nodes>
<!--@Location 24,34-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode17" conditionKey="Domain">
    <nodeSuccessors name="decision_yes" next="Loop5"/>
    <nodeSuccessors name="decision_no" next="JoinNode24"/>
  </nodes>
<!--@Location 24,35-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="Loop5" loop="Products">
<!--@BendPoints 51,71-->
    <nodeSuccessors name="next" next="JoinNode24"/>
    <entry key="Product">
      <nodeSuccessors name="loop_entry_next" next="GetProductBySKU1"/>
    </entry>
  </nodes>
<!--@Location 24,36-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetProductBySKU1">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetProductBySKU.xml"/>
    <nodeSuccessors name="next" next="CallNode27"/>
<!--@BendPoints 50,73 50,77-->
    <nodeSuccessors name="pipelet_error" next="JoinNode23"/>
    <parameterBindings name="Domain" objectPath="Domain"/>
    <parameterBindings name="SKU" objectPath="Product:SKU"/>
    <returnValueBindings name="Product" objectPath="Product2"/>
  </nodes>
<!--@Location 24,37-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode27">
    <nodeSuccessors name="next" next="JoinNode23"/>
    <parameterBindings name="Product" objectPath="Product2"/>
    <startNode referencedName="ProcessProductDeletion-ProcessProductAlert"/>
  </nodes>
<!--@Location 24,38-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode23">
<!--@BendPoints 45,77 45,71-->
    <nodeSuccessors name="next" next="Loop5_Entry"/>
  </nodes>
<!--@Location 25,34-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode24">
    <nodeSuccessors name="next" next="EndNode17"/>
  </nodes>
<!--@Location 25,37-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode17" strict="true"/>
<!--@Location 21,27-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode12" strict="true" name="ProductLinkTypeToSkip"
      callMode="Private">
    <nodeSuccessors name="next" next="DecisionNode15"/>
    <parameters name="ProductLink" type="com.intershop.beehive.xcs.capi.product.ProductLink"
        optional="true"/>
    <parameters name="ProductLinkTypeCodeCompareValue" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 21,28-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode15" conditionKey="ProductLink">
    <nodeSuccessors name="decision_yes" next="DecisionNode10"/>
<!--@BendPoints 45,57-->
    <nodeSuccessors name="decision_no" next="JoinNode18"/>
  </nodes>
<!--@Location 21,29-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode10" conditionKey="ProductLinkTypeCodeCompareValue">
    <nodeSuccessors name="decision_yes" next="DecisionNode16"/>
    <nodeSuccessors name="decision_no" next="JoinNode18"/>
  </nodes>
<!--@Location 21,30-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode16" conditionKey="ProductLink:TypeCode"
      operator="str_eq" conditionItem="ProductLinkTypeCodeCompareValue">
    <nodeSuccessors name="decision_yes" next="EndNode10"/>
    <nodeSuccessors name="decision_no" next="JoinNode16"/>
  </nodes>
<!--@Location 21,31-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode10" name="skip" strict="true"/>
<!--@Location 22,30-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode16">
<!--@BendPoints 45,62-->
    <nodeSuccessors name="next" next="EndNode12"/>
  </nodes>
<!--@Location 22,31-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode12" strict="true"/>
<!--@Location 22,29-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode18">
    <nodeSuccessors name="next" next="JoinNode16"/>
  </nodes>
<!--@Location 23,10-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode17" strict="true" name="RemoveProductsListItems"
      callMode="Private">
<!--@BendPoints 47,22-->
    <nodeSuccessors name="next" next="Loop8"/>
    <parameters name="Products" type="java.util.Iterator"/>
    <parameters name="Domain" type="com.intershop.beehive.core.capi.domain.Domain"/>
  </nodes>
<!--@Location 23,11-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="Loop8" loop="Products">
<!--@BendPoints 48,23-->
    <nodeSuccessors name="next" next="EndNode22"/>
    <entry key="Product">
<!--@BendPoints 47,24-->
      <nodeSuccessors name="loop_entry_next" next="CallNode31"/>
    </entry>
  </nodes>
<!--@Location 23,12-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode31">
<!--@BendPoints 47,26 46,23-->
    <nodeSuccessors name="next" next="Loop8_Entry"/>
    <parameterBindings name="ProductRef" objectPath="Product:ProductRef"/>
    <startNode referencedName="ProcessProduct-RemoveProductListItems"/>
  </nodes>
<!--@Location 24,11-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode22" strict="true"/>
<!--This pipeline unassigns all bundled products (bundled and part of retail set) from the given product an reset the type codes if it nessesary.
@Location 6,27-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode9" strict="true" name="ResetBundledProducts"
      callMode="Private">
    <nodeSuccessors name="next" next="LoopNode7"/>
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
  </nodes>
<!--@Location 6,28-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode7" loop="Product:BundledProductsIterator">
<!--@BendPoints 15,57 15,61-->
    <nodeSuccessors name="next" next="UpdateProductTypeCode3"/>
    <entry key="BundledProduct">
<!--@BendPoints 13,58-->
      <nodeSuccessors name="loop_entry_next" next="RemoveProductFromRetailSet2"/>
    </entry>
  </nodes>
<!--@Location 6,29-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemoveProductFromRetailSet2">
    <pipelet href="enfinity:/bc_mvc/pipelets/RemoveProductFromRetailSet.xml"/>
<!--@BendPoints 13,60 12,57-->
    <nodeSuccessors name="next" next="LoopNode7_Entry"/>
    <parameterBindings name="Product" objectPath="BundledProduct"/>
    <parameterBindings name="RetailSet" objectPath="Product"/>
  </nodes>
<!--@Location 6,31-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateProductTypeCode3">
    <configurationValues name="DefaultTypeCode" value="4"/>
    <configurationValues name="ProcessMethod" value="Subtract Typecode"/>
    <pipelet href="enfinity:/bc_mvc/pipelets/UpdateProductTypeCode.xml"/>
<!--@BendPoints 13,64-->
    <nodeSuccessors name="next" next="UpdateProductTypeCode7"/>
    <parameterBindings name="Product" objectPath="Product"/>
    <parameterBindings name="TypeCode" nullBinding="true"/>
  </nodes>
<!--@Location 6,32-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateProductTypeCode7">
    <configurationValues name="DefaultTypeCode" value="2"/>
    <configurationValues name="ProcessMethod" value="Add Typecode"/>
    <pipelet href="enfinity:/bc_mvc/pipelets/UpdateProductTypeCode.xml"/>
<!--@BendPoints 13,66-->
    <nodeSuccessors name="next" next="LoopNode8"/>
    <parameterBindings name="Product" objectPath="Product"/>
    <parameterBindings name="TypeCode" nullBinding="true"/>
  </nodes>
<!--@Location 6,33-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode8" loop="Product:ProductBundleIterator">
<!--@BendPoints 14,67-->
    <nodeSuccessors name="next" next="EndNode6"/>
    <entry key="ProductBundle">
<!--@BendPoints 13,68-->
      <nodeSuccessors name="loop_entry_next" next="Pipelet32"/>
    </entry>
  </nodes>
<!--@Location 6,34-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet32">
    <pipelet href="enfinity:/bc_mvc/pipelets/RemoveProductFromRetailSet.xml"/>
<!--@BendPoints 13,70-->
    <nodeSuccessors name="next" next="DecisionNode7"/>
    <parameterBindings name="Product" objectPath="Product"/>
    <parameterBindings name="RetailSet" objectPath="ProductBundle"/>
  </nodes>
<!--@Location 6,35-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode7" conditionKey="ProductBundle:BundleAssignmentsCount"
      operator="str_eq" conditionValue="0">
<!--@BendPoints 13,72-->
    <nodeSuccessors name="decision_yes" next="UpdateProductTypeCode4"/>
<!--@BendPoints 14,71 14,77-->
    <nodeSuccessors name="decision_no" next="JoinNode9"/>
  </nodes>
<!--@Location 6,36-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateProductTypeCode4">
    <configurationValues name="DefaultTypeCode" value="4"/>
    <configurationValues name="ProcessMethod" value="Subtract Typecode"/>
    <pipelet href="enfinity:/bc_mvc/pipelets/UpdateProductTypeCode.xml"/>
    <nodeSuccessors name="next" next="UpdateProductTypeCode8"/>
    <parameterBindings name="Product" objectPath="ProductBundle"/>
    <parameterBindings name="TypeCode" nullBinding="true"/>
  </nodes>
<!--@Location 6,37-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateProductTypeCode8">
    <configurationValues name="DefaultTypeCode" value="2"/>
    <configurationValues name="ProcessMethod" value="Add Typecode"/>
    <pipelet href="enfinity:/bc_mvc/pipelets/UpdateProductTypeCode.xml"/>
    <nodeSuccessors name="next" next="JoinNode9"/>
    <parameterBindings name="Product" objectPath="ProductBundle"/>
    <parameterBindings name="TypeCode" nullBinding="true"/>
  </nodes>
<!--@Location 6,38-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode9">
<!--@BendPoints 12,77 12,67-->
    <nodeSuccessors name="next" next="LoopNode8_Entry"/>
  </nodes>
<!--@Location 7,33-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode6" strict="true"/>
<!--This pipeline unassigns all variation products from the given product and reset the type code if it nessesary.
@Location 2,27-->
  <nodes xsi:type="pipeline:StartNode" nodeID="Start9" strict="true" name="ResetVariationProducts"
      callMode="Private">
    <nodeSuccessors name="next" next="Loop4"/>
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
  </nodes>
<!--@Location 2,28-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="Loop4" loop="Product:MasteredProducts">
<!--@BendPoints 6,57 6,60-->
    <nodeSuccessors name="next" next="UpdateProductTypeCode1"/>
    <entry key="MasteredProduct">
      <nodeSuccessors name="loop_entry_next" next="RemoveProductFromVariation3"/>
    </entry>
  </nodes>
<!--@Location 2,29-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemoveProductFromVariation3">
    <pipelet href="enfinity:/bc_mvc/pipelets/RemoveProductFromVariation.xml"/>
<!--@BendPoints 5,60 4,57-->
    <nodeSuccessors name="next" next="Loop4_Entry"/>
    <parameterBindings name="MasterProduct" objectPath="Product"/>
    <parameterBindings name="Product" objectPath="MasteredProduct"/>
  </nodes>
<!--@Location 2,30-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateProductTypeCode1">
    <configurationValues name="DefaultTypeCode" value="16"/>
    <configurationValues name="ProcessMethod" value="Subtract Typecode"/>
    <pipelet href="enfinity:/bc_mvc/pipelets/UpdateProductTypeCode.xml"/>
    <nodeSuccessors name="next" next="UpdateProductTypeCode6"/>
    <parameterBindings name="Product" objectPath="Product"/>
    <parameterBindings name="TypeCode" nullBinding="true"/>
  </nodes>
<!--@Location 2,31-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateProductTypeCode6">
    <configurationValues name="DefaultTypeCode" value="2"/>
    <configurationValues name="ProcessMethod" value="Add Typecode"/>
    <pipelet href="enfinity:/bc_mvc/pipelets/UpdateProductTypeCode.xml"/>
    <nodeSuccessors name="next" next="DecisionNode3"/>
    <parameterBindings name="Product" objectPath="Product"/>
    <parameterBindings name="TypeCode" nullBinding="true"/>
  </nodes>
<!--@Location 2,32-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode3" conditionKey="Product:ProductMasterWithoutMasteredCheck">
<!--@BendPoints 5,66-->
    <nodeSuccessors name="decision_yes" next="KeyMapper5"/>
<!--@BendPoints 7,65-->
    <nodeSuccessors name="decision_no" next="JoinNode11"/>
  </nodes>
<!--@Location 2,33-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper5">
    <configurationValues name="ValueType" value="Dictionary Value"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
<!--@BendPoints 5,68-->
    <nodeSuccessors name="next" next="RemoveProductFromVariation1"/>
    <parameterBindings name="InValue_1" objectPath="Product:ProductMasterWithoutMasteredCheck"/>
    <returnValueBindings name="OutValue_1" objectPath="ProductMaster"/>
  </nodes>
<!--@Location 2,34-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemoveProductFromVariation1">
    <pipelet href="enfinity:/bc_mvc/pipelets/RemoveProductFromVariation.xml"/>
<!--@BendPoints 5,70-->
    <nodeSuccessors name="next" next="Decision7"/>
    <parameterBindings name="MasterProduct" objectPath="ProductMaster"/>
    <parameterBindings name="Product" objectPath="Product"/>
  </nodes>
<!--@Location 2,35-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="Decision7" conditionKey="ProductMaster:ProductVariationsCount"
      operator="eq" conditionValue="0">
<!--@BendPoints 5,72-->
    <nodeSuccessors name="decision_yes" next="UpdateProductTypeCode2"/>
    <nodeSuccessors name="decision_no" next="JoinNode11"/>
  </nodes>
<!--@Location 2,36-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateProductTypeCode2">
    <configurationValues name="DefaultTypeCode" value="16"/>
    <configurationValues name="ProcessMethod" value="Subtract Typecode"/>
    <pipelet href="enfinity:/bc_mvc/pipelets/UpdateProductTypeCode.xml"/>
<!--@BendPoints 5,74-->
    <nodeSuccessors name="next" next="UpdateProductTypeCode5"/>
    <parameterBindings name="Product" objectPath="ProductMaster"/>
    <parameterBindings name="TypeCode" nullBinding="true"/>
  </nodes>
<!--@Location 2,37-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateProductTypeCode5">
    <configurationValues name="DefaultTypeCode" value="2"/>
    <configurationValues name="ProcessMethod" value="Add Typecode"/>
    <pipelet href="enfinity:/bc_mvc/pipelets/UpdateProductTypeCode.xml"/>
    <nodeSuccessors name="next" next="JoinNode10"/>
    <parameterBindings name="Product" objectPath="ProductMaster"/>
    <parameterBindings name="TypeCode" nullBinding="true"/>
  </nodes>
<!--@Location 2,38-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode10">
    <nodeSuccessors name="next" next="EndNode8"/>
  </nodes>
<!--@Location 2,39-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode8" strict="true"/>
<!--@Location 3,35-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode11">
<!--@BendPoints 7,77-->
    <nodeSuccessors name="next" next="JoinNode10"/>
  </nodes>
</pipeline:Pipeline>
