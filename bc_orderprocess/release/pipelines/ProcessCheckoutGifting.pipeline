<?xml version="1.0" encoding="UTF-8"?>
<!--This is the process pipeline for gift (wrap, message) handling in the checkout process.
@Group Checkout-->

<pipeline:Pipeline xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:pipeline="http://www.intershop.de/pipeline/2010"
    name="ProcessCheckoutGifting" type="process">
<!--@Location 29,1-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode9" strict="true" name="AdjustGiftOptionMarker"
      callMode="Private">
<!--@BendPoints 59,4-->
    <nodeSuccessors name="next" next="DecisionNode30"/>
    <parameters name="PLISplitInfo" type="com.intershop.component.basket.capi.BasketProductLineItemSplitInfo"/>
  </nodes>
<!--@Location 29,2-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode30" conditionKey="PLISplitInfo:get(&quot;GiftOptionMarked&quot;)"
      operator="str_eq" conditionValue="true">
<!--@BendPoints 59,6-->
    <nodeSuccessors name="decision_yes" next="DecisionNode32"/>
<!--@BendPoints 63,5 63,6-->
    <nodeSuccessors name="decision_no" next="DecisionNode33"/>
  </nodes>
<!--@Location 29,3-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode32" conditionKey="PLISplitInfo:get(&quot;GiftWrapProduct&quot;)"
      operator="undef">
<!--@BendPoints 59,8-->
    <nodeSuccessors name="decision_yes" next="DecisionNode31"/>
<!--@BendPoints 61,7-->
    <nodeSuccessors name="decision_no" next="JoinNode40"/>
  </nodes>
<!--@Location 29,4-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode31" conditionKey="PLISplitInfo:get(&quot;GiftMessageProduct&quot;)"
      operator="undef">
<!--@BendPoints 59,10-->
    <nodeSuccessors name="decision_yes" next="VerifyBoolean1"/>
    <nodeSuccessors name="decision_no" next="JoinNode40"/>
  </nodes>
<!--@Location 29,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="VerifyBoolean1">
    <pipelet href="enfinity:/bc_foundation/pipelets/VerifyBoolean.xml"/>
    <nodeSuccessors name="next" next="SetSplitGiftOptionMarker1"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode10"/>
    <parameterBindings name="NoneLocalizedString" constant="false"/>
    <returnValueBindings name="BooleanValue" objectPath="GiftOptionMarker"/>
  </nodes>
<!--@Location 29,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetSplitGiftOptionMarker1">
    <pipelet href="enfinity:/sld_ch_b2c_base/pipelets/SetSplitGiftOptionMarker.xml"/>
    <nodeSuccessors name="next" next="SetGiftOptionMarker0"/>
  </nodes>
<!--@Location 29,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetGiftOptionMarker0">
    <configurationValues name="GiftOptionMarker" value="true"/>
    <pipelet href="enfinity:/sld_ch_b2c_base/pipelets/SetGiftOptionMarker.xml"/>
    <nodeSuccessors name="next" next="JoinNode0"/>
    <parameterBindings name="BasketProductLineItemBO" objectPath="PLISplitInfo:OriginProductLineItem"/>
  </nodes>
<!--@Location 29,8-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode0">
    <nodeSuccessors name="next" next="EndNode12"/>
  </nodes>
<!--@Location 29,9-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode12" name="" strict="true"/>
<!--@Location 30,5-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode10">
    <nodeSuccessors name="next" next="JoinNode42"/>
  </nodes>
<!--@Location 30,8-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode42">
    <nodeSuccessors name="next" next="JoinNode0"/>
  </nodes>
<!--@Location 30,4-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode40">
    <nodeSuccessors name="next" next="JoinNode10"/>
  </nodes>
<!--@Location 31,3-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode33" conditionKey="PLISplitInfo:get(&quot;GiftWrapProduct&quot;)">
    <nodeSuccessors name="decision_yes" next="JoinNode16"/>
<!--@BendPoints 65,7 65,8-->
    <nodeSuccessors name="decision_no" next="DecisionNode34"/>
  </nodes>
<!--@Location 31,4-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode16">
    <nodeSuccessors name="next" next="VerifyBoolean2"/>
  </nodes>
<!--@Location 31,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="VerifyBoolean2">
    <pipelet href="enfinity:/bc_foundation/pipelets/VerifyBoolean.xml"/>
    <nodeSuccessors name="next" next="SetSplitGiftOptionMarker2"/>
    <parameterBindings name="NoneLocalizedString" constant="true"/>
    <returnValueBindings name="BooleanValue" objectPath="GiftOptionMarker"/>
  </nodes>
<!--@Location 31,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetSplitGiftOptionMarker2">
    <pipelet href="enfinity:/sld_ch_b2c_base/pipelets/SetSplitGiftOptionMarker.xml"/>
    <nodeSuccessors name="next" next="SetGiftOptionMarker1"/>
  </nodes>
<!--@Location 31,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetGiftOptionMarker1">
    <configurationValues name="GiftOptionMarker" value="true"/>
    <pipelet href="enfinity:/sld_ch_b2c_base/pipelets/SetGiftOptionMarker.xml"/>
    <nodeSuccessors name="next" next="JoinNode43"/>
    <parameterBindings name="BasketProductLineItemBO" objectPath="PLISplitInfo:OriginProductLineItem"/>
  </nodes>
<!--@Location 31,8-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode43">
    <nodeSuccessors name="next" next="JoinNode42"/>
  </nodes>
<!--@Location 32,4-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode34" conditionKey="PLISplitInfo:get(&quot;GiftMessageProduct&quot;)">
    <nodeSuccessors name="decision_yes" next="JoinNode16"/>
    <nodeSuccessors name="decision_no" next="JoinNode43"/>
  </nodes>
<!--@Location 39,1-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode10" name="GenerateForm" callMode="Private">
<!--@BendPoints 79,4-->
    <nodeSuccessors name="next" next="CallNode6"/>
  </nodes>
<!--@Location 39,2-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode6">
<!--@BendPoints 79,6-->
    <nodeSuccessors name="next" next="CreatePageableFromIterator1"/>
    <startNode referencedName="ProcessCheckoutGifting-GenerateFormIterator"/>
  </nodes>
<!--@Location 39,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreatePageableFromIterator1">
    <pipelet href="enfinity:/bc_foundation/pipelets/CreatePageableFromIterator.xml"/>
    <nodeSuccessors name="next" next="CreateListForm1"/>
    <parameterBindings name="Iterator" objectPath="FormKeyIterator"/>
  </nodes>
<!--@Location 39,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateListForm1">
    <configurationValues name="FormName" value="GiftingForm"/>
    <configurationValues name="ObjectIDMethod" value="toString"/>
    <configurationValues name="ResourceName" value="Gifting"/>
    <pipelet href="enfinity:/core/pipelets/CreateListForm.xml"/>
    <nodeSuccessors name="next" next="JoinNode3"/>
<!--@BendPoints 80,9 80,11-->
    <nodeSuccessors name="pipelet_error" next="JoinNode3"/>
    <parameterBindings name="PageableObject" objectPath="Pageable"/>
    <returnValueBindings name="Form" objectPath="GiftingForm"/>
  </nodes>
<!--@Location 39,5-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode3">
<!--@BendPoints 79,12-->
    <nodeSuccessors name="next" next="EndNode13"/>
  </nodes>
<!--@Location 39,6-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode13" name=""/>
<!--@Location 35,1-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode5" strict="true" name="GenerateFormIterator"
      callMode="Private">
    <nodeSuccessors name="next" next="AddEntryToMap6"/>
    <parameters name="CurrentCartBO" type="com.intershop.component.basket.capi.BasketBO"/>
    <parameters name="PLISplitInfoMap" type="com.intershop.component.basket.capi.BasketProductLineItemSplitInfoMap"
        optional="true"/>
  </nodes>
<!--@Location 35,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddEntryToMap6">
    <pipelet href="enfinity:/bc_foundation/pipelets/AddEntryToMap.xml"/>
    <nodeSuccessors name="next" next="LoopNode11"/>
    <parameterBindings name="InMap" objectPath="FormKeys"/>
    <parameterBindings name="Key" constant="Splitting"/>
    <parameterBindings name="Value" constant=""/>
    <returnValueBindings name="Keys" objectPath="FormKeyIterator"/>
    <returnValueBindings name="OutMap" objectPath="FormKeys"/>
  </nodes>
<!--TempBucket
@Location 35,3-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode11" loop="CurrentCartBO:Extension(&quot;ShippingMethod&quot;):BasketShippingMethodSelectionBucketBOs">
<!--@BendPoints 73,7 73,8-->
    <nodeSuccessors name="next" next="DecisionNode10"/>
    <entry key="Bucket">
      <nodeSuccessors name="loop_entry_next" next="AddEntryToMap2"/>
    </entry>
  </nodes>
<!--@Location 35,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddEntryToMap2">
    <pipelet href="enfinity:/bc_foundation/pipelets/AddEntryToMap.xml"/>
<!--@BendPoints 71,11 70,11 70,7-->
    <nodeSuccessors name="next" next="LoopNode11_Entry"/>
    <parameterBindings name="InMap" objectPath="FormKeys"/>
    <parameterBindings name="Key" objectPath="Bucket:ID"/>
    <parameterBindings name="Value" constant=""/>
    <returnValueBindings name="Keys" objectPath="FormKeyIterator"/>
    <returnValueBindings name="OutMap" objectPath="FormKeys"/>
  </nodes>
<!--@Location 36,4-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode10" conditionKey="PLISplitInfoMap">
    <nodeSuccessors name="decision_yes" next="JoinNode20"/>
<!--@BendPoints 75,9 75,10-->
    <nodeSuccessors name="decision_no" next="GetBasketProductLineItemSplitInfo2"/>
  </nodes>
<!--@Location 36,6-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode20">
<!--@BendPoints 73,14-->
    <nodeSuccessors name="next" next="LoopNode6"/>
  </nodes>
<!--@Location 36,7-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode6" loop="PLISplitInfoMap:KeySet">
<!--@BendPoints 74,15-->
    <nodeSuccessors name="next" next="EndNode2"/>
    <entry key="PLIBO">
      <nodeSuccessors name="loop_entry_next" next="LoopNode13"/>
    </entry>
  </nodes>
<!--@Location 36,8-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode13" loop="PLISplitInfoMap:get(PLIBO)">
<!--@BendPoints 74,17 74,21 71,21 71,15-->
    <nodeSuccessors name="next" next="LoopNode6_Entry"/>
    <entry key="PLISplitInfo">
<!--@BendPoints 73,18-->
      <nodeSuccessors name="loop_entry_next" next="AddEntryToMap3"/>
    </entry>
  </nodes>
<!--@Location 36,9-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddEntryToMap3">
    <pipelet href="enfinity:/bc_foundation/pipelets/AddEntryToMap.xml"/>
<!--@BendPoints 73,20 72,20 72,17-->
    <nodeSuccessors name="next" next="LoopNode13_Entry"/>
    <parameterBindings name="InMap" objectPath="FormKeys"/>
    <parameterBindings name="Key" objectPath="PLISplitInfo:ID"/>
    <parameterBindings name="Value" constant=""/>
    <returnValueBindings name="Keys" objectPath="FormKeyIterator"/>
    <returnValueBindings name="OutMap" objectPath="FormKeys"/>
  </nodes>
<!--@Location 37,7-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode2" name="" strict="true">
    <returnValues name="FormKeyIterator" type="java.util.Iterator" optional="true"/>
  </nodes>
<!--@Location 37,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetBasketProductLineItemSplitInfo2">
    <configurationValues name="strategyName" value="GiftingPLISplitInfoSplitStrategy"/>
    <pipelet href="enfinity:/sld_ch_b2c_base/pipelets/GetBasketProductLineItemSplitInfo.xml"/>
<!--@BendPoints 75,13-->
    <nodeSuccessors name="next" next="JoinNode20"/>
    <parameterBindings name="Basket" objectPath="CurrentCartBO"/>
  </nodes>
<!--@Location 48,1-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode15" strict="true" name="GetAllGiftMessages"
      callMode="Private">
<!--@BendPoints 97,4-->
    <nodeSuccessors name="next" next="LoopNode14"/>
    <parameters name="CurrentCartBO" type="com.intershop.component.basket.capi.BasketBO"
        optional="true"/>
  </nodes>
<!--@Location 48,2-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode14" loop="CurrentCartBO:ProductLineItemBOs">
<!--@BendPoints 98,5-->
    <nodeSuccessors name="next" next="EndNode19"/>
    <entry key="PLI">
<!--@BendPoints 97,6-->
      <nodeSuccessors name="loop_entry_next" next="LoopNode15"/>
    </entry>
  </nodes>
<!--@Location 48,3-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode15" loop="PLI:ProductBO:Extension(&quot;Gifting&quot;):ApplicableGiftMessages">
<!--@BendPoints 98,7 98,11 95,11 95,5-->
    <nodeSuccessors name="next" next="LoopNode14_Entry"/>
    <entry key="GiftMessage">
<!--@BendPoints 97,8-->
      <nodeSuccessors name="loop_entry_next" next="AddObjectToVector2"/>
    </entry>
  </nodes>
<!--@Location 48,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector2">
    <configurationValues name="Mode" value="Forbid Duplicates"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
<!--@BendPoints 97,10 96,10 96,7-->
    <nodeSuccessors name="next" next="LoopNode15_Entry"/>
    <parameterBindings name="InVector" objectPath="GiftMessagesVector"/>
    <parameterBindings name="Object" objectPath="GiftMessage"/>
    <parameterBindings name="Objects" nullBinding="true"/>
    <returnValueBindings name="Iterator" objectPath="GiftMessagesIterator"/>
    <returnValueBindings name="OutVector" objectPath="GiftMessagesVector"/>
  </nodes>
<!--@Location 49,2-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode19" name="" strict="true">
    <returnValues name="GiftMessages" type="java.util.Map" optional="true"/>
    <returnValues name="GiftMessagesVector" type="java.util.Vector" optional="true"/>
    <returnValues name="GiftMessagesIterator" type="java.util.Iterator" optional="true"/>
  </nodes>
<!--@Location 20,1-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode6" strict="true" name="GetAllGiftWraps"
      callMode="Private">
<!--@BendPoints 41,4-->
    <nodeSuccessors name="next" next="LoopNode7"/>
    <parameters name="CurrentCartBO" type="com.intershop.component.basket.capi.BasketBO"
        optional="true"/>
  </nodes>
<!--@Location 20,2-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode7" loop="CurrentCartBO:ProductLineItemBOs">
<!--@BendPoints 42,5-->
    <nodeSuccessors name="next" next="EndNode7"/>
    <entry key="PLI">
<!--@BendPoints 41,6-->
      <nodeSuccessors name="loop_entry_next" next="LoopNode8"/>
    </entry>
  </nodes>
<!--@Location 20,3-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode8" loop="PLI:ProductBO:Extension(&quot;Gifting&quot;):ApplicableGiftWraps">
<!--@BendPoints 42,7 42,11 39,11 39,5-->
    <nodeSuccessors name="next" next="LoopNode7_Entry"/>
    <entry key="GiftWrap">
<!--@BendPoints 41,8-->
      <nodeSuccessors name="loop_entry_next" next="AddObjectToVector1"/>
    </entry>
  </nodes>
<!--@Location 20,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector1">
    <configurationValues name="Mode" value="Forbid Duplicates"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
<!--@BendPoints 41,10 40,10 40,7-->
    <nodeSuccessors name="next" next="LoopNode8_Entry"/>
    <parameterBindings name="InVector" objectPath="GiftWrapsVector"/>
    <parameterBindings name="Object" objectPath="GiftWrap"/>
    <parameterBindings name="Objects" nullBinding="true"/>
    <returnValueBindings name="Iterator" objectPath="GiftWrapsIterator"/>
    <returnValueBindings name="OutVector" objectPath="GiftWrapsVector"/>
  </nodes>
<!--@Location 21,2-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode7" name="" strict="true">
    <returnValues name="GiftWraps" type="java.util.Map" optional="true"/>
    <returnValues name="GiftWrapsVector" type="java.util.Vector" optional="true"/>
    <returnValues name="GiftWrapsIterator" type="java.util.Iterator" optional="true"/>
  </nodes>
<!--@Location 26,1-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode8" strict="true" name="GetMessageProductBO"
      callMode="Private">
<!--@BendPoints 53,4-->
    <nodeSuccessors name="next" next="LoopNode10"/>
    <parameters name="PLI" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
    <parameters name="MessageId" type="java.lang.String"/>
  </nodes>
<!--@Location 26,2-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode10" loop="PLI:ProductBO:Extension(&quot;Gifting&quot;):ApplicableGiftMessages">
<!--@BendPoints 54,5-->
    <nodeSuccessors name="next" next="EndNode11"/>
    <entry key="GiftMessageProduct">
<!--@BendPoints 53,6-->
      <nodeSuccessors name="loop_entry_next" next="DecisionNode29"/>
    </entry>
  </nodes>
<!--@Location 26,3-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode29" conditionKey="MessageId"
      operator="str_eq" conditionItem="GiftMessageProduct:ID">
<!--@BendPoints 53,8-->
    <nodeSuccessors name="decision_yes" next="EndNode10"/>
<!--@BendPoints 54,7 54,10 52,10 52,6 52,5-->
    <nodeSuccessors name="decision_no" next="LoopNode10_Entry"/>
  </nodes>
<!--@Location 26,4-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode10" name="" strict="true">
    <returnValues name="GiftMessageProduct" type="com.intershop.component.product.capi.ProductBO"
        optional="true"/>
  </nodes>
<!--@Location 27,2-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode11" name="error" strict="true"/>
<!--@Location 5,13-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode13" strict="true" name="GetSplitProductLineItems"
      callMode="Private">
<!--@BendPoints 11,28-->
    <nodeSuccessors name="next" next="GetBasketProductLineItemSplitInfo1"/>
    <parameters name="CurrentCartBO" type="com.intershop.component.basket.capi.BasketBO"
        optional="true"/>
  </nodes>
<!--@Location 5,14-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetBasketProductLineItemSplitInfo1">
    <configurationValues name="strategyName" value="GiftingPLISplitInfoSplitStrategy"/>
    <pipelet href="enfinity:/sld_ch_b2c_base/pipelets/GetBasketProductLineItemSplitInfo.xml"/>
<!--@BendPoints 11,30-->
    <nodeSuccessors name="next" next="EndNode17"/>
    <parameterBindings name="Basket" objectPath="CurrentCartBO"/>
  </nodes>
<!--@Location 5,15-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode17" name="" strict="true">
<!--The map of the splitPLIs.-->
    <returnValues name="PLISplitInfoMap" type="com.intershop.component.basket.capi.BasketProductLineItemSplitInfoMap"
        optional="true"/>
  </nodes>
<!--@Location 23,1-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode7" strict="true" name="GetWrapProductBO"
      callMode="Private">
<!--@BendPoints 47,4-->
    <nodeSuccessors name="next" next="LoopNode9"/>
    <parameters name="PLI" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
    <parameters name="WrapId" type="java.lang.String"/>
  </nodes>
<!--@Location 23,2-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode9" loop="PLI:ProductBO:Extension(&quot;Gifting&quot;):ApplicableGiftWraps">
<!--@BendPoints 48,5-->
    <nodeSuccessors name="next" next="EndNode9"/>
    <entry key="WrapProduct">
<!--@BendPoints 47,6-->
      <nodeSuccessors name="loop_entry_next" next="DecisionNode28"/>
    </entry>
  </nodes>
<!--@Location 23,3-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode28" conditionKey="WrapId"
      operator="str_eq" conditionItem="WrapProduct:ID">
<!--@BendPoints 47,8-->
    <nodeSuccessors name="decision_yes" next="EndNode8"/>
<!--@BendPoints 48,7 48,10 46,10 46,5-->
    <nodeSuccessors name="decision_no" next="LoopNode9_Entry"/>
  </nodes>
<!--@Location 23,4-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode8" name="" strict="true">
    <returnValues name="WrapProduct" type="com.intershop.component.product.capi.ProductBO"
        optional="true"/>
  </nodes>
<!--@Location 24,2-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode9" name="error" strict="true"/>
<!--@Location 16,1-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode4" strict="true" name="IsGiftMessageEmpty"
      callMode="Private">
<!--@BendPoints 33,4-->
    <nodeSuccessors name="next" next="DecisionNode16"/>
    <parameters name="To" type="java.lang.String" optional="true"/>
    <parameters name="From" type="java.lang.String" optional="true"/>
    <parameters name="Text" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 16,2-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode16" conditionKey="To"
      operator="undef">
    <nodeSuccessors name="decision_yes" next="JoinNode24"/>
<!--@BendPoints 35,5 35,6-->
    <nodeSuccessors name="decision_no" next="DecisionNode19"/>
  </nodes>
<!--@Location 16,3-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode24">
    <nodeSuccessors name="next" next="DecisionNode17"/>
  </nodes>
<!--@Location 16,4-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode17" conditionKey="From"
      operator="undef">
    <nodeSuccessors name="decision_yes" next="JoinNode25"/>
<!--@BendPoints 35,9 35,10-->
    <nodeSuccessors name="decision_no" next="DecisionNode20"/>
  </nodes>
<!--@Location 16,5-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode25">
<!--@BendPoints 33,12-->
    <nodeSuccessors name="next" next="DecisionNode18"/>
  </nodes>
<!--@Location 16,6-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode18" conditionKey="Text"
      operator="undef">
    <nodeSuccessors name="decision_yes" next="JoinNode26"/>
<!--@BendPoints 35,13 35,14-->
    <nodeSuccessors name="decision_no" next="DecisionNode21"/>
  </nodes>
<!--@Location 16,7-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode26">
<!--@BendPoints 33,16-->
    <nodeSuccessors name="next" next="EndNode5"/>
  </nodes>
<!--@Location 16,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode5" name="" strict="true"/>
<!--@Location 17,7-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode21" conditionKey="Text"
      operator="str_empty">
<!--@BendPoints 35,16 34,16-->
    <nodeSuccessors name="decision_yes" next="JoinNode26"/>
    <nodeSuccessors name="decision_no" next="JoinNode28"/>
  </nodes>
<!--@Location 18,7-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode28">
<!--@BendPoints 37,16-->
    <nodeSuccessors name="next" next="EndNode6"/>
  </nodes>
<!--@Location 18,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode6" name="notEmpty" strict="true"/>
<!--@Location 17,5-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode20" conditionKey="From"
      operator="str_empty">
<!--@BendPoints 35,12 34,12-->
    <nodeSuccessors name="decision_yes" next="JoinNode25"/>
    <nodeSuccessors name="decision_no" next="JoinNode27"/>
  </nodes>
<!--@Location 18,5-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode27">
    <nodeSuccessors name="next" next="JoinNode28"/>
  </nodes>
<!--@Location 17,3-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode19" conditionKey="To"
      operator="str_empty">
<!--@BendPoints 35,8 34,8-->
    <nodeSuccessors name="decision_yes" next="JoinNode24"/>
<!--@BendPoints 37,7-->
    <nodeSuccessors name="decision_no" next="JoinNode27"/>
  </nodes>
<!--@Location 7,13-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode14" strict="true" name="SetMergedProductLineItems"
      callMode="Private">
    <nodeSuccessors name="next" next="SetBasketProductLineItemSplitInfo1"/>
    <parameters name="CurrentCartBO" type="com.intershop.component.basket.capi.BasketBO"/>
    <parameters name="PLISplitInfoMap" type="com.intershop.component.basket.capi.BasketProductLineItemSplitInfoMap"/>
  </nodes>
<!--@Location 7,14-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetBasketProductLineItemSplitInfo1">
    <configurationValues name="strategyName" value="GiftingPLISplitInfoMergeStrategy"/>
    <pipelet href="enfinity:/sld_ch_b2c_base/pipelets/SetBasketProductLineItemSplitInfo.xml"/>
    <nodeSuccessors name="next" next="CallNode12"/>
    <parameterBindings name="Basket" objectPath="CurrentCartBO"/>
  </nodes>
<!--@Location 7,15-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode12">
    <nodeSuccessors name="next" next="CallNode13"/>
    <parameterBindings name="BasketBO" objectPath="CurrentCartBO"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 7,16-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode13">
    <nodeSuccessors name="next" next="EndNode18"/>
    <parameterBindings name="Basket" objectPath="CurrentCartBO"/>
    <startNode referencedName="ProcessBasket-Calculate"/>
  </nodes>
<!--@Location 7,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode18" name="" strict="true"/>
<!--@Location 45,1-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode12" name="SetValidationRules"
      callMode="Private">
    <nodeSuccessors name="next" next="ConcatenateStrings5"/>
  </nodes>
<!--@Location 45,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ConcatenateStrings5">
    <pipelet href="enfinity:/bc_foundation/pipelets/ConcatenateStrings.xml"/>
    <nodeSuccessors name="next" next="AddEntryToMap5"/>
    <parameterBindings name="String0" objectPath="GiftMessage_Form_MessageLength"/>
    <returnValueBindings name="Concatenated" objectPath="GiftMessage_Form_MessageLength"/>
  </nodes>
<!--@Location 45,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddEntryToMap5">
    <pipelet href="enfinity:/bc_foundation/pipelets/AddEntryToMap.xml"/>
    <nodeSuccessors name="next" next="AddValidateDefinition2"/>
    <parameterBindings name="Key" constant="maxLength"/>
    <parameterBindings name="Value" objectPath="GiftMessage_Form_MessageLength"/>
    <returnValueBindings name="OutMap" objectPath="giftMessageTextLengthRule"/>
  </nodes>
<!--@Location 45,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddValidateDefinition2">
    <pipelet href="enfinity:/core/pipelets/AddValidateDefinition.xml"/>
    <nodeSuccessors name="next" next="CheckForEmptyString0"/>
    <parameterBindings name="Target" objectPath="Subform:GiftMessageText"/>
    <parameterBindings name="ValidationProperties" objectPath="giftMessageTextLengthRule"/>
    <parameterBindings name="Validator" constant="GlobalValidators-maxlength"/>
  </nodes>
<!--@Location 45,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CheckForEmptyString0">
    <pipelet href="enfinity:/core/pipelets/CheckForEmptyString.xml"/>
    <nodeSuccessors name="next" next="AddValidateDefinition0"/>
<!--@BendPoints 93,11 93,15-->
    <nodeSuccessors name="pipelet_error" next="JoinNode5"/>
    <parameterBindings name="FilledString" objectPath="Subform:GiftMessageSelection:Value"/>
  </nodes>
<!--@Location 45,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddValidateDefinition0">
    <pipelet href="enfinity:/core/pipelets/AddValidateDefinition.xml"/>
    <nodeSuccessors name="next" next="JoinNode5"/>
    <parameterBindings name="Target" objectPath="Subform:GiftMessageText"/>
    <parameterBindings name="Validator" constant="GlobalValidators-required"/>
  </nodes>
<!--@Location 45,7-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode5">
    <nodeSuccessors name="next" next="EndNode16"/>
  </nodes>
<!--@Location 45,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode16" name=""/>
<!--@Location 12,1-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode3" name="UpdateGiftMessage"
      callMode="Private">
    <nodeSuccessors name="next" next="DecisionNode14"/>
  </nodes>
<!--@Location 12,2-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode14" conditionKey="GiftMessage_Switch">
<!--@BendPoints 25,6-->
    <nodeSuccessors name="decision_yes" next="DecisionNode15"/>
<!--@BendPoints 27,5-->
    <nodeSuccessors name="decision_no" next="JoinNode22"/>
  </nodes>
<!--@Location 12,3-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode15" conditionKey="GiftMessage_Switch"
      operator="str_eq" conditionValue="true">
<!--@BendPoints 25,8-->
    <nodeSuccessors name="decision_yes" next="LoopNode4"/>
    <nodeSuccessors name="decision_no" next="JoinNode22"/>
  </nodes>
<!--TempBucket
@Location 12,4-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode4" loop="PLISplitInfoMap:KeySet">
    <nodeSuccessors name="next" next="JoinNode23"/>
    <entry key="PLIBO">
<!--@BendPoints 25,10-->
      <nodeSuccessors name="loop_entry_next" next="LoopNode5"/>
    </entry>
  </nodes>
<!--@Location 12,5-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode5" loop="PLISplitInfoMap:get(PLIBO)">
    <nodeSuccessors name="next" next="LoopNode4_Entry"/>
    <entry key="PLISplitInfo">
<!--@BendPoints 25,12-->
      <nodeSuccessors name="loop_entry_next" next="KeyMapper1"/>
    </entry>
  </nodes>
<!--@Location 12,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper1">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="DecisionNode26"/>
    <parameterBindings name="InValue_1" objectPath="GiftingForm:get(PLISplitInfo:ID)"/>
    <returnValueBindings name="OutValue_1" objectPath="Subform"/>
  </nodes>
<!--@Location 12,7-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode26" conditionKey="Subform:Gifting:Value"
      operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="CallNode1"/>
    <nodeSuccessors name="decision_no" next="CallNode14"/>
  </nodes>
<!--@Location 12,9-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode1">
    <nodeSuccessors name="next" next="SetFormParameterValue0"/>
    <startNode referencedName="This:UpdateSplitPLIGiftMessage"/>
  </nodes>
<!--@Location 13,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue0">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
    <nodeSuccessors name="next" next="LoopNode4"/>
    <parameterBindings name="FormParameter" objectPath="Subform:Gifting"/>
    <parameterBindings name="Value" nullBinding="true"/>
  </nodes>
<!--@Location 11,6-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode14">
    <nodeSuccessors name="next" next="LoopNode5_Entry"/>
    <startNode referencedName="ProcessCheckoutGifting-UpdateSplitPLIGiftMessage"/>
  </nodes>
<!--@Location 13,4-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode23">
    <nodeSuccessors name="next" next="CallNode4"/>
  </nodes>
<!--@Location 14,4-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode4">
    <nodeSuccessors name="next" next="EndNode4"/>
    <parameterBindings name="Basket" objectPath="CurrentCart"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 15,4-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode4" name="" strict="true"/>
<!--@Location 13,3-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode22">
    <nodeSuccessors name="next" next="JoinNode23"/>
  </nodes>
<!--@Location 6,1-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode2" name="UpdateGiftWrap" callMode="Private">
    <nodeSuccessors name="next" next="DecisionNode8"/>
  </nodes>
<!--@Location 6,2-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode8" conditionKey="GiftWrap_Switch">
<!--@BendPoints 13,6-->
    <nodeSuccessors name="decision_yes" next="DecisionNode7"/>
<!--@BendPoints 17,5-->
    <nodeSuccessors name="decision_no" next="JoinNode14"/>
  </nodes>
<!--@Location 6,3-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode7" conditionKey="GiftWrap_Switch"
      operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="LoopNode1"/>
    <nodeSuccessors name="decision_no" next="JoinNode14"/>
  </nodes>
<!--@Location 6,4-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode1" loop="PLISplitInfoMap:KeySet">
    <nodeSuccessors name="next" next="JoinNode15"/>
    <entry key="PLIBO">
<!--@BendPoints 13,10-->
      <nodeSuccessors name="loop_entry_next" next="LoopNode2"/>
    </entry>
  </nodes>
<!--@Location 6,5-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode2" loop="PLISplitInfoMap:get(PLIBO)">
<!--@BendPoints 17,11 17,20 11,20 11,9-->
    <nodeSuccessors name="next" next="LoopNode1_Entry"/>
    <entry key="PLISplitInfo">
<!--@BendPoints 13,12-->
      <nodeSuccessors name="loop_entry_next" next="KeyMapper2"/>
    </entry>
  </nodes>
<!--@Location 6,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper2">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="DecisionNode9"/>
    <parameterBindings name="InValue_1" objectPath="GiftingForm:get(PLISplitInfo:ID)"/>
    <returnValueBindings name="OutValue_1" objectPath="Subform"/>
  </nodes>
<!--@Location 6,7-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode9" conditionKey="Subform:Gifting:Value"
      operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="CallNode2"/>
<!--@BendPoints 15,15 15,16-->
    <nodeSuccessors name="decision_no" next="Pipelet1"/>
  </nodes>
<!--@Location 6,8-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode2">
    <nodeSuccessors name="next" next="JoinNode9"/>
    <startNode referencedName="ProcessCheckoutGifting-UpdateSplitPLIGiftWrap"/>
  </nodes>
<!--@Location 6,9-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode9">
<!--@BendPoints 12,19 12,11-->
    <nodeSuccessors name="next" next="LoopNode2_Entry"/>
  </nodes>
<!--@Location 7,8-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet1">
    <configurationValues name="GiftOptionMarker" value="false"/>
    <pipelet href="enfinity:/sld_ch_b2c_base/pipelets/SetGiftOptionMarker.xml"/>
<!--@BendPoints 15,19-->
    <nodeSuccessors name="next" next="JoinNode9"/>
    <parameterBindings name="BasketProductLineItemBO" objectPath="PLIBO"/>
  </nodes>
<!--@Location 8,4-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode15">
    <nodeSuccessors name="next" next="CallNode0"/>
  </nodes>
<!--@Location 9,4-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode0">
    <nodeSuccessors name="next" next="EndNode3"/>
    <parameterBindings name="Basket" objectPath="CurrentCart"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 9,5-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode3" name="" strict="true"/>
<!--@Location 8,3-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode14">
    <nodeSuccessors name="next" next="JoinNode15"/>
  </nodes>
<!--@Location 13,13-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode16" strict="true" name="UpdateSplitPLIGiftMessage"
      callMode="Private">
<!--@BendPoints 27,28-->
    <nodeSuccessors name="next" next="DecisionNode13"/>
    <parameters name="PLISplitInfo" type="com.intershop.component.basket.capi.BasketProductLineItemSplitInfo"/>
    <parameters name="PLIBO" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
    <parameters name="Subform" type="com.intershop.beehive.core.capi.webform.Form"/>
  </nodes>
<!--@Location 13,14-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode13" conditionKey="PLIBO:Extension(&quot;Gifting&quot;):GiftMessagable"
      operator="str_eq" conditionValue="true">
<!--@BendPoints 27,30-->
    <nodeSuccessors name="decision_yes" next="CallNode10"/>
<!--@BendPoints 31,29-->
    <nodeSuccessors name="decision_no" next="JoinNode8"/>
  </nodes>
<!--@Location 13,15-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode10">
    <nodeSuccessors name="next" next="JoinNode8"/>
<!--@BendPoints 27,32-->
    <nodeSuccessors name="notEmpty" next="DecisionNode12"/>
    <parameterBindings name="From" objectPath="Subform:GiftMessageFrom:Value"/>
    <parameterBindings name="Text" objectPath="Subform:GiftMessageText:Value"/>
    <parameterBindings name="To" objectPath="Subform:GiftMessageTo:Value"/>
    <startNode referencedName="ProcessCheckoutGifting-IsGiftMessageEmpty"/>
  </nodes>
<!--@Location 15,15-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode8">
    <nodeSuccessors name="next" next="JoinNode7"/>
  </nodes>
<!--@Location 15,16-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode7">
    <nodeSuccessors name="next" next="JoinNode1"/>
  </nodes>
<!--@Location 15,17-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode1">
    <nodeSuccessors name="next" next="JoinNode13"/>
  </nodes>
<!--@Location 15,18-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode13">
<!--@BendPoints 31,40-->
    <nodeSuccessors name="next" next="SetSplitGiftMessageOption3"/>
  </nodes>
<!--@Location 15,20-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetSplitGiftMessageOption3">
    <pipelet href="enfinity:/sld_ch_b2c_base/pipelets/SetSplitGiftMessageOption.xml"/>
<!--@BendPoints 31,43-->
    <nodeSuccessors name="next" next="JoinNode21"/>
    <parameterBindings name="GiftMessage" nullBinding="true"/>
    <parameterBindings name="GiftMessageText" nullBinding="true"/>
  </nodes>
<!--@Location 13,21-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode21">
<!--@BendPoints 27,44-->
    <nodeSuccessors name="next" next="CallNode11"/>
  </nodes>
<!--@Location 13,22-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode11">
<!--@BendPoints 27,46-->
    <nodeSuccessors name="next" next="EndNode20"/>
    <startNode referencedName="ProcessCheckoutGifting-AdjustGiftOptionMarker"/>
  </nodes>
<!--@Location 13,23-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode20" name="" strict="true"/>
<!--@Location 13,16-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode12" conditionKey="Subform:GiftMessageSelection:Value">
<!--@BendPoints 27,34-->
    <nodeSuccessors name="decision_yes" next="CallNode9"/>
    <nodeSuccessors name="decision_no" next="JoinNode7"/>
  </nodes>
<!--@Location 13,17-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode9">
    <nodeSuccessors name="next" next="DecisionNode23"/>
    <nodeSuccessors name="error" next="JoinNode1"/>
    <parameterBindings name="MessageId" objectPath="Subform:GiftMessageSelection:Value"/>
    <parameterBindings name="PLI" objectPath="PLIBO"/>
    <startNode referencedName="ProcessCheckoutGifting-GetMessageProductBO"/>
    <returnValueBindings name="GiftMessageProduct" objectPath="GiftMessage"/>
  </nodes>
<!--@Location 13,18-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode23" conditionKey="GiftMessage">
    <nodeSuccessors name="decision_yes" next="CreateLineItemMessage3"/>
    <nodeSuccessors name="decision_no" next="JoinNode13"/>
  </nodes>
<!--@Location 13,19-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateLineItemMessage3">
    <pipelet href="enfinity:/sld_ch_b2c_base/pipelets/CreateLineItemMessage.xml"/>
<!--@BendPoints 27,40-->
    <nodeSuccessors name="next" next="SetSplitGiftMessageOption4"/>
    <parameterBindings name="From" objectPath="Subform:GiftMessageFrom:Value"/>
    <parameterBindings name="Message" objectPath="Subform:GiftMessageText:Value"/>
    <parameterBindings name="To" objectPath="Subform:GiftMessageTo:Value"/>
    <returnValueBindings name="LineItemMessage" objectPath="GiftMessageText"/>
  </nodes>
<!--@Location 13,20-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetSplitGiftMessageOption4">
    <pipelet href="enfinity:/sld_ch_b2c_base/pipelets/SetSplitGiftMessageOption.xml"/>
    <nodeSuccessors name="next" next="JoinNode21"/>
  </nodes>
<!--@Location 9,13-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode17" strict="true" name="UpdateSplitPLIGiftWrap"
      callMode="Private">
<!--@BendPoints 19,28-->
    <nodeSuccessors name="next" next="DecisionNode3"/>
    <parameters name="PLISplitInfo" type="com.intershop.component.basket.capi.BasketProductLineItemSplitInfo"/>
    <parameters name="PLIBO" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
    <parameters name="Subform" type="com.intershop.beehive.core.capi.webform.Form"/>
  </nodes>
<!--@Location 9,14-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode3" conditionKey="PLIBO:Extension(&quot;Gifting&quot;):GiftWrappable"
      operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="DecisionNode24"/>
<!--@BendPoints 23,29-->
    <nodeSuccessors name="decision_no" next="JoinNode19"/>
  </nodes>
<!--@Location 9,16-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode24" conditionKey="Subform:GiftWrapSelection:Value">
    <nodeSuccessors name="decision_yes" next="CallNode5"/>
    <nodeSuccessors name="decision_no" next="JoinNode29"/>
  </nodes>
<!--@Location 9,17-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode5">
    <nodeSuccessors name="next" next="DecisionNode22"/>
    <nodeSuccessors name="error" next="JoinNode30"/>
    <parameterBindings name="PLI" objectPath="PLIBO"/>
    <parameterBindings name="WrapId" objectPath="Subform:GiftWrapSelection:Value"/>
    <startNode referencedName="ProcessCheckoutGifting-GetWrapProductBO"/>
  </nodes>
<!--@Location 9,18-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode22" conditionKey="WrapProduct">
    <nodeSuccessors name="decision_yes" next="SetSplitGiftWrapOption4"/>
    <nodeSuccessors name="decision_no" next="JoinNode31"/>
  </nodes>
<!--@Location 9,19-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetSplitGiftWrapOption4">
    <pipelet href="enfinity:/sld_ch_b2c_base/pipelets/SetSplitGiftWrapOption.xml"/>
    <nodeSuccessors name="next" next="JoinNode18"/>
    <parameterBindings name="GiftWrap" objectPath="WrapProduct"/>
  </nodes>
<!--@Location 9,20-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode18">
<!--@BendPoints 19,42-->
    <nodeSuccessors name="next" next="CallNode3"/>
  </nodes>
<!--@Location 9,21-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode3">
<!--@BendPoints 19,44-->
    <nodeSuccessors name="next" next="EndNode21"/>
    <startNode referencedName="ProcessCheckoutGifting-AdjustGiftOptionMarker"/>
  </nodes>
<!--@Location 9,22-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode21" name="" strict="true"/>
<!--@Location 11,18-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode31">
    <nodeSuccessors name="next" next="SetSplitGiftWrapOption3"/>
  </nodes>
<!--@Location 11,19-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetSplitGiftWrapOption3">
    <pipelet href="enfinity:/sld_ch_b2c_base/pipelets/SetSplitGiftWrapOption.xml"/>
<!--@BendPoints 23,41-->
    <nodeSuccessors name="next" next="JoinNode18"/>
    <parameterBindings name="GiftWrap" nullBinding="true"/>
  </nodes>
<!--@Location 11,17-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode30">
    <nodeSuccessors name="next" next="JoinNode31"/>
  </nodes>
<!--@Location 11,16-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode29">
    <nodeSuccessors name="next" next="JoinNode30"/>
  </nodes>
<!--@Location 11,15-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode19">
    <nodeSuccessors name="next" next="JoinNode29"/>
  </nodes>
<!--@Location 41,1-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode11" name="ValidateForm" callMode="Private">
<!--@BendPoints 83,4-->
    <nodeSuccessors name="next" next="CallNode7"/>
  </nodes>
<!--@Location 41,2-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode7">
<!--@BendPoints 83,6-->
    <nodeSuccessors name="next" next="LoopNode12"/>
    <startNode referencedName="ProcessCheckoutGifting-GenerateForm"/>
  </nodes>
<!--@Location 41,3-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode12" loop="GiftingForm:Instances">
<!--@BendPoints 84,7 84,5-->
    <nodeSuccessors name="next" next="DecisionNode35"/>
    <entry key="Subform">
      <nodeSuccessors name="loop_entry_next" next="FillForm0"/>
    </entry>
  </nodes>
<!--@Location 41,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="FillForm0">
    <pipelet href="enfinity:/core/pipelets/FillForm.xml"/>
    <nodeSuccessors name="next" next="DecisionNode0"/>
    <parameterBindings name="Form" objectPath="Subform"/>
  </nodes>
<!--@Location 41,5-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode0" conditionKey="Subform:Gifting:Value"
      operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="CallNode8"/>
<!--@BendPoints 87,11-->
    <nodeSuccessors name="decision_no" next="JoinNode2"/>
  </nodes>
<!--@Location 41,6-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode8">
    <nodeSuccessors name="next" next="ValidateForm2"/>
    <startNode referencedName="ProcessCheckoutGifting-SetValidationRules"/>
  </nodes>
<!--@Location 41,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ValidateForm2">
    <configurationValues name="Trim" value="true"/>
    <pipelet href="enfinity:/core/pipelets/ValidateForm.xml"/>
    <nodeSuccessors name="next" next="JoinNode4"/>
<!--@BendPoints 84,15-->
    <nodeSuccessors name="pipelet_error" next="SetDictionaryValue1"/>
    <parameterBindings name="Form" objectPath="Subform"/>
  </nodes>
<!--@Location 41,8-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode4">
<!--@BendPoints 82,17 81,17 81,13 82,7-->
    <nodeSuccessors name="next" next="LoopNode12_Entry"/>
  </nodes>
<!--@Location 42,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetDictionaryValue1">
    <configurationValues name="Name" value="FormError"/>
    <configurationValues name="Value" value="true"/>
    <configurationValues name="ValueType" value="Dictionary Value"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetDictionaryValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode2"/>
  </nodes>
<!--@Location 43,7-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode2">
<!--@BendPoints 87,17-->
    <nodeSuccessors name="next" next="JoinNode4"/>
  </nodes>
<!--@Location 42,2-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode35" conditionKey="FormError">
<!--@BendPoints 86,5-->
    <nodeSuccessors name="decision_yes" next="EndNode15"/>
    <nodeSuccessors name="decision_no" next="EndNode14"/>
  </nodes>
<!--@Location 43,2-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode15" name="ERROR"/>
<!--@Location 42,3-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode14" name=""/>
</pipeline:Pipeline>
