<?xml version="1.0" encoding="UTF-8"?>
<!--Removes all user related 
data from the basket.
@Group Basket-->

<pipeline:Pipeline xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:pipeline="http://www.intershop.de/pipeline/2010"
    name="ProcessBasket" overrideMode="Inherit" type="Process">
<!--Basket
@Location 0,1-->
  <nodes xsi:type="pipeline:Text" nodeID="Text0"/>
<!--Line Items
@Location 0,10-->
  <nodes xsi:type="pipeline:Text" nodeID="Text1"/>
<!--Warranties
@Location 11,10-->
  <nodes xsi:type="pipeline:Text" nodeID="Text3"/>
<!--Other 

@Location 0,20-->
  <nodes xsi:type="pipeline:Text" nodeID="Text4"/>
<!--Adds the given Gift Card (GC) or 
Online Gift Certificate (OGC) to 
the basket.
@Location 9,11-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode16" strict="true" name="AddGiftCard"
      callMode="Private">
    <nodeSuccessors name="next" next="CreateGiftCardAdditionalParameters0"/>
<!--The basket the gift card has to be added to.-->
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
<!--The gift card to add.-->
    <parameters name="Product" type="com.intershop.component.product.capi.ProductBO"/>
<!--The requested quantity of the gift card to be added.-->
    <parameters name="Quantity" type="com.intershop.beehive.foundation.quantity.Quantity"/>
<!--The merge group specifier.-->
    <parameters name="MergeGroup" type="java.lang.Integer" optional="true"/>
<!--If true a new line item should be created in every case, even if an line item for the specified gift card exists.-->
    <parameters name="ForceSeparateLineItem" type="java.lang.Boolean" optional="true"/>
<!--Map of additional parameters for the handler processing the request.-->
    <parameters name="AdditionalParameters" type="java.util.Map&lt;java.lang.String,java.lang.String>"
        optional="true"/>
<!--The email address of the gift card recipient.-->
    <parameters name="GIFTCARD_RecipientEmail" type="java.lang.String"/>
<!--The name of the gift card recipient.-->
    <parameters name="GIFTCARD_RecipientName" type="java.lang.String"/>
<!--The email address of the gift card sender.-->
    <parameters name="GIFTCARD_SenderEmail" type="java.lang.String"/>
<!--The gift card sender name.-->
    <parameters name="GIFTCARD_SenderName" type="java.lang.String"/>
    <parameters name="GIFTCARD_GreetingMessage" type="java.lang.String"/>
  </nodes>
<!--@Location 9,12-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateGiftCardAdditionalParameters0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/CreateGiftCardAdditionalParameters.xml"/>
    <nodeSuccessors name="next" next="ExtensionPointNode10"/>
    <parameterBindings name="Parameters" objectPath="AdditionalParameters"/>
    <returnValueBindings name="Parameters" objectPath="AdditionalParameters"/>
  </nodes>
<!--@Location 9,13-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode10" name="AddGiftCardToBasket"
      strict="true">
    <nodeSuccessors name="next" next="AddProduct0" action="begin"/>
<!--@BendPoints 21,27-->
    <nodeSuccessors name="pipelet_error" next="JoinNode21"/>
<!--The basket the gift card has to be added to.-->
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
<!--The gift card to add.-->
    <parameters name="Product" type="com.intershop.component.product.capi.ProductBO"/>
<!--The requested quantity of the gift card to be added.-->
    <parameters name="Quantity" type="com.intershop.beehive.foundation.quantity.Quantity"/>
<!--The merge group specifier.-->
    <parameters name="MergeGroup" type="java.lang.Integer" optional="true"/>
<!--If true a new line item should be created in every case, even if an line item for the specified gift card exists.-->
    <parameters name="ForceSeparateLineItem" type="java.lang.Boolean" optional="true"/>
<!--Map of additional parameters for the handler processing the request.-->
    <parameters name="AdditionalParameters" type="java.util.Map&lt;java.lang.String,java.lang.String>"
        optional="true"/>
    <parameterBindings name="AdditionalParameters" objectPath="Parameters"/>
  </nodes>
<!--@Location 9,14-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddProduct0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/AddProduct.xml"/>
    <nodeSuccessors name="next" next="CallNode11"/>
  </nodes>
<!--@Location 9,15-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode11">
    <nodeSuccessors name="next" next="ExtensionPointNode11"/>
    <parameterBindings name="Basket" nullBinding="true"/>
    <parameterBindings name="BasketBO" objectPath="Basket"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 9,16-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode11" name="AddedGiftCardToBasket"
      strict="true">
    <nodeSuccessors name="next" next="EndNode19" action="commit"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode21" action="rollback"/>
<!--The basket the gift card has to be added to.-->
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
<!--The gift card to add.-->
    <parameters name="Product" type="com.intershop.component.product.capi.ProductBO"/>
<!--The requested quantity of the gift card to be added.-->
    <parameters name="Quantity" type="com.intershop.beehive.foundation.quantity.Quantity"/>
<!--The merge group specifier.-->
    <parameters name="MergeGroup" type="java.lang.Integer" optional="true"/>
<!--If true a new line item should be created in every case, even if an line item for the specified gift card exists.-->
    <parameters name="ForceSeparateLineItem" type="java.lang.Boolean" optional="true"/>
<!--Map of additional parameters for the handler processing the request.-->
    <parameters name="AdditionalParameters" type="java.util.Map&lt;java.lang.String,java.lang.String>"
        optional="true"/>
<!--@deprecated since 7.7. use AddToBasketResults instead
The result of the attemp to add a product.-->
    <parameters name="AddToBasketResult" type="com.intershop.component.basket.capi.AddToBasketResult"/>
<!--The result of the attemp to add a product.-->
    <parameters name="AddToBasketResults" type="com.intershop.component.basket.capi.AddToBasketResults"/>
  </nodes>
<!--@Location 9,18-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode19" strict="true">
<!--@deprecated since 7.7. use AddToBasketResults instead
The result of the attemp to add a product.-->
    <returnValues name="AddToBasketResult" type="com.intershop.component.basket.capi.AddToBasketResult"/>
<!--The result of the attemp to add a product.-->
    <returnValues name="AddToBasketResults" type="com.intershop.component.basket.capi.AddToBasketResults"/>
  </nodes>
<!--@Location 10,16-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode21">
    <nodeSuccessors name="next" next="EndNode30"/>
  </nodes>
<!--@Location 10,18-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode30" name="Error" strict="true">
<!--The result of the attemp to add a product.-->
    <returnValues name="AddToBasketResult" type="com.intershop.component.basket.capi.AddToBasketResult"
        optional="true"/>
<!--The result of the gift card's ship\-to address creation in case it failed.-->
    <returnValues name="AddressCreationResult" type="com.intershop.component.address.capi.handler.AddressCreationResult"/>
  </nodes>
<!--Adds the given product to the basket.
@Location 0,11-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode2" strict="true" name="AddProduct"
      callMode="Private">
    <nodeSuccessors name="next" next="ExtensionPointNode2"/>
<!--The basket the product has to be added to.-->
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
<!--The product to add.-->
    <parameters name="Product" type="com.intershop.component.product.capi.ProductBO"/>
<!--The requested quantity of the product to be added.-->
    <parameters name="Quantity" type="com.intershop.beehive.foundation.quantity.Quantity"/>
<!--The merge group specifier.-->
    <parameters name="MergeGroup" type="java.lang.Integer" optional="true"/>
<!--If true a new line item should be created in every case, even if an line item for the specified product exists.-->
    <parameters name="ForceSeparateLineItem" type="java.lang.Boolean" optional="true"/>
<!--Map of additional parameters for the handler processing the request.-->
    <parameters name="AdditionalParameters" type="java.util.Map&lt;java.lang.String,java.lang.String>"
        optional="true"/>
    <parameters name="FixedSingleBasePrice" type="com.intershop.beehive.foundation.quantity.Money"
        optional="true"/>
<!--Map of dependent products to be added later in the process in case the product was added successfully. Here it is used to define the guideline fro the PLI creation.-->
    <parameters name="DependentSKUMap" type="java.util.Map&lt;java.lang.String, java.lang.String>"
        optional="true"/>
<!--Flag for calculating the basket after adding the product, but before triggering the extension point "AddedProductToBasket". Defaults to "false".-->
    <parameters name="Calculate" type="java.lang.Boolean" optional="true"/>
  </nodes>
<!--@Location 0,12-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode2" name="AddProductToBasket"
      strict="true">
    <nodeSuccessors name="next" next="AddProduct1" action="begin"/>
<!--@BendPoints 3,25-->
    <nodeSuccessors name="pipelet_error" next="JoinNode17"/>
<!--The basket the product has to be added to.-->
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
<!--The product to add.-->
    <parameters name="Product" type="com.intershop.component.product.capi.ProductBO"/>
<!--The requested quantity of the product to be added.-->
    <parameters name="Quantity" type="com.intershop.beehive.foundation.quantity.Quantity"/>
<!--The merge group specifier.-->
    <parameters name="MergeGroup" type="java.lang.Integer" optional="true"/>
<!--If true a new line item should be created in every case, even if an line item for the specified product exists.-->
    <parameters name="ForceSeparateLineItem" type="java.lang.Boolean" optional="true"/>
<!--Map of additional parameters for the handler processing the request.-->
    <parameters name="AdditionalParameters" type="java.util.Map&lt;java.lang.String,java.lang.String>"
        optional="true"/>
<!--Map of dependent products to be added later in the process in case the product was added successfully. Here it is used to define the guideline fro the PLI creation.-->
    <parameters name="DependentSKUMap" type="java.util.Map&lt;java.lang.String, java.lang.String>"
        optional="true"/>
  </nodes>
<!--@Location 0,13-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddProduct1">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/AddProduct.xml"/>
    <nodeSuccessors name="next" next="CallNode2"/>
  </nodes>
<!--@Location 0,14-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode2">
    <nodeSuccessors name="next" next="DecisionNode_QaMc4P3vEeiXoZxR159wcw"/>
    <parameterBindings name="Basket" nullBinding="true"/>
    <parameterBindings name="BasketBO" objectPath="Basket"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 0,15-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode_QaMc4P3vEeiXoZxR159wcw"
      conditionKey="Calculate">
    <nodeSuccessors name="decision_yes" next="DecisionNode_QaKnsP3vEeiXoZxR159wcw"/>
<!--@BendPoints \-1,31-->
    <nodeSuccessors name="decision_no" next="JoinNode_QaIygP3vEeiXoZxR159wcw"/>
  </nodes>
<!--@Location 0,16-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode_QaKnsP3vEeiXoZxR159wcw"
      conditionKey="Calculate" operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="CallNode_QaGWQP3vEeiXoZxR159wcw"/>
    <nodeSuccessors name="decision_no" next="JoinNode_QaIygP3vEeiXoZxR159wcw"/>
  </nodes>
<!--@Location 0,17-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode_QaGWQP3vEeiXoZxR159wcw">
    <nodeSuccessors name="next" next="JoinNode_QaEhEP3vEeiXoZxR159wcw"/>
    <startNode referencedName="This:Calculate"/>
  </nodes>
<!--@Location \-1,17-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode_QaEhEP3vEeiXoZxR159wcw">
<!--@BendPoints \-1,37-->
    <nodeSuccessors name="next" next="ExtensionPointNode4"/>
  </nodes>
<!--@Location 0,18-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode4" name="AddedProductToBasket"
      strict="true">
    <nodeSuccessors name="next" next="EndNode2" action="commit"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode17" action="rollback"/>
<!--The basket the product has to be added to.-->
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
<!--The product to add.-->
    <parameters name="Product" type="com.intershop.beehive.xcs.internal.product.ProductPO"/>
<!--The requested quantity of the product to be added.-->
    <parameters name="Quantity" type="com.intershop.beehive.foundation.quantity.Quantity"/>
<!--The merge group specifier.-->
    <parameters name="MergeGroup" type="java.lang.Integer" optional="true"/>
<!--If true a new line item should be created in every case, even if an line item for the specified product exists.-->
    <parameters name="ForceSeparateLineItem" type="java.lang.Boolean" optional="true"/>
<!--Map of additional parameters for the handler processing the request.-->
    <parameters name="AdditionalParameters" type="java.util.Map&lt;java.lang.String,java.lang.String>"
        optional="true"/>
<!--The result of the attemp to add a product.-->
    <parameters name="AddToBasketResult" type="com.intershop.component.basket.capi.AddToBasketResult"/>
<!--Map of dependent products to be added later in the process in case the product was added successfully. Here it is used to define the guideline fro the PLI creation.-->
    <parameters name="DependentSKUMap" type="java.util.Map&lt;java.lang.String, java.lang.String>"
        optional="true"/>
    <parameterBindings name="NewProductLineItem" objectPath="AddToBasketResult:CreatedProductLineItem"/>
  </nodes>
<!--@Location 0,19-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode2" strict="true">
<!--@Deprecated
The result of the attempt to add a product.-->
    <returnValues name="AddToBasketResult" type="com.intershop.component.basket.capi.AddToBasketResult"/>
<!--The result of the attempt to add a product.-->
    <returnValues name="AddToBasketResults" type="com.intershop.component.basket.capi.AddToBasketResults"/>
  </nodes>
<!--@Location 1,18-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode17">
    <nodeSuccessors name="next" next="EndNode26"/>
  </nodes>
<!--@Location 1,19-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode26" name="Error" strict="true">
<!--The result of the attemp to add a product.-->
    <returnValues name="AddToBasketResult" type="com.intershop.component.basket.capi.AddToBasketResult"/>
  </nodes>
<!--@Location \-1,16-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode_QaIygP3vEeiXoZxR159wcw">
    <nodeSuccessors name="next" next="JoinNode_QaEhEP3vEeiXoZxR159wcw"/>
  </nodes>
<!--Adds the given products to the basket.
@Location 30,11-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode27" strict="true" name="AddProducts"
      callMode="Private">
    <nodeSuccessors name="next" next="ExtensionPointNode28"/>
<!--The basket the product has to be added to.-->
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
    <parameters name="AddToBasketRecords" type="com.intershop.component.basket.capi.AddToBasketRecords"/>
<!--Flag for calculating the basket after adding the products, but before triggering the extension point "AddedProductsToBasket". Defaults to "false".-->
    <parameters name="Calculate" type="java.lang.Boolean" optional="true"/>
  </nodes>
<!--@Location 30,12-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode28" name="AddProductsToBasket"
      strict="true">
    <nodeSuccessors name="next" next="AddProducts0" action="begin"/>
<!--@BendPoints 63,25-->
    <nodeSuccessors name="pipelet_error" next="JoinNode7"/>
<!--The basket the product has to be added to.-->
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
    <parameters name="AddToBasketRecords" type="com.intershop.component.basket.capi.AddToBasketRecords"/>
  </nodes>
<!--@Location 30,13-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddProducts0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/AddProducts.xml"/>
    <nodeSuccessors name="next" next="CallNode19"/>
  </nodes>
<!--@Location 30,14-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode19">
    <nodeSuccessors name="next" next="DecisionNode_pk5nQP3uEeiXoZxR159wcw"/>
    <parameterBindings name="Basket" nullBinding="true"/>
    <parameterBindings name="BasketBO" objectPath="Basket"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 30,15-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode_pk5nQP3uEeiXoZxR159wcw"
      conditionKey="Calculate">
    <nodeSuccessors name="decision_yes" next="DecisionNode_sYyrMP3uEeiXoZxR159wcw"/>
<!--@BendPoints 59,31-->
    <nodeSuccessors name="decision_no" next="JoinNode_-NSnkP3uEeiXoZxR159wcw"/>
  </nodes>
<!--@Location 30,16-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode_sYyrMP3uEeiXoZxR159wcw"
      conditionKey="Calculate" operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="CallNode_4jsh0P3uEeiXoZxR159wcw"/>
    <nodeSuccessors name="decision_no" next="JoinNode_-NSnkP3uEeiXoZxR159wcw"/>
  </nodes>
<!--@Location 30,17-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode_4jsh0P3uEeiXoZxR159wcw">
    <nodeSuccessors name="next" next="JoinNode_8gsi4P3uEeiXoZxR159wcw"/>
    <startNode referencedName="This:Calculate"/>
  </nodes>
<!--@Location 30,18-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode_8gsi4P3uEeiXoZxR159wcw">
    <nodeSuccessors name="next" next="ExtensionPointNode27"/>
  </nodes>
<!--@Location 30,19-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode27" name="AddedProductsToBasket"
      strict="true">
    <nodeSuccessors name="next" next="EndNode48" action="commit"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode7" action="rollback"/>
<!--The basket the product has to be added to.-->
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
    <parameters name="AddToBasketRecords" type="com.intershop.component.basket.capi.AddToBasketRecords"/>
<!--results of the add to basket actions-->
    <parameters name="AddToBasketResults" type="com.intershop.component.basket.capi.AddToBasketResults"/>
  </nodes>
<!--@Location 30,20-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode48" strict="true">
    <returnValues name="AddToBasketResults" type="com.intershop.component.basket.capi.AddToBasketResults"/>
  </nodes>
<!--@Location 31,19-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode7">
    <nodeSuccessors name="next" next="EndNode49"/>
  </nodes>
<!--@Location 31,20-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode49" name="Error" strict="true">
    <returnValues name="AddToBasketResults" type="com.intershop.component.basket.capi.AddToBasketResults"
        optional="true"/>
    <returnValues name="ERROR_Basket_Product" type="java.lang.Boolean" optional="true"/>
    <returnValues name="ErrorCode" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 29,16-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode_-NSnkP3uEeiXoZxR159wcw">
<!--@BendPoints 59,37-->
    <nodeSuccessors name="next" next="JoinNode_8gsi4P3uEeiXoZxR159wcw"/>
  </nodes>
<!--Adds a warranty to the given product line item.
@Location 13,11-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode6" strict="true" name="AddWarranty"
      callMode="Private">
    <nodeSuccessors name="next" next="ExtensionPointNode8"/>
<!--The warranty to add.-->
    <parameters name="Warranty" type="com.intershop.component.warranty.capi.WarrantyBO"/>
<!--The product line item the warranty has to be assigned to.-->
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
  </nodes>
<!--@Location 13,12-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode8" name="AddWarrantyToLineItem"
      strict="true">
    <nodeSuccessors name="next" next="AddWarrantyToPLI0" action="begin"/>
<!--@BendPoints 29,25-->
    <nodeSuccessors name="pipelet_error" next="JoinNode12"/>
<!--The warranty to add.-->
    <parameters name="Warranty" type="com.intershop.component.warranty.capi.WarrantyBO"/>
<!--The product line item the warranty has to be assigned to.-->
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
  </nodes>
<!--@Location 13,13-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddWarrantyToPLI0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/AddWarranty.xml"/>
    <nodeSuccessors name="next" next="CallNode12"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode12" action="rollback"/>
  </nodes>
<!--@Location 13,14-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode12">
    <nodeSuccessors name="next" next="ExtensionPointNode7"/>
    <parameterBindings name="Basket" nullBinding="true"/>
    <parameterBindings name="BasketBO" objectPath="ProductLineItem:BasketBO"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 13,15-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode7" name="AddedWarrantyToLineItem"
      strict="true">
    <nodeSuccessors name="next" next="EndNode8" action="commit"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode13" action="rollback"/>
<!--The just added warranty.-->
    <parameters name="Warranty" type="com.intershop.component.warranty.capi.WarrantyBO"/>
<!--The product line item, to which the warranty was added.-->
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
  </nodes>
<!--@Location 13,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode8" strict="true"/>
<!--@Location 14,15-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode13">
    <nodeSuccessors name="next" next="EndNode9"/>
  </nodes>
<!--@Location 14,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode9" name="ERROR" strict="true">
<!--Information about the reason, why the warranty could not be added.-->
    <returnValues name="ERROR_Warranty" type="java.lang.String"/>
  </nodes>
<!--@Location 14,13-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode12">
    <nodeSuccessors name="next" next="JoinNode13"/>
  </nodes>
<!--Gets the adjusted quantities 
according to the given inventory status.
@Location 2,21-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode1" strict="true" name="AdjustBasketByInventoryStatus"
      callMode="Private">
    <nodeSuccessors name="next" next="ExtensionPointNode29"/>
<!--The basket object to update.-->
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
<!--The repository for managing the product business objects.-->
    <parameters name="ProductBORepository" type="com.intershop.component.product.capi.ProductBORepository"/>
<!--Map containing the InventoryStatus per item. The key of an etry is the ProductRef.-->
    <parameters name="InventoryStatusMap" type="java.util.Map&lt;java.lang.String,com.intershop.beehive.xcs.capi.inventory.InventoryStatus>"/>
  </nodes>
<!--@Location 2,22-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode29" name="AdjustBasketByInventoryStatus"
      strict="true">
    <nodeSuccessors name="next" next="GetInventoryStatusAdjustedQuantities0" action="begin"/>
<!--@BendPoints 7,45-->
    <nodeSuccessors name="pipelet_error" next="JoinNode10"/>
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
    <parameters name="ProductBORepository" type="com.intershop.component.product.capi.ProductBORepository"/>
    <parameters name="InventoryStatusMap" type="java.util.Map&lt;java.lang.String,com.intershop.beehive.xcs.capi.inventory.InventoryStatus>"/>
  </nodes>
<!--@Location 2,23-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetInventoryStatusAdjustedQuantities0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/AdjustBasketByInventoryStatus.xml"/>
    <nodeSuccessors name="next" next="DecisionNode_IlC5cB-4EemHqNhO6CMfdQ"/>
  </nodes>
<!--@Location 2,24-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode_IlC5cB-4EemHqNhO6CMfdQ"
      conditionKey="QuantityUpdated" operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="ExtensionPointNode30"/>
<!--@BendPoints 6,49 6,53-->
    <nodeSuccessors name="decision_no" next="JoinNode_Kfo94B-4EemHqNhO6CMfdQ"/>
  </nodes>
<!--@Location 2,25-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode30" name="AdjustedBasketByInventoryStatus"
      strict="true">
    <nodeSuccessors name="next" next="JoinNode_Kfo94B-4EemHqNhO6CMfdQ"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode10" action="rollback"/>
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
<!--A map containing the Quantities mapped to the line item IDs.-->
    <parameters name="Quantities" type="java.util.Map&lt;java.lang.String,java.math.BigDecimal>"/>
<!--An AdjustBasketResults object containing the reasons for changing basket. Each entry provides information about the change and their reason. If all products in the basket are fully available, the collection will be empty.-->
    <parameters name="AdjustBasketResults" type="com.intershop.component.basket.capi.AdjustBasketResults"/>
    <parameters name="RemoveFromBasketResults" type="com.intershop.component.basket.capi.RemoveFromBasketResults"/>
  </nodes>
<!--@Location 2,26-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode_Kfo94B-4EemHqNhO6CMfdQ">
    <nodeSuccessors name="next" next="EndNode7" action="begin"/>
  </nodes>
<!--@Location 2,27-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode7" strict="true">
<!--A map containing the Quantities mapped to the line item IDs.-->
    <returnValues name="Quantities" type="java.util.Map&lt;java.lang.String,java.math.BigDecimal>"/>
<!--An AdjustBasketResults object containing the reasons for changing basket. Each entry provides information about the change and their reason. If all products in the basket are fully available, the collection will be empty.-->
    <returnValues name="AdjustBasketResults" type="com.intershop.component.basket.capi.AdjustBasketResults"/>
<!--@deprecated since 7.7. use RemovedFromBasketResults instead
A collection containing the results of the attempts to remove the not available line items from the basket.-->
    <returnValues name="RemoveFromBasketResults" type="java.util.Collection&lt;com.intershop.component.basket.capi.RemoveFromBasketResult>"/>
<!--@deprecated since 7.7
use AdjustBasketResults instead-->
    <returnValues name="AdjustedItems" type="java.util.Collection&lt;com.intershop.component.basket.capi.AdjustBasketResult>"/>
    <returnValues name="RemovedFromBasketResults" type="com.intershop.component.basket.capi.RemoveFromBasketResults"/>
  </nodes>
<!--@Location 3,25-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode10">
    <nodeSuccessors name="next" next="EndNode47"/>
  </nodes>
<!--@Location 3,27-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode47" name="Error" strict="true"/>
<!--Removes all user related data 
from the specified basket.
@Location 20,2-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode24" strict="true" name="AnonymizeBasket"
      callMode="Private">
    <nodeSuccessors name="next" next="AnonymizeBasketBO0" action="begin"/>
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
  </nodes>
<!--@Location 20,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AnonymizeBasketBO0">
    <pipelet href="enfinity:/bc_basket/pipelets/AnonymizeBasketBO.xml"/>
    <nodeSuccessors name="next" next="EndNode42" action="commit"/>
    <parameterBindings name="BasketBO" objectPath="Basket"/>
  </nodes>
<!--@Location 20,4-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode42" strict="true"/>
<!--Applies an Promotion Code
to the specified basket.
Performs validation checks
before.
@Location 22,2-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode_4vWEQAmJEeeEzJllwLjtmw" strict="true"
      name="ApplyPromotionCode" callMode="Private">
    <nodeSuccessors name="next" next="TrimString_cF3rwPFfEee_jvgvzwNagQ"/>
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
    <parameters name="PromotionCode" type="java.lang.String"/>
  </nodes>
<!--@Location 22,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="TrimString_cF3rwPFfEee_jvgvzwNagQ">
    <pipelet href="enfinity:/core/pipelets/TrimString.xml"/>
    <nodeSuccessors name="next" next="ApplyPromotionCode_X_4SgAmLEeeEzJllwLjtmw" action="begin"/>
    <parameterBindings name="String" objectPath="promotionCode"/>
    <returnValueBindings name="TrimmedString" objectPath="promotionCode"/>
  </nodes>
<!--@Location 22,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ApplyPromotionCode_X_4SgAmLEeeEzJllwLjtmw">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/ApplyPromotionCode.xml"/>
    <nodeSuccessors name="next" next="CallNode_O1mwwAmKEeeEzJllwLjtmw"/>
<!--@BendPoints 47,9-->
    <nodeSuccessors name="pipelet_error" next="JoinNode_r-9QEAmLEeeEzJllwLjtmw"/>
  </nodes>
<!--@Location 22,5-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode_O1mwwAmKEeeEzJllwLjtmw">
    <nodeSuccessors name="next" next="ExtensionPointNode_kVrxkAmLEeeEzJllwLjtmw"/>
    <parameterBindings name="Basket" nullBinding="true"/>
    <parameterBindings name="BasketBO" objectPath="Basket"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 22,6-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode_kVrxkAmLEeeEzJllwLjtmw"
      name="AppliedPromotionCode" strict="true">
    <nodeSuccessors name="next" next="EndNode_hyn-8AmLEeeEzJllwLjtmw" action="commit"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode_r-9QEAmLEeeEzJllwLjtmw"/>
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
    <parameters name="PromotionCode" type="java.lang.String"/>
    <parameters name="PromotionCodeBO" type="com.intershop.component.promotion.capi.PromotionCodeBO"
        optional="true"/>
  </nodes>
<!--@Location 22,9-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode_hyn-8AmLEeeEzJllwLjtmw" strict="true">
    <returnValues name="PromotionCodeBO" type="com.intershop.component.promotion.capi.PromotionCodeBO"/>
  </nodes>
<!--@Location 23,6-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode_r-9QEAmLEeeEzJllwLjtmw">
    <nodeSuccessors name="next" next="EndNode_hyk7oAmLEeeEzJllwLjtmw" action="rollback"/>
  </nodes>
<!--@Location 23,9-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode_hyk7oAmLEeeEzJllwLjtmw" name="Error"
      strict="true">
    <returnValues name="PromotionCodeError" type="java.lang.String"/>
  </nodes>
<!--Calculates the basket.
@Location 4,21-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode8" strict="true" name="Calculate"
      callMode="Private">
    <nodeSuccessors name="next" next="GetApplicationBO0"/>
<!--The basket object to (re\-)calculate.-->
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
  </nodes>
<!--@Location 4,22-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetApplicationBO0">
    <pipelet href="enfinity:/bc_application/pipelets/GetApplicationBO.xml"/>
    <nodeSuccessors name="next" next="CallNode4"/>
    <returnValueBindings name="ApplicationBO" objectPath="Application"/>
  </nodes>
<!--@Location 4,23-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode4">
    <nodeSuccessors name="next" next="EndNode11"/>
    <startNode referencedName="ProcessBasketCalculation-Calculate"/>
  </nodes>
<!--@Location 4,24-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode11" strict="true"/>
<!--Checks the max value of basket.
@Location 6,21-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode28" strict="true" name="CheckBasketMaxValue"
      callMode="Private">
    <nodeSuccessors name="next" next="CheckBasketMaxTotalValue0"/>
<!--The basket object to check the max order value.-->
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
    <parameters name="BasketMaxTotalValue" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 6,22-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CheckBasketMaxTotalValue0">
    <pipelet href="enfinity:/bc_basket/pipelets/CheckBasketMaxTotalValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode11"/>
<!--@BendPoints 14,45 14,47-->
    <nodeSuccessors name="pipelet_error" next="JoinNode11"/>
  </nodes>
<!--@Location 6,23-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode11">
    <nodeSuccessors name="next" next="EndNode50"/>
  </nodes>
<!--@Location 6,24-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode50" strict="true">
    <returnValues name="BasketMaxTotalPrefCurrencyValue" type="com.intershop.beehive.foundation.quantity.Money"
        optional="true"/>
    <returnValues name="BasketTotalAmoutDifference" type="com.intershop.beehive.foundation.quantity.Money"
        optional="true"/>
    <returnValues name="ERROR_Basket" type="java.lang.String" optional="true"/>
  </nodes>
<!--Checks the inventory status 
of the items in the basket.
@Location 0,21-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode10" strict="true" name="CheckInventory"
      callMode="Private">
    <nodeSuccessors name="next" next="CheckBasketInventory0"/>
<!--The basket object to check the inventory for.-->
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
<!--@deprecated 
The preference domain-->
    <parameters name="PreferenceDomain" type="com.intershop.beehive.core.capi.domain.Domain"/>
  </nodes>
<!--@Location 0,22-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CheckBasketInventory0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/CheckBasketInventory.xml"/>
    <nodeSuccessors name="next" next="EndNode13"/>
  </nodes>
<!--@Location 0,23-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode13" strict="true">
<!--Flag indicationg, that all items are in stock.-->
    <returnValues name="AllInStock" type="java.lang.Boolean"/>
<!--Information about the inventory status per product.-->
    <returnValues name="InventoryStatusMap" type="java.util.Map&lt;java.lang.String,com.intershop.beehive.xcs.capi.inventory.InventoryStatus>"/>
  </nodes>
<!--Creates a new basket in the specified repository.
If the user is given, she/he becomes the owner of
the new basket.
@Location 0,2-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode5" strict="true" name="CreateBasket"
      callMode="Private">
    <nodeSuccessors name="next" next="ExtensionPointNode0"/>
<!--User to become owner of the basket. Not set for anonymous user.-->
    <parameters name="User" type="com.intershop.component.user.capi.UserBO" optional="true"/>
<!--Repository which manages the baskets.-->
    <parameters name="BasketBORepository" type="com.intershop.component.basket.capi.BasketBORepository"/>
  </nodes>
<!--Called before a new basket is created. 
If a user is given, he will become the owner 
of the basket, when it is created.
@Location 0,3-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode0" name="CreateBasket"
      strict="true">
    <nodeSuccessors name="next" next="CreateBasket0" action="begin"/>
<!--@BendPoints 3,7-->
    <nodeSuccessors name="pipelet_error" next="JoinNode15"/>
<!--Repository which manages the baskets.-->
    <parameters name="BasketBORepository" type="com.intershop.component.basket.capi.BasketBORepository"/>
<!--User to become owner of the basket. Not set for anonymous user.-->
    <parameters name="User" type="com.intershop.component.user.capi.UserBO" optional="true"/>
  </nodes>
<!--@Location 0,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateBasket0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/CreateBasket.xml"/>
    <nodeSuccessors name="next" next="ExtensionPointNode1"/>
  </nodes>
<!--Called after a new basket was created. 
If a user is given, he became the owner 
of the new basket.
@Location 0,5-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode1" name="CreatedBasket"
      strict="true">
    <nodeSuccessors name="next" next="EndNode0" action="commit"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode15" action="rollback"/>
<!--Repository which manages the baskets.-->
    <parameters name="BasketBORepository" type="com.intershop.component.basket.capi.BasketBORepository"/>
<!--User to become owner of the basket. Not set for anonymous user.-->
    <parameters name="User" type="com.intershop.component.user.capi.UserBO" optional="true"/>
<!--The new created basket.-->
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
  </nodes>
<!--@Location 0,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode0" strict="true">
<!--The new created basket.-->
    <returnValues name="Basket" type="com.intershop.component.basket.capi.BasketBO"
        optional="true"/>
  </nodes>
<!--@Location 1,5-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode15">
    <nodeSuccessors name="next" next="EndNode24"/>
  </nodes>
<!--@Location 1,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode24" name="Error" strict="true">
<!--The new created basket.-->
    <returnValues name="Basket" type="com.intershop.component.basket.capi.BasketBO"
        optional="true"/>
  </nodes>
<!--Gets the basket with the given ID if it is contained 
in the the specified basket repository.
@Location 4,2-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode4" strict="true" name="GetBasketByID"
      callMode="Private">
    <nodeSuccessors name="next" next="GetBasketByID0"/>
<!--The ID of the basket to retrieve from the repository.-->
    <parameters name="BasketID" type="java.lang.String"/>
<!--Repository which manages the baskets.-->
    <parameters name="BasketBORepository" type="com.intershop.component.basket.capi.BasketBORepository"/>
  </nodes>
<!--@Location 4,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetBasketByID0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/GetBasketByID.xml"/>
    <nodeSuccessors name="next" next="EndNode4"/>
<!--@BendPoints 11,7-->
    <nodeSuccessors name="pipelet_error" next="EndNode6"/>
  </nodes>
<!--@Location 4,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode4" strict="true">
<!--The retrieved basket business object for the user.-->
    <returnValues name="Basket" type="com.intershop.component.basket.capi.BasketBO"
        optional="true"/>
  </nodes>
<!--@Location 5,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode6" name="NoBasketFound" strict="true"/>
<!--Gets all active baskets for the given user contained 
in the specified basket repository.
@Location 2,2-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode3" strict="true" name="GetBasketsByUser"
      callMode="Private">
    <nodeSuccessors name="next" next="GetBasketsByUser0"/>
<!--The user who is owner of the basket.-->
    <parameters name="User" type="com.intershop.component.user.capi.UserBO"/>
<!--Repository which manages the baskets.-->
    <parameters name="BasketBORepository" type="com.intershop.component.basket.capi.BasketBORepository"/>
  </nodes>
<!--@Location 2,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetBasketsByUser0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/GetBasketsByUser.xml"/>
    <nodeSuccessors name="next" next="EndNode3"/>
<!--@BendPoints 7,7-->
    <nodeSuccessors name="pipelet_error" next="EndNode5"/>
  </nodes>
<!--@Location 2,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode3" strict="true">
<!--Collection of retrieved basket business objects for the user.-->
    <returnValues name="Baskets" type="java.util.Collection&lt;com.intershop.component.basket.capi.BasketBO>"/>
  </nodes>
<!--@Location 3,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode5" name="NoBasketsFound" strict="true">
<!--An empty Collection.-->
    <returnValues name="Baskets" type="java.util.Collection&lt;com.intershop.component.basket.capi.BasketBO>"/>
  </nodes>
<!--@Location 10,2-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode18" strict="true" name="MergeBaskets"
      callMode="Private">
    <nodeSuccessors name="next" next="MergeBaskets0" action="begin"/>
    <parameters name="BasketBORepository" type="com.intershop.component.basket.capi.BasketBORepository"/>
    <parameters name="MergeSourceBasket" type="com.intershop.component.basket.capi.BasketBO"/>
    <parameters name="MergeTargetBasket" type="com.intershop.component.basket.capi.BasketBO"/>
    <parameters name="AdditionalParameters" type="java.util.Map&lt;java.lang.String,java.lang.String>"
        optional="true"/>
<!--If set the basket is deleted after successful merge. The flag has priority to 'MoveSourceBasketToBasketHistory'-->
    <parameters name="DeleteSourceBasket" type="java.lang.Boolean" optional="true"/>
<!--If set the basket is historized.-->
    <parameters name="MoveSourceBasketToBasketHistory" type="java.lang.Boolean" optional="true"/>
  </nodes>
<!--@Location 10,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="MergeBaskets0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/MergeBaskets.xml"/>
    <nodeSuccessors name="next" next="CallNode15"/>
  </nodes>
<!--@Location 10,4-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode15">
    <nodeSuccessors name="next" next="DecisionNode3" action="commit"/>
    <parameterBindings name="Basket" nullBinding="true"/>
    <parameterBindings name="BasketBO" objectPath="MergeTargetBasket"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 10,5-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode3" conditionKey="MergeBasketResult:Failure"
      operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="JoinNode4"/>
    <nodeSuccessors name="decision_no" next="DecisionNode4"/>
  </nodes>
<!--@Location 10,6-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode4">
    <nodeSuccessors name="next" next="EndNode32"/>
  </nodes>
<!--@Location 10,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode32" name="Error" strict="true">
    <returnValues name="MergeBasketResult" type="com.intershop.component.basket.capi.MergeBasketResult"/>
  </nodes>
<!--@Location 11,5-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode4" conditionKey="DeleteSourceBasket"
      operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="CallNode5"/>
    <nodeSuccessors name="decision_no" next="DecisionNode5"/>
  </nodes>
<!--@Location 11,6-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode5">
<!--@BendPoints 23,15-->
    <nodeSuccessors name="next" next="JoinNode3"/>
    <nodeSuccessors name="Error" next="JoinNode4"/>
    <parameterBindings name="Basket" objectPath="MergeSourceBasket"/>
    <startNode referencedName="ProcessBasket-RemoveBasket"/>
  </nodes>
<!--@Location 12,7-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode3">
    <nodeSuccessors name="next" next="EndNode22"/>
  </nodes>
<!--@Location 12,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode22" strict="true">
    <returnValues name="MergeBasketResult" type="com.intershop.component.basket.capi.MergeBasketResult"/>
  </nodes>
<!--@Location 12,5-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode5" conditionKey="MoveSourceBasketToBasketHistory"
      operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="CallNode6"/>
<!--@BendPoints 27,11 27,15-->
    <nodeSuccessors name="decision_no" next="JoinNode3"/>
  </nodes>
<!--@Location 12,6-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode6">
    <nodeSuccessors name="next" next="JoinNode3"/>
    <parameterBindings name="Basket" objectPath="MergeSourceBasket"/>
    <startNode referencedName="ProcessBasket-MoveBasketToBasketHistory"/>
  </nodes>
<!--Moves the given basket to the basket history 
by changing basket's status
@Location 8,2-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode17" strict="true" name="MoveBasketToBasketHistory"
      callMode="Private">
    <nodeSuccessors name="next" next="MoveBasketToBasketHistory1" action="begin"/>
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
    <parameters name="BasketBORepository" type="com.intershop.component.basket.capi.BasketBORepository"/>
  </nodes>
<!--@Location 8,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="MoveBasketToBasketHistory1">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/MoveBasketToBasketHistory.xml"/>
    <nodeSuccessors name="next" next="EndNode21" action="commit"/>
    <parameterBindings name="Status" constant="(Integer)4"/>
  </nodes>
<!--@Location 8,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode21" strict="true"/>
<!--Removes the given basket from 
the specified basket repository.
@Location 6,2-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode15" strict="true" name="RemoveBasket"
      callMode="Private">
    <nodeSuccessors name="next" next="ExtensionPointNode12"/>
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
    <parameters name="BasketBORepository" type="com.intershop.component.basket.capi.BasketBORepository"/>
  </nodes>
<!--@Location 6,3-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode12" name="RemoveBasket"
      strict="true">
    <nodeSuccessors name="next" next="MoveBasketToBasketHistory0" action="begin"/>
<!--@BendPoints 15,7-->
    <nodeSuccessors name="pipelet_error" next="JoinNode16"/>
<!--The basket to be removed.-->
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
<!--The repository for managing baskets.-->
    <parameters name="BasketBORepository" type="com.intershop.component.basket.capi.BasketBORepository"/>
  </nodes>
<!--@Location 6,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="MoveBasketToBasketHistory0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/MoveBasketToBasketHistory.xml"/>
    <nodeSuccessors name="next" next="ExtensionPointNode13"/>
    <parameterBindings name="Status" constant="(Integer)2"/>
  </nodes>
<!--@Location 6,5-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode13" name="RemovedBasket"
      strict="true">
    <nodeSuccessors name="next" next="EndNode20" action="commit"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode16" action="rollback"/>
<!--The removed basket.-->
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"
        optional="true"/>
<!--The repository for managing baskets.-->
    <parameters name="BasketBORepository" type="com.intershop.component.basket.capi.BasketBORepository"/>
  </nodes>
<!--@Location 6,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode20" strict="true"/>
<!--@Location 7,5-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode16">
    <nodeSuccessors name="next" next="EndNode25"/>
  </nodes>
<!--@Location 7,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode25" name="Error" strict="true"/>
<!--Removes the specified product 
line item from the basket.
@Location 4,11-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode7" strict="true" name="RemoveLineItem"
      callMode="Private">
    <nodeSuccessors name="next" next="ExtensionPointNode5"/>
<!--The product line item to remove.-->
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
  </nodes>
<!--@Location 4,12-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode5" name="RemoveLineItemFromBasket"
      strict="true">
    <nodeSuccessors name="next" next="RemoveLineItemFromBasket0" action="begin"/>
<!--@BendPoints 11,25-->
    <nodeSuccessors name="pipelet_error" next="JoinNode19"/>
<!--The product line item to remove.-->
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
  </nodes>
<!--@Location 4,13-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemoveLineItemFromBasket0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/RemoveLineItem.xml"/>
    <nodeSuccessors name="next" next="CallNode9"/>
  </nodes>
<!--@Location 4,14-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode9">
    <nodeSuccessors name="next" next="ExtensionPointNode9"/>
    <parameterBindings name="Basket" nullBinding="true"/>
    <parameterBindings name="BasketBO" objectPath="ProductLineItem:BasketBO"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 4,15-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode9" name="RemovedLineItemFromBasket"
      strict="true">
    <nodeSuccessors name="next" next="EndNode10" action="commit"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode19" action="rollback"/>
<!--@deprecated since 7.7. use data in RemoveFromBasketResults instead
The removed product line item.-->
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"
        optional="true"/>
    <parameters name="RemoveFromBasketResults" type="com.intershop.component.basket.capi.RemoveFromBasketResults"/>
  </nodes>
<!--@Location 4,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode10" strict="true">
<!--@deprecated since 7.7 use RemoveFromBasketResults instead
The result of the attempt to remove a line item.-->
    <returnValues name="RemoveFromBasketResult" type="com.intershop.component.basket.capi.RemoveFromBasketResult"/>
<!--The result of the attempt to remove a line item.-->
    <returnValues name="RemoveFromBasketResults" type="com.intershop.component.basket.capi.RemoveFromBasketResults"/>
  </nodes>
<!--@Location 5,15-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode19">
    <nodeSuccessors name="next" next="EndNode28"/>
  </nodes>
<!--@Location 5,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode28" name="Error" strict="true">
<!--The result of the attempt to remove a line item.-->
    <returnValues name="RemoveFromBasketResult" type="com.intershop.component.basket.capi.RemoveFromBasketResult"/>
  </nodes>
<!--Removes all line items from the basket, 
which have no price.
Basket needs to be calculated before.
@Location 6,11-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode0" strict="true" visibility="Cartridge"
      name="RemoveLineItemsWithoutPrice" callMode="Private">
    <nodeSuccessors name="next" next="RemoveLineItemsWithoutPrice0"/>
<!--The basket to remove the items without price from.-->
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
  </nodes>
<!--@Location 6,12-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemoveLineItemsWithoutPrice0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/RemoveLineItemsWithoutPrice.xml"/>
    <nodeSuccessors name="next" next="EndNode1"/>
  </nodes>
<!--@Location 6,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode1" strict="true">
<!--A collection containing these line items which were removed, because they had no price after the calculation.-->
    <returnValues name="AdjustBasketResults" type="com.intershop.component.basket.capi.AdjustBasketResults"/>
<!--@deprecated since 7.7. use RemovedItemsFromBasketResults instead
A collection containing the results of the attempts to remove the line items without price from the basket.-->
    <returnValues name="RemoveFromBasketResults" type="java.util.Collection&lt;com.intershop.component.basket.capi.RemoveFromBasketResult>"/>
<!--@deprecated since 7.7
use AdjustBasketResults instead-->
    <returnValues name="AdjustedItems" type="java.util.Collection&lt;com.intershop.component.basket.capi.AdjustBasketResult>"/>
    <returnValues name="RemovedFromBasketResults" type="com.intershop.component.basket.capi.RemoveFromBasketResults"/>
  </nodes>
<!--Removes an Promotion Code
from the specified basket if it 
contains the promotion code.

@Location 24,2-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode_FfrhcBU2Eeed2uKH2iz1uQ" strict="true"
      name="RemovePromotionCode" callMode="Private">
    <nodeSuccessors name="next" next="RemovePromotionCode_PWencBU2Eeed2uKH2iz1uQ"
        action="begin"/>
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
    <parameters name="PromotionCode" type="java.lang.String"/>
  </nodes>
<!--@Location 24,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemovePromotionCode_PWencBU2Eeed2uKH2iz1uQ">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/RemovePromotionCode.xml"/>
    <nodeSuccessors name="next" next="CallNode_Ff3usBU2Eeed2uKH2iz1uQ"/>
  </nodes>
<!--@Location 24,4-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode_Ff3usBU2Eeed2uKH2iz1uQ">
    <nodeSuccessors name="next" next="ExtensionPointNode_Ff5j4BU2Eeed2uKH2iz1uQ"/>
    <parameterBindings name="Basket" nullBinding="true"/>
    <parameterBindings name="BasketBO" objectPath="Basket"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 24,5-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode_Ff5j4BU2Eeed2uKH2iz1uQ"
      name="RemovedPromotionCode" strict="true">
    <nodeSuccessors name="next" next="EndNode_FfxoEBU2Eeed2uKH2iz1uQ" action="commit"/>
<!--@BendPoints 51,11-->
    <nodeSuccessors name="pipelet_error" next="EndNode_Ff7ZEBU2Eeed2uKH2iz1uQ" action="rollback"/>
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
    <parameters name="PromotionCode" type="java.lang.String"/>
  </nodes>
<!--@Location 24,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode_FfxoEBU2Eeed2uKH2iz1uQ" strict="true"/>
<!--@Location 25,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode_Ff7ZEBU2Eeed2uKH2iz1uQ" name="Error"
      strict="true">
    <returnValues name="PromotionCodeError" type="java.lang.String"/>
  </nodes>
<!--Removes the warranties without price from the basket.
@Location 19,11-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode14" strict="true" name="RemoveWarrantiesWithoutPrice"
      callMode="Private">
    <nodeSuccessors name="next" next="LoopNode0"/>
<!--The basket to remove the warranties without price from.-->
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
  </nodes>
<!--@Location 19,12-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode0" loop="Basket:ProductLineItemBOs">
<!--@BendPoints 43,25-->
    <nodeSuccessors name="next" next="EndNode17"/>
    <entry key="PLI">
      <nodeSuccessors name="loop_entry_next" next="DecisionNode1"/>
    </entry>
  </nodes>
<!--@Location 19,13-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode1" conditionKey="PLI:Extension(&quot;Warranty&quot;):hasWarranty"
      operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="DecisionNode0"/>
<!--@BendPoints 41,27-->
    <nodeSuccessors name="decision_no" next="JoinNode1"/>
  </nodes>
<!--@Location 19,14-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode0" conditionKey="PLI:Extension(&quot;Warranty&quot;):BasketWarrantyLineItem:Price:Available"
      operator="str_eq" conditionValue="false">
    <nodeSuccessors name="decision_yes" next="RemoveWarranty0"/>
    <nodeSuccessors name="decision_no" next="JoinNode1"/>
  </nodes>
<!--@Location 19,15-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemoveWarranty0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/RemoveWarranty.xml"/>
    <nodeSuccessors name="next" next="JoinNode2"/>
    <parameterBindings name="ProductLineItem" objectPath="PLI"/>
  </nodes>
<!--@Location 19,16-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode2">
<!--@BendPoints 38,33 38,25-->
    <nodeSuccessors name="next" next="LoopNode0_Entry"/>
  </nodes>
<!--@Location 20,14-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode1">
<!--@BendPoints 41,33-->
    <nodeSuccessors name="next" next="JoinNode2"/>
  </nodes>
<!--@Location 21,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode17" strict="true"/>
<!--Removes the warranty from the given product line item.
@Location 15,11-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode11" strict="true" name="RemoveWarranty"
      callMode="Private">
    <nodeSuccessors name="next" next="ExtensionPointNode3"/>
<!--The product line item, from which the warranty has to be removed.-->
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
  </nodes>
<!--@Location 15,12-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode3" name="RemoveWarrantyFromLineItem"
      strict="true">
    <nodeSuccessors name="next" next="RemoveWarrantyFromLineItem0" action="begin"/>
<!--@BendPoints 33,25-->
    <nodeSuccessors name="pipelet_error" next="JoinNode22"/>
<!--The product line item, from which the warranty has to be removed.-->
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
  </nodes>
<!--@Location 15,13-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemoveWarrantyFromLineItem0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/RemoveWarranty.xml"/>
    <nodeSuccessors name="next" next="CallNode13"/>
  </nodes>
<!--@Location 15,14-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode13">
    <nodeSuccessors name="next" next="ExtensionPointNode6"/>
    <parameterBindings name="Basket" nullBinding="true"/>
    <parameterBindings name="BasketBO" objectPath="ProductLineItem:BasketBO"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 15,15-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode6" name="RemovedWarrantyFromLineItem"
      strict="true">
    <nodeSuccessors name="next" next="EndNode14" action="commit"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode22" action="rollback"/>
<!--The product line item from which the warranty was removed.-->
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
  </nodes>
<!--@Location 15,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode14" strict="true"/>
<!--@Location 16,15-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode22">
    <nodeSuccessors name="next" next="EndNode31"/>
  </nodes>
<!--@Location 16,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode31" name="Error" strict="true"/>
<!--Sets the common ship\-to address, valid for all line 
items of the specified basket. Ship\-to address is set:
\- at the entire basket, in case of no support for multiple shipments
\- at all line items contained in the basket, in case of multiple shipments
   are supported
@Location 16,2-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode20" strict="true" name="SetCommonShipToAddress"
      callMode="Private">
    <nodeSuccessors name="next" next="SetCommonShipToAddress0" action="begin"/>
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
    <parameters name="ShipToAddress" type="com.intershop.component.address.capi.AddressBO"/>
  </nodes>
<!--@Location 16,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetCommonShipToAddress0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/SetCommonShipToAddress.xml"/>
    <nodeSuccessors name="next" next="CallNode7"/>
<!--@BendPoints 35,7-->
    <nodeSuccessors name="pipelet_error" next="JoinNode14"/>
  </nodes>
<!--@Location 16,4-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode7">
    <nodeSuccessors name="next" next="ExtensionPointNode19"/>
    <parameterBindings name="Basket" nullBinding="true"/>
    <parameterBindings name="BasketBO" objectPath="Basket"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 16,5-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode19" name="SetCommonShipToAddress"
      strict="true">
    <nodeSuccessors name="next" next="EndNode35" action="commit"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode14"/>
    <parameters name="ShipToAddress" type="com.intershop.component.address.capi.AddressBO"/>
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
  </nodes>
<!--@Location 16,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode35" strict="true"/>
<!--@Location 17,5-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode14">
    <nodeSuccessors name="next" next="EndNode36" action="rollback"/>
  </nodes>
<!--@Location 17,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode36" name="Error" strict="true"/>
<!--Sets the given shipping method, valid for all line 
items of the specified basket. Shipping method is set:
\- at the entire basket, in case of no support for multiple shipments
\- at all line items contained in the basket, in case of multiple shipments
   are supported
@Location 18,2-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode25" strict="true" name="SetCommonShippingMethod"
      callMode="Private">
    <nodeSuccessors name="next" next="SetCommonShippingMethod0" action="begin"/>
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
    <parameters name="ShippingMethod" type="com.intershop.component.shipping_data.capi.shippingmethod.ShippingMethod"/>
  </nodes>
<!--@Location 18,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetCommonShippingMethod0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/SetCommonShippingMethod.xml"/>
    <nodeSuccessors name="next" next="CallNode17"/>
  </nodes>
<!--@Location 18,4-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode17">
    <nodeSuccessors name="next" next="ExtensionPointNode24"/>
    <parameterBindings name="Basket" nullBinding="true"/>
    <parameterBindings name="BasketBO" objectPath="Basket"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 18,5-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode24" name="SetCommonShippingMethod"
      strict="true">
    <nodeSuccessors name="next" next="EndNode43" action="commit"/>
<!--@BendPoints 39,11-->
    <nodeSuccessors name="pipelet_error" next="EndNode44" action="rollback"/>
    <parameters name="ShippingMethod" type="com.intershop.component.shipping_data.capi.shippingmethod.ShippingMethod"/>
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
  </nodes>
<!--@Location 18,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode43" strict="true"/>
<!--@Location 19,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode44" name="Error" strict="true"/>
<!--Sets the given invoice\-to address 
at the basket.
@Location 14,2-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode19" strict="true" name="SetInvoiceToAddress"
      callMode="Private">
    <nodeSuccessors name="next" next="SetInvoiceToAddress0" action="begin"/>
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
    <parameters name="InvoiceToAddress" type="com.intershop.component.address.capi.AddressBO"/>
  </nodes>
<!--@Location 14,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetInvoiceToAddress0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/SetInvoiceToAddress.xml"/>
    <nodeSuccessors name="next" next="CallNode3"/>
<!--@BendPoints 31,7-->
    <nodeSuccessors name="pipelet_error" next="JoinNode25"/>
  </nodes>
<!--@Location 14,4-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode3">
    <nodeSuccessors name="next" next="ExtensionPointNode18"/>
    <parameterBindings name="Basket" nullBinding="true"/>
    <parameterBindings name="BasketBO" objectPath="Basket"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 14,5-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode18" name="SetInvoiceToAddress"
      strict="true">
    <nodeSuccessors name="next" next="EndNode33" action="commit"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode25"/>
    <parameters name="Basket" type="com.intershop.component.basket.capi.BasketBO"/>
    <parameters name="InvoiceToAddress" type="com.intershop.component.address.capi.AddressBO"/>
  </nodes>
<!--@Location 14,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode33" strict="true"/>
<!--@Location 15,5-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode25">
    <nodeSuccessors name="next" next="EndNode34" action="rollback"/>
  </nodes>
<!--@Location 15,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode34" name="Error" strict="true"/>
<!--Sets the given ship\-to 
address at line item.
@Location 24,11-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode21" strict="true" name="SetShipToAddress"
      callMode="Private">
    <nodeSuccessors name="next" next="SetShipToAddress0" action="begin"/>
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
    <parameters name="ShipToAddress" type="com.intershop.component.address.capi.AddressBO"/>
  </nodes>
<!--@Location 24,12-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetShipToAddress0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/SetShipToAddress.xml"/>
    <nodeSuccessors name="next" next="CallNode14"/>
<!--@BendPoints 51,25-->
    <nodeSuccessors name="pipelet_error" next="JoinNode9"/>
  </nodes>
<!--@Location 24,13-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode14">
    <nodeSuccessors name="next" next="ExtensionPointNode20"/>
    <parameterBindings name="Basket" nullBinding="true"/>
    <parameterBindings name="BasketBO" objectPath="ProductLineItem:BasketBO"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 24,14-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode20" name="SetShipToAddress"
      strict="true">
    <nodeSuccessors name="next" next="EndNode38" action="commit"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode9"/>
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
    <parameters name="ShipToAddress" type="com.intershop.component.address.capi.AddressBO"/>
  </nodes>
<!--@Location 24,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode38" strict="true"/>
<!--@Location 25,14-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode9">
    <nodeSuccessors name="next" next="EndNode37" action="rollback"/>
  </nodes>
<!--@Location 25,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode37" name="Error" strict="true"/>
<!--Sets the givin shipping method 
at the specified line item.
@Location 22,11-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode23" strict="true" name="SetShippingMethod"
      callMode="Private">
    <nodeSuccessors name="next" next="SetShippingMethod0" action="begin"/>
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
    <parameters name="ShippingMethodPO" type="com.intershop.component.shipping_data.capi.shippingmethod.ShippingMethod"/>
  </nodes>
<!--@Location 22,12-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetShippingMethod0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/SetShippingMethod.xml"/>
    <nodeSuccessors name="next" next="CallNode16"/>
  </nodes>
<!--@Location 22,13-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode16">
    <nodeSuccessors name="next" next="ExtensionPointNode23"/>
    <parameterBindings name="Basket" nullBinding="true"/>
    <parameterBindings name="BasketBO" objectPath="ProductLineItem:BasketBO"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 22,14-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode23" name="SetShippingMethod"
      strict="true">
    <nodeSuccessors name="next" next="EndNode23" action="commit"/>
<!--@BendPoints 47,29-->
    <nodeSuccessors name="pipelet_error" next="EndNode41" action="rollback"/>
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
    <parameters name="ShippingMethodPO" type="com.intershop.component.shipping.internal.ruleengineadapter.businessobject.ShippingMethod"/>
  </nodes>
<!--@Location 22,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode23" strict="true"/>
<!--@Location 23,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode41" name="Error" strict="true"/>
<!--Updates Gift Card/Online Gift Certificate 
related data at the specified line item.
@Location 11,11-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode22" strict="true" name="UpdateGiftCard"
      callMode="Private">
    <nodeSuccessors name="next" next="ExtensionPointNode21"/>
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
    <parameters name="GIFTCARD_RecipientName" type="java.lang.String" optional="true"/>
    <parameters name="GIFTCARD_SenderEmail" type="java.lang.String" optional="true"/>
    <parameters name="GIFTCARD_SenderName" type="java.lang.String" optional="true"/>
    <parameters name="GIFTCARD_RecipientEmail" type="java.lang.String" optional="true"/>
    <parameters name="GIFTCARD_GreetingMessage" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 11,12-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode21" name="UpdateGiftCard"
      strict="true">
    <nodeSuccessors name="next" next="UpdateGiftCard0" action="begin"/>
<!--@BendPoints 25,25-->
    <nodeSuccessors name="pipelet_error" next="JoinNode26"/>
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
    <parameters name="GIFTCARD_SenderEmail" type="java.lang.String" optional="true"/>
    <parameters name="GIFTCARD_SenderName" type="java.lang.String" optional="true"/>
    <parameters name="GIFTCARD_RecipientEmail" type="java.lang.String" optional="true"/>
    <parameters name="GIFTCARD_RecipientName" type="java.lang.String" optional="true"/>
    <parameters name="GIFTCARD_GreetingMessage" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 11,13-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateGiftCard0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/UpdateGiftCard.xml"/>
    <nodeSuccessors name="next" next="ExtensionPointNode22"/>
  </nodes>
<!--@Location 11,14-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode22" name="UpdatedGiftCard"
      strict="true">
    <nodeSuccessors name="next" next="EndNode39" action="commit"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode26" action="rollback"/>
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
    <parameters name="GIFTCARD_SenderEmail" type="java.lang.String" optional="true"/>
    <parameters name="GIFTCARD_SenderName" type="java.lang.String" optional="true"/>
    <parameters name="GIFTCARD_RecipientEmail" type="java.lang.String" optional="true"/>
    <parameters name="GIFTCARD_RecipientName" type="java.lang.String" optional="true"/>
    <parameters name="GIFTCARD_GreetingMessage" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 11,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode39" strict="true"/>
<!--@Location 12,14-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode26">
    <nodeSuccessors name="next" next="EndNode40"/>
  </nodes>
<!--@Location 12,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode40" name="Error" strict="true"/>
<!--Adjusts the quantities of the
line items of the basket with 
given quantites.
@Location 27,11-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode26" strict="true" name="UpdateQuantities"
      callMode="Private">
    <nodeSuccessors name="next" next="ExtensionPointNode26"/>
    <parameters name="UpdateQuantityRecords" type="com.intershop.component.basket.capi.UpdateQuantityRecords"/>
  </nodes>
<!--@Location 27,12-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode26" name="UpdateQuantities"
      strict="true">
    <nodeSuccessors name="next" next="UpdateQuantities0" action="begin"/>
<!--@BendPoints 57,25-->
    <nodeSuccessors name="pipelet_error" next="JoinNode5"/>
    <parameters name="UpdateQuantityRecords" type="com.intershop.component.basket.capi.UpdateQuantityRecords"/>
  </nodes>
<!--@Location 27,13-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateQuantities0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/UpdateQuantities.xml"/>
    <nodeSuccessors name="next" next="GetFirstElementOfIterator0"/>
  </nodes>
<!--@Location 27,14-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetFirstElementOfIterator0">
    <pipelet href="enfinity:/core/pipelets/GetFirstElementOfIterator.xml"/>
    <nodeSuccessors name="next" next="DecisionNode_iPB2QB-2EemHqNhO6CMfdQ"/>
    <parameterBindings name="Iterator" objectPath="UpdateQuantityRecords:Records:Iterator"/>
    <returnValueBindings name="FirstElement" objectPath="UpdateQuantityRecord"/>
  </nodes>
<!--@Location 27,15-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode_iPB2QB-2EemHqNhO6CMfdQ"
      conditionKey="QuantityUpdated" operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="CallNode18"/>
<!--@BendPoints 56,31 56,37-->
    <nodeSuccessors name="decision_no" next="JoinNode_kg81kB-2EemHqNhO6CMfdQ"/>
  </nodes>
<!--@Location 27,16-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode18">
    <nodeSuccessors name="next" next="ExtensionPointNode25"/>
    <parameterBindings name="Basket" nullBinding="true"/>
    <parameterBindings name="BasketBO" objectPath="UpdateQuantityRecord:ProductLineItem:BasketBO"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 27,17-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode25" name="UpdatedQuantities"
      strict="true">
    <nodeSuccessors name="next" next="JoinNode_kg81kB-2EemHqNhO6CMfdQ"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode5" action="rollback"/>
<!--The line items to update.-->
    <parameters name="UpdateQuantityRecords" type="com.intershop.component.basket.capi.UpdateQuantityRecords"/>
<!--results of updating-->
    <parameters name="AdjustBasketResults" type="com.intershop.component.basket.capi.AdjustBasketResults"/>
  </nodes>
<!--@Location 27,18-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode_kg81kB-2EemHqNhO6CMfdQ">
    <nodeSuccessors name="next" next="EndNode46" action="commit"/>
  </nodes>
<!--@Location 27,19-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode46" strict="true">
    <returnValues name="AdjustBasketResults" type="com.intershop.component.basket.capi.AdjustBasketResults"/>
  </nodes>
<!--@Location 28,17-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode5">
    <nodeSuccessors name="next" next="EndNode45"/>
  </nodes>
<!--@Location 28,19-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode45" name="Error" strict="true">
    <returnValues name="AdjustBasketResults" type="com.intershop.component.basket.capi.AdjustBasketResults"
        optional="true"/>
  </nodes>
<!--Adjusts the quantity of the specified 
line item with the given value.
@Location 2,11-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode9" strict="true" name="UpdateQuantity"
      callMode="Private">
    <nodeSuccessors name="next" next="ExtensionPointNode14"/>
<!--The line item to update.-->
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"
        optional="true"/>
<!--The new quantity of the line item in the basket.-->
    <parameters name="Quantity" type="com.intershop.beehive.foundation.quantity.Quantity"
        optional="true"/>
    <parameters name="UpdateQuantityRecord" type="com.intershop.component.basket.capi.UpdateQuantityRecord"
        optional="true"/>
  </nodes>
<!--@Location 2,12-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode14" name="UpdateQuantity"
      strict="true">
    <nodeSuccessors name="next" next="UpdateQuantity0" action="begin"/>
<!--@BendPoints 7,25-->
    <nodeSuccessors name="pipelet_error" next="JoinNode18"/>
<!--The line item to update.-->
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"
        optional="true"/>
<!--The new quantity of the line item in the basket.-->
    <parameters name="Quantity" type="com.intershop.beehive.foundation.quantity.Quantity"
        optional="true"/>
    <parameters name="UpdateQuantityRecord" type="com.intershop.component.basket.capi.UpdateQuantityRecord"/>
  </nodes>
<!--@Location 2,13-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateQuantity0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/UpdateQuantity.xml"/>
    <nodeSuccessors name="next" next="DecisionNode_KkVikB-2EemHqNhO6CMfdQ"/>
  </nodes>
<!--@Location 2,14-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode_KkVikB-2EemHqNhO6CMfdQ"
      conditionKey="QuantityUpdated" operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="CallNode8"/>
<!--@BendPoints 6,29 6,35-->
    <nodeSuccessors name="decision_no" next="JoinNode_PIHPwB-2EemHqNhO6CMfdQ"/>
  </nodes>
<!--@Location 2,15-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode8">
    <nodeSuccessors name="next" next="ExtensionPointNode15"/>
    <parameterBindings name="Basket" nullBinding="true"/>
    <parameterBindings name="BasketBO" objectPath="ProductLineItem:BasketBO"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 2,16-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode15" name="UpdatedQuantity"
      strict="true">
    <nodeSuccessors name="next" next="JoinNode_PIHPwB-2EemHqNhO6CMfdQ"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode18" action="rollback"/>
<!--The just updated line item.-->
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"
        optional="true"/>
<!--The new quantity of the line item in the basket.-->
    <parameters name="Quantity" type="com.intershop.beehive.foundation.quantity.Quantity"
        optional="true"/>
    <parameters name="UpdateQuantityRecord" type="com.intershop.component.basket.capi.UpdateQuantityRecord"
        optional="true"/>
<!--true if the quantity of the line item was adjusted. otherwise false.-->
    <parameters name="QuantityAdjusted" type="java.lang.Boolean"/>
<!--results of updating-->
    <parameters name="AdjustBasketResults" type="com.intershop.component.basket.capi.AdjustBasketResults"/>
  </nodes>
<!--@Location 2,17-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode_PIHPwB-2EemHqNhO6CMfdQ">
    <nodeSuccessors name="next" next="EndNode12" action="commit"/>
  </nodes>
<!--@Location 2,19-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode12" strict="true">
<!--true if the quantity of the line item was adjusted. otherwise false.-->
    <returnValues name="QuantityAdjusted" type="java.lang.Boolean"/>
    <returnValues name="AdjustBasketResults" type="com.intershop.component.basket.capi.AdjustBasketResults"/>
  </nodes>
<!--@Location 3,16-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode18">
    <nodeSuccessors name="next" next="EndNode27"/>
  </nodes>
<!--@Location 3,19-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode27" name="Error" strict="true">
<!--true if the quantity of the line item was adjusted. otherwise false.-->
    <returnValues name="QuantityAdjusted" type="java.lang.Boolean"/>
  </nodes>
<!--Updates the variation option of 
the specified line item with the 
given variation product.
@Location 7,11-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode12" strict="true" name="UpdateVariation"
      callMode="Private">
    <nodeSuccessors name="next" next="ExtensionPointNode16"/>
<!--The product line item to update.-->
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"
        optional="true"/>
<!--The new product variation.-->
    <parameters name="Variation" type="com.intershop.component.product.capi.ProductBO"
        optional="true"/>
<!--Record object containing data for the variation update.-->
    <parameters name="UpdateVariationRecord" type="com.intershop.component.basket.capi.UpdateVariationRecord"
        optional="true"/>
  </nodes>
<!--@Location 7,12-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode16" name="UpdateVariation"
      strict="true">
    <nodeSuccessors name="next" next="UpdateVariation0" action="begin"/>
<!--@BendPoints 17,25-->
    <nodeSuccessors name="pipelet_error" next="JoinNode20"/>
<!--The product line item to update.-->
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"
        optional="true"/>
<!--The new product variation.-->
    <parameters name="Variation" type="com.intershop.component.product.capi.ProductBO"
        optional="true"/>
<!--Record object containing data for the variation update.-->
    <parameters name="UpdateVariationRecord" type="com.intershop.component.basket.capi.UpdateVariationRecord"
        optional="true"/>
  </nodes>
<!--@Location 7,13-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateVariation0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/UpdateVariation.xml"/>
    <nodeSuccessors name="next" next="CallNode10"/>
  </nodes>
<!--@Location 7,14-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode10">
    <nodeSuccessors name="next" next="ExtensionPointNode17"/>
    <parameterBindings name="Basket" nullBinding="true"/>
    <parameterBindings name="BasketBO" objectPath="ProductLineItem:BasketBO"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 7,15-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode17" name="UpdatedVariation"
      strict="true">
    <nodeSuccessors name="next" next="EndNode18" action="commit"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode20" action="rollback"/>
<!--The product line item given to the call for updating.-->
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"
        optional="true"/>
<!--The new product variation.-->
    <parameters name="Variation" type="com.intershop.component.product.capi.ProductBO"
        optional="true"/>
<!--Record object containing data for the variation update.-->
    <parameters name="UpdateVariationRecord" type="com.intershop.component.basket.capi.UpdateVariationRecord"
        optional="true"/>
<!--@deprecated since 7.7 use UpdateVariationResults instead
The result of the variation update.-->
    <parameters name="AddToBasketResult" type="com.intershop.component.basket.capi.AddToBasketResult"/>
<!--@deprecated since 7.8 use UpdateVariationResults instead
The result of the variation update operations.-->
    <parameters name="AddToBasketResults" type="com.intershop.component.basket.capi.AddToBasketResults"/>
<!--The result of the variation update operations.-->
    <parameters name="UpdateVariationResults" type="com.intershop.component.basket.capi.UpdateVariationResults"/>
  </nodes>
<!--@Location 7,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode18" strict="true">
<!--@deprecated since 7.7 use UpdateVariationResults instead
The result of the variation update.
-->
    <returnValues name="AddToBasketResult" type="com.intershop.component.basket.capi.AddToBasketResult"/>
<!--@deprecated since 7.8 use UpdateVariationResults instead
The result of the variation update.-->
    <returnValues name="AddToBasketResults" type="com.intershop.component.basket.capi.AddToBasketResults"/>
<!--The result of the variation update operations.-->
    <returnValues name="UpdateVariationResults" type="com.intershop.component.basket.capi.UpdateVariationResults"/>
  </nodes>
<!--@Location 8,15-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode20">
    <nodeSuccessors name="next" next="EndNode29"/>
  </nodes>
<!--@Location 8,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode29" name="Error" strict="true"/>
<!--Updates a bulk of variations.
@Location 33,11-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode29" strict="true" name="UpdateVariations"
      callMode="Private">
    <nodeSuccessors name="next" next="ExtensionPointNode32"/>
<!--The product line item to update.-->
    <parameters name="UpdateVariationRecords" type="com.intershop.component.basket.capi.UpdateVariationRecords"/>
  </nodes>
<!--@Location 33,12-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode32" name="UpdateVariations"
      strict="true">
    <nodeSuccessors name="next" next="UpdateVariations0" action="begin"/>
<!--@BendPoints 69,25-->
    <nodeSuccessors name="pipelet_error" next="JoinNode6"/>
<!--The product line item to update.-->
    <parameters name="UpdateVariationRecords" type="com.intershop.component.basket.capi.UpdateVariationRecords"/>
  </nodes>
<!--@Location 33,13-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateVariations0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/UpdateVariations.xml"/>
    <nodeSuccessors name="next" next="CallNode20"/>
  </nodes>
<!--@Location 33,14-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode20">
    <nodeSuccessors name="next" next="ExtensionPointNode31"/>
    <parameterBindings name="Basket" nullBinding="true"/>
    <parameterBindings name="BasketBO" objectPath="ProductLineItem:BasketBO"/>
    <startNode referencedName="ProcessBasketInvalidation-InvalidateBasketCalculation"/>
  </nodes>
<!--@Location 33,15-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode31" name="UpdatedVariations"
      strict="true">
    <nodeSuccessors name="next" next="EndNode51" action="commit"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode6" action="rollback"/>
<!--Records with single record objects for the bulk update operation.-->
    <parameters name="UpdateVariationRecords" type="com.intershop.component.basket.capi.UpdateVariationRecords"/>
<!--The result of the variation update operations.-->
    <parameters name="UpdateVariationResults" type="com.intershop.component.basket.capi.UpdateVariationResults"/>
  </nodes>
<!--@Location 33,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode51" strict="true">
<!--The result of the variation update operations.-->
    <returnValues name="UpdateVariationResults" type="com.intershop.component.basket.capi.UpdateVariationResults"/>
  </nodes>
<!--@Location 34,15-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode6">
    <nodeSuccessors name="next" next="EndNode52"/>
  </nodes>
<!--@Location 34,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode52" name="Error" strict="true"/>
<!--The result of the variation update.Updates the warranty assigned to 
the specified product line item.
@Location 17,11-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode13" strict="true" name="UpdateWarranty"
      callMode="Private">
    <nodeSuccessors name="next" next="DecisionNode2"/>
<!--The new warranty to set at the product line item.-->
    <parameters name="Warranty" type="com.intershop.component.warranty.capi.WarrantyBO"/>
<!--The product line itemto update.-->
    <parameters name="ProductLineItem" type="com.intershop.component.basket.capi.BasketProductLineItemBO"/>
  </nodes>
<!--@Location 17,12-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode2" conditionKey="ProductLineItem:Extension(&quot;Warranty&quot;):hasWarranty"
      operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="DecisionNode7"/>
<!--@BendPoints 36,25 36,29-->
    <nodeSuccessors name="decision_no" next="JoinNode0"/>
  </nodes>
<!--@Location 17,13-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode7" conditionKey="ProductLineItem:Extension(&quot;Warranty&quot;):BasketWarrantyLineItem:ProductSKU"
      operator="str_eq" conditionItem="Warranty:ProductRef:ProductSKU">
<!--@BendPoints 34,28 34,31 34,34-->
    <nodeSuccessors name="decision_yes" next="JoinNode8"/>
    <nodeSuccessors name="decision_no" next="CallNode0"/>
  </nodes>
<!--@Location 17,17-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode8">
    <nodeSuccessors name="next" next="EndNode15"/>
  </nodes>
<!--@Location 17,18-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode15" strict="true"/>
<!--@Location 17,14-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode0">
    <nodeSuccessors name="next" next="JoinNode0"/>
    <nodeSuccessors name="Error" next="JoinNode23"/>
    <startNode referencedName="ProcessBasket-RemoveWarranty"/>
  </nodes>
<!--@Location 17,15-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode0">
    <nodeSuccessors name="next" next="CallNode1"/>
  </nodes>
<!--@Location 17,16-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode1">
    <nodeSuccessors name="next" next="JoinNode8"/>
    <nodeSuccessors name="ERROR" next="JoinNode24"/>
    <startNode referencedName="ProcessBasket-AddWarranty"/>
  </nodes>
<!--@Location 18,16-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode24">
    <nodeSuccessors name="next" next="EndNode16"/>
  </nodes>
<!--@Location 18,18-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode16" name="ERROR" strict="true">
<!--Information about the reason, why the warranty could not be added.-->
    <returnValues name="ERROR_Warranty" type="java.lang.String"/>
  </nodes>
<!--@Location 18,14-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode23">
    <nodeSuccessors name="next" next="JoinNode24"/>
  </nodes>
</pipeline:Pipeline>
