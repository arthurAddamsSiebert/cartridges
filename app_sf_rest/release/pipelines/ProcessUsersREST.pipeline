<?xml version="1.0" encoding="UTF-8"?>
<!--@Group REST-->

<pipeline:Pipeline xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:pipeline="http://www.intershop.de/pipeline/2010"
    name="ProcessUsersREST" overrideMode="Inherit" type="process">
<!--@Location 10,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode9" strict="true" name="AddAddress"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode10"/>
    <parameters name="CurrentUser" type="com.intershop.beehive.core.capi.user.User"/>
    <parameters name="AddressRO" type="com.intershop.sellside.rest.common.capi.resourceobject.AddressRO"/>
  </nodes>
<!--@Location 10,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode10">
<!--@BendPoints 21,4-->
    <nodeSuccessors name="next" next="EndNode16"/>
    <parameterBindings name="AddressName" objectPath="AddressRO:AddressName"/>
    <parameterBindings name="City" objectPath="AddressRO:City"/>
    <parameterBindings name="Country" objectPath="AddressRO:Country"/>
    <parameterBindings name="CountryCode" objectPath="AddressRO:CountryCode"/>
    <parameterBindings name="FirstName" objectPath="AddressRO:FirstName"/>
    <parameterBindings name="LastName" objectPath="AddressRO:LastName"/>
    <parameterBindings name="PostalCode" objectPath="AddressRO:PostalCode"/>
    <parameterBindings name="PreferredBillingAddress" objectPath="AddressRO:PreferredBillingAddress"/>
    <parameterBindings name="PreferredShippingAddress" objectPath="AddressRO:PreferredShippingAddress"/>
    <parameterBindings name="State" objectPath="AddressRO:State"/>
    <parameterBindings name="Street" objectPath="AddressRO:Street"/>
    <parameterBindings name="Title" objectPath="AddressRO:Title"/>
    <parameterBindings name="User" objectPath="CurrentUser"/>
    <startNode referencedName="ProcessAddress-Create"/>
  </nodes>
<!--@Location 10,2-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode16" strict="true">
    <returnValues name="Address" type="com.intershop.beehive.core.capi.profile.Address"/>
  </nodes>
<!--@Location 2,9-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode6" name="AddAddressDataToDictionary"
      callMode="Private">
    <nodeSuccessors name="next" next="Pipelet2"/>
    <parameters name="AddressRO" type="com.intershop.sellside.rest.common.capi.resourceobject.AddressRO"/>
  </nodes>
<!--@Location 2,10-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet2">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="EndNode9"/>
    <parameterBindings name="InValue_1" objectPath="AddressRO:City"/>
    <parameterBindings name="InValue_2" objectPath="AddressRO:Country"/>
    <parameterBindings name="InValue_3" objectPath="AddressRO:Email"/>
    <parameterBindings name="InValue_4" objectPath="AddressRO:Fax"/>
    <parameterBindings name="InValue_5" objectPath="AddressRO:PostalCode"/>
    <parameterBindings name="InValue_6" objectPath="AddressRO:Street"/>
    <parameterBindings name="InValue_7" objectPath="AddressRO:PhoneBusiness"/>
    <returnValueBindings name="OutValue_1" objectPath="City"/>
    <returnValueBindings name="OutValue_2" objectPath="Country"/>
    <returnValueBindings name="OutValue_3" objectPath="Email"/>
    <returnValueBindings name="OutValue_4" objectPath="Fax"/>
    <returnValueBindings name="OutValue_5" objectPath="PostalCode"/>
    <returnValueBindings name="OutValue_6" objectPath="Street"/>
    <returnValueBindings name="OutValue_7" objectPath="PhoneBusiness"/>
  </nodes>
<!--@Location 2,11-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode9" name="End"/>
<!--Adds a user. Also allows to add a default contact address at the same time.
@Location 4,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode1" strict="true" name="AddUser"
      callMode="Private">
    <nodeSuccessors name="next" next="GenerateSeriesNumber0"/>
    <parameters name="UserRO" type="com.intershop.sellside.rest.common.capi.resourceobject.UserRO"/>
    <parameters name="Organization" type="com.intershop.component.organization.capi.Organization"/>
    <parameters name="CurrentOrganization" type="com.intershop.component.organization.capi.Organization"/>
  </nodes>
<!--@Location 4,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GenerateSeriesNumber0">
    <configurationValues name="DomainSpecific" value="false"/>
    <configurationValues name="NumberPattern" value="00000000"/>
    <configurationValues name="SeriesIdentifier" value="UserSeries"/>
    <configurationValues name="StartWith" value="1"/>
    <pipelet href="enfinity:/core/pipelets/GenerateSeriesNumber.xml"/>
    <nodeSuccessors name="next" next="CallNode5"/>
    <returnValueBindings name="SeriesNumber" objectPath="BusinessPartnerNo"/>
  </nodes>
<!--@Location 4,2-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode5">
    <nodeSuccessors name="next" next="Pipelet3"/>
    <parameterBindings name="UserRO" objectPath="UserRO"/>
    <startNode referencedName="ProcessUsersREST-AddUserDataToDictionary"/>
  </nodes>
<!--@Location 5,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet3">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="CheckForEmptyString0"/>
    <parameterBindings name="InValue_1" objectPath="UserRO:DefaultAddress"/>
    <returnValueBindings name="OutValue_1" objectPath="AddressRO"/>
  </nodes>
<!--@Location 4,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CheckForEmptyString0">
    <pipelet href="enfinity:/bc_foundation/pipelets/CheckForEmptyString.xml"/>
    <nodeSuccessors name="next" next="CallNode6"/>
    <nodeSuccessors name="pipelet_error" next="SetDictionaryValue5"/>
    <parameterBindings name="FilledString" objectPath="UserRO:Password"/>
  </nodes>
<!--@Location 4,4-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode6">
    <nodeSuccessors name="next" next="CallNode7"/>
    <startNode referencedName="ProcessUsersREST-AddAddressDataToDictionary"/>
  </nodes>
<!--@Location 4,5-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode7">
    <nodeSuccessors name="next" next="SetDictionaryValue1"/>
<!--@BendPoints 11,11-->
    <nodeSuccessors name="ERROR" next="EndNode15"/>
    <startNode referencedName="ProcessUsersREST-ValidateInput"/>
  </nodes>
<!--@Location 4,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetDictionaryValue1">
    <configurationValues name="Name" value="IsActive"/>
    <configurationValues name="Value" value="true"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetDictionaryValue.xml"/>
    <nodeSuccessors name="next" next="GetApplicationBO0"/>
  </nodes>
<!--@Location 4,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetApplicationBO0">
    <pipelet href="enfinity:/bc_application/pipelets/GetApplicationBO.xml"/>
    <nodeSuccessors name="next" next="CallNode22"/>
  </nodes>
<!--@Location 4,8-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode22">
    <nodeSuccessors name="next" next="CallNode13"/>
    <nodeSuccessors name="ERROR" next="Pipelet4"/>
    <parameterBindings name="City" objectPath="UserRO:DefaultAddress:City"/>
    <parameterBindings name="Company" objectPath="UserRO:DefaultAddress:Company"/>
    <parameterBindings name="CountryCode" objectPath="UserRO:DefaultAddress:Country"/>
    <parameterBindings name="CreateDefaultAddress" constant="true"/>
    <parameterBindings name="CustomerBORepository" objectPath="ApplicationBO:Repository(&quot;CustomerBORepository&quot;)"/>
    <parameterBindings name="Email" objectPath="UserRO:Login"/>
    <parameterBindings name="Fax" objectPath="UserRO:DefaultAddress:Fax"/>
    <parameterBindings name="FirstName" objectPath="UserRO:FirstName"/>
    <parameterBindings name="LastName" objectPath="UserRO:LastName"/>
    <parameterBindings name="Login" objectPath="UserRO:Login"/>
    <parameterBindings name="Organization" objectPath="CurrentOrganization"/>
    <parameterBindings name="Password" objectPath="UserRO:Password"/>
    <parameterBindings name="PasswordConfirmation" objectPath="UserRO:PasswordConfirmation"/>
    <parameterBindings name="PhoneBusiness" objectPath="UserRO:DefaultAddress:PhoneBusiness"/>
    <parameterBindings name="State" objectPath="UserRO:DefaultAddress:State"/>
    <parameterBindings name="Street" objectPath="UserRO:DefaultAddress:Street"/>
    <parameterBindings name="UserBORepository" objectPath="ApplicationBO:Repository(&quot;UserBORepository&quot;)"/>
    <startNode referencedName="ProcessUserAccount-CreateUser"/>
  </nodes>
<!--@Location 4,9-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode13">
    <nodeSuccessors name="next" next="CallNode15"/>
    <nodeSuccessors name="400" next="EndNode27"/>
    <startNode referencedName="ProcessUsersREST-GetUser"/>
  </nodes>
<!--@Location 4,10-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode15">
    <nodeSuccessors name="next" next="DetermineUser0"/>
    <startNode referencedName="ProcessUsersREST-SendRegistrationEmail"/>
  </nodes>
<!--@Location 4,11-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="DetermineUser0">
    <pipelet href="enfinity:/core/pipelets/DetermineUser.xml"/>
    <nodeSuccessors name="next" next="ReactivateUser1"/>
    <parameterBindings name="UserID" objectPath="UserBO:ID"/>
  </nodes>
<!--@Location 4,12-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ReactivateUser1">
    <pipelet href="enfinity:/core/pipelets/ReactivateUser.xml"/>
    <nodeSuccessors name="next" next="EndNode2"/>
  </nodes>
<!--@Location 4,13-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode2" name="End" strict="true">
<!--The newly created user-->
    <returnValues name="User" type="com.intershop.beehive.core.capi.user.User" optional="true"/>
  </nodes>
<!--@Location 3,9-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode27" name="400" strict="true">
    <returnValues name="ErrorCode" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 5,8-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet4">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
<!--@BendPoints 11,18-->
    <nodeSuccessors name="next" next="DecisionNode1"/>
    <parameterBindings name="InValue_1" objectPath="ERROR_User"/>
    <returnValueBindings name="OutValue_1" objectPath="ErrorCode"/>
  </nodes>
<!--@Location 5,9-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode1" conditionKey="ErrorCode"
      operator="str_eq" conditionValue="LoginAlreadyInUse">
    <nodeSuccessors name="decision_yes" next="JoinNode1"/>
<!--@BendPoints 13,19 13,20-->
    <nodeSuccessors name="decision_no" next="DecisionNode2"/>
  </nodes>
<!--@Location 5,11-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode1">
<!--@BendPoints 11,24-->
    <nodeSuccessors name="next" next="EndNode3"/>
  </nodes>
<!--@Location 5,12-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode3" name="409" strict="true">
    <returnValues name="ErrorCode" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 6,10-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode2" conditionKey="ErrorCode"
      operator="str_eq" conditionValue="BusinessPartnerNoNotUnique">
<!--@BendPoints 13,23-->
    <nodeSuccessors name="decision_yes" next="JoinNode1"/>
<!--@BendPoints 15,21 15,22-->
    <nodeSuccessors name="decision_no" next="EndNode10"/>
  </nodes>
<!--@Location 7,11-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode10" name="500" strict="true">
    <returnValues name="ErrorCode" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 6,5-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode15" name="400" strict="true">
    <returnValues name="ErrorCode" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 3,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetDictionaryValue5">
    <configurationValues name="Name" value="ErrorCode"/>
    <configurationValues name="Value" value="Password required"/>
    <configurationValues name="ValueType" value="Dictionary Value"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetDictionaryValue.xml"/>
    <nodeSuccessors name="next" next="EndNode29"/>
  </nodes>
<!--@Location 3,4-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode29" name="400" strict="true">
    <returnValues name="ErrorCode" type="java.lang.String" optional="true"/>
  </nodes>
<!--@displayNearNode@This sub\-pipeline is only needed because 
the called pipeline start nodes (e.g. ProcessUser\-Create) 
are not strict and thus do not use aliased parameters
@Location 0,9-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode5" name="AddUserDataToDictionary"
      callMode="Private">
<!--@BendPoints 1,20-->
    <nodeSuccessors name="next" next="Pipelet1"/>
    <parameters name="UserRO" type="com.intershop.sellside.rest.common.capi.resourceobject.UserRO"/>
  </nodes>
<!--@Location 0,10-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet1">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="KeyMapper1"/>
    <parameterBindings name="InValue_1" objectPath="UserRO:Login"/>
    <parameterBindings name="InValue_10" objectPath="UserRO:SecurityQuestion"/>
    <parameterBindings name="InValue_2" objectPath="UserRO:FirstName"/>
    <parameterBindings name="InValue_3" objectPath="UserRO:LastName"/>
    <parameterBindings name="InValue_4" objectPath="UserRO:BusinessPartnerNo"/>
    <parameterBindings name="InValue_5" objectPath="UserRO:Password"/>
    <parameterBindings name="InValue_6" objectPath="UserRO:PasswordConfirmation"/>
    <parameterBindings name="InValue_7" objectPath="UserRO:Title"/>
    <parameterBindings name="InValue_8" objectPath="UserRO:SecondName"/>
    <parameterBindings name="InValue_9" objectPath="UserRO:PasswordReminder"/>
    <returnValueBindings name="OutValue_1" objectPath="Login"/>
    <returnValueBindings name="OutValue_10" objectPath="SecurityQuestion"/>
    <returnValueBindings name="OutValue_2" objectPath="FirstName"/>
    <returnValueBindings name="OutValue_3" objectPath="LastName"/>
    <returnValueBindings name="OutValue_4" objectPath="BusinessPartnerNo"/>
    <returnValueBindings name="OutValue_5" objectPath="Password"/>
    <returnValueBindings name="OutValue_6" objectPath="PasswordConfirmation"/>
    <returnValueBindings name="OutValue_7" objectPath="Title"/>
    <returnValueBindings name="OutValue_8" objectPath="SecondName"/>
    <returnValueBindings name="OutValue_9" objectPath="PasswordReminder"/>
  </nodes>
<!--@Location 0,11-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper1">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="EndNode8"/>
    <parameterBindings name="InValue_1" objectPath="UserRO:Login"/>
    <returnValueBindings name="OutValue_1" objectPath="Email"/>
  </nodes>
<!--@Location 0,12-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode8" name="End"/>
<!--@Location 2,14-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode8" name="CheckBirthday" callMode="Private">
<!--@BendPoints 5,30-->
    <nodeSuccessors name="next" next="DecisionNode5"/>
  </nodes>
<!--@Location 2,15-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode5" conditionKey="Birthday"
      operator="undef">
    <nodeSuccessors name="decision_yes" next="JoinNode5"/>
<!--@BendPoints 7,31 7,32-->
    <nodeSuccessors name="decision_no" next="DecisionNode4"/>
  </nodes>
<!--@Location 2,17-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode5">
    <nodeSuccessors name="next" next="JoinNode2"/>
  </nodes>
<!--@Location 2,20-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode2">
    <nodeSuccessors name="next" next="EndNode12"/>
  </nodes>
<!--@Location 2,21-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode12"/>
<!--@Location 3,16-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode4" conditionKey="Birthday"
      operator="str_eq" conditionValue="">
<!--@BendPoints 7,35-->
    <nodeSuccessors name="decision_yes" next="JoinNode5"/>
<!--@BendPoints 9,33-->
    <nodeSuccessors name="decision_no" next="Pipelet7"/>
  </nodes>
<!--@Location 4,17-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet7">
    <configurationValues name="MinDate" value="1900.01.01_at_00:00:00"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/VerifyDate.xml"/>
    <nodeSuccessors name="next" next="Pipelet6"/>
<!--@BendPoints 12,35 12,41-->
    <nodeSuccessors name="pipelet_error" next="JoinNode3"/>
    <parameterBindings name="DateString" objectPath="Birthday"/>
    <returnValueBindings name="Date" objectPath="BirthdayDate"/>
    <returnValueBindings name="ErrorCode" objectPath="ERROR_Birthday"/>
  </nodes>
<!--@Location 4,18-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet6">
    <pipelet href="enfinity:/bc_foundation/pipelets/GetCurrentDate.xml"/>
    <nodeSuccessors name="next" next="DecisionNode3"/>
  </nodes>
<!--@Location 4,19-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode3" conditionKey="CurrentDate:Time"
      operator="gt" conditionItem="BirthdayDate:Time">
<!--@BendPoints 9,41 7,41-->
    <nodeSuccessors name="decision_yes" next="JoinNode2"/>
    <nodeSuccessors name="decision_no" next="Pipelet8"/>
  </nodes>
<!--@Location 5,19-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet8">
    <configurationValues name="Name" value="ERROR_Birthday"/>
    <configurationValues name="Value" value="MaxLimitExceeded"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetDictionaryValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode3"/>
  </nodes>
<!--@Location 5,20-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode3">
    <nodeSuccessors name="next" next="EndNode11"/>
  </nodes>
<!--@Location 5,21-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode11" name="ERROR"/>
<!--@Location 11,8-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode17" strict="true" name="CheckGiftCardBalance"
      callMode="Private">
    <nodeSuccessors name="next" next="KeyMapper6"/>
    <parameters name="GiftCardNumber" type="java.lang.String"/>
    <parameters name="GiftCardPin" type="java.lang.String"/>
    <parameters name="ApplicationBO" type="com.intershop.component.application.capi.ApplicationBO"/>
    <parameters name="CurrentApplication" type="com.intershop.beehive.core.capi.domain.Application"/>
  </nodes>
<!--@Location 11,9-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper6">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="DetermineGiftCardTenderBalance0"/>
    <parameterBindings name="InValue_1" objectPath="ApplicationBO:Repository(&quot;ServiceConfigurationBORepository&quot;)"/>
    <returnValueBindings name="OutValue_1" objectPath="ServiceConfigurationBORepository"/>
  </nodes>
<!--@Location 11,10-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="DetermineGiftCardTenderBalance0">
    <pipelet href="enfinity:/bc_giftcard/pipelets/DetermineGiftCardTenderBalance.xml"/>
    <nodeSuccessors name="next" next="EndNode34"/>
    <nodeSuccessors name="pipelet_error" next="EndNode35"/>
    <parameterBindings name="Domain" objectPath="CurrentApplication:Domain"/>
    <parameterBindings name="GiftCardNumber" objectPath="GiftCardNumber"/>
    <parameterBindings name="GiftCardPIN" objectPath="GiftCardPin"/>
  </nodes>
<!--@Location 11,11-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode34" name="End" strict="true">
    <returnValues name="GiftCardTenderBalance" type="com.intershop.component.giftcard.capi.GiftCardTenderBalanceResult"
        optional="true"/>
  </nodes>
<!--@Location 12,10-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode35" name="500" strict="true">
    <returnValues name="ErrorCode" type="java.lang.String"/>
  </nodes>
<!--@Location 13,8-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode18" strict="true" name="GetBasketBO"
      callMode="Private">
    <nodeSuccessors name="next" next="KeyMapper7"/>
    <parameters name="ApplicationBO" type="com.intershop.component.application.capi.ApplicationBO"/>
    <parameters name="User" type="com.intershop.beehive.core.capi.user.User"/>
    <parameters name="Basket" type="com.intershop.beehive.bts.capi.orderprocess.basket.Basket"/>
  </nodes>
<!--@Location 13,9-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper7">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="KeyMapper8"/>
    <parameterBindings name="InValue_1" objectPath="ApplicationBO:Repository(&quot;UserBORepository&quot;):UserBOByID(User:ID)"/>
    <returnValueBindings name="OutValue_1" objectPath="UserBO"/>
  </nodes>
<!--@Location 13,10-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper8">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="GetBasketByID0"/>
    <parameterBindings name="InValue_1" objectPath="UserBO:Extension(&quot;UserBOBasketExtension&quot;)"/>
    <returnValueBindings name="OutValue_1" objectPath="BasketBORepository"/>
  </nodes>
<!--@Location 13,11-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetBasketByID0">
    <pipelet href="enfinity:/bc_orderprocess/pipelets/GetBasketByID.xml"/>
    <nodeSuccessors name="next" next="EndNode36"/>
<!--@BendPoints 29,23-->
    <nodeSuccessors name="pipelet_error" next="EndNode38"/>
    <parameterBindings name="BasketID" objectPath="Basket:UUID"/>
    <returnValueBindings name="Basket" objectPath="BasketBO"/>
  </nodes>
<!--@Location 13,12-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode36" strict="true">
    <returnValues name="BasketBO" type="com.intershop.component.basket.capi.BasketBO"/>
  </nodes>
<!--@Location 14,12-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode38" name="ERROR" strict="true"/>
<!--@Location 9,8-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode16" visibility="Private" name="GetGiftCardsAndCertificates"
      callMode="Private">
    <nodeSuccessors name="next" next="KeyMapper5"/>
  </nodes>
<!--@Location 9,9-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper5">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="GetRegisteredGiftCardService0"/>
    <parameterBindings name="InValue_1" objectPath="ApplicationBO:Repository(&quot;ServiceConfigurationBORepository&quot;)"/>
    <returnValueBindings name="OutValue_1" objectPath="ServiceConfigurationBORepository"/>
  </nodes>
<!--@Location 9,10-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetRegisteredGiftCardService0">
    <pipelet href="enfinity:/bc_giftcard/pipelets/GetRegisteredGiftCardService.xml"/>
    <nodeSuccessors name="next" next="PrepareUserAccountViewOfGiftCards0"/>
<!--@BendPoints 21,21-->
    <nodeSuccessors name="pipelet_error" next="JoinNode20"/>
    <parameterBindings name="Domain" objectPath="CurrentOrganization:OwningDomain"/>
    <parameterBindings name="Domain" objectPath="CurrentOrganization:OwningDomain"/>
    <parameterBindings name="Domain" objectPath="CurrentOrganization:OwningDomain"/>
    <parameterBindings name="Domain" objectPath="CurrentOrganization:OwningDomain"/>
    <parameterBindings name="Domain" objectPath="CurrentOrganization:OwningDomain"/>
    <parameterBindings name="Domain" objectPath="CurrentOrganization:OwningDomain"/>
    <parameterBindings name="Domain" objectPath="CurrentOrganization:OwningDomain"/>
    <parameterBindings name="Domain" objectPath="CurrentOrganization:OwningDomain"/>
    <parameterBindings name="Domain" objectPath="CurrentOrganization:OwningDomain"/>
    <parameterBindings name="Domain" objectPath="CurrentOrganization:OwningDomain"/>
    <parameterBindings name="Domain" objectPath="CurrentOrganization:OwningDomain"/>
    <parameterBindings name="Domain" objectPath="CurrentOrganization:OwningDomain"/>
    <parameterBindings name="Domain" objectPath="CurrentOrganization:OwningDomain"/>
    <parameterBindings name="Domain" objectPath="CurrentOrganization:OwningDomain"/>
    <parameterBindings name="Domain" objectPath="CurrentOrganization:OwningDomain"/>
    <parameterBindings name="Domain" objectPath="CurrentOrganization:OwningDomain"/>
  </nodes>
<!--@Location 9,11-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="PrepareUserAccountViewOfGiftCards0">
    <pipelet href="enfinity:/bc_giftcard/pipelets/PrepareUserAccountViewOfGiftCards.xml"/>
    <nodeSuccessors name="next" next="JoinNode19"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode20"/>
    <parameterBindings name="Domain" objectPath="CurrentOrganization:OwningDomain"/>
    <parameterBindings name="GiftCardServiceID" objectPath="GiftCardService:ServiceID"/>
  </nodes>
<!--@Location 9,12-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode19">
    <nodeSuccessors name="next" next="EndNode33"/>
  </nodes>
<!--@Location 9,13-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode33"/>
<!--@Location 10,11-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode20">
<!--@BendPoints 21,25-->
    <nodeSuccessors name="next" next="JoinNode19"/>
  </nodes>
<!--@Location 2,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode2" strict="true" name="GetProfile"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode2"/>
  </nodes>
<!--@Location 2,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode2">
    <nodeSuccessors name="next" next="EndNode1"/>
    <nodeSuccessors name="ERROR" next="EndNode4"/>
    <parameterBindings name="User" objectPath="CurrentUser"/>
    <startNode referencedName="ProcessUser-GetProfile"/>
    <returnValueBindings name="ERROR_User" objectPath="ErrorCode"/>
  </nodes>
<!--@Location 2,2-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode1" name="End" strict="true">
    <returnValues name="Profile" type="com.intershop.beehive.core.capi.profile.Profile"/>
  </nodes>
<!--@Location 3,1-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode4" name="403" strict="true">
<!--Set to "UserNotLoggedIn" if the user is not logged in-->
    <returnValues name="ErrorCode" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 22,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode12" strict="true" visibility="Private"
      name="GetUser" callMode="Private">
    <nodeSuccessors name="next" next="CallNode17"/>
    <parameters name="Login" type="java.lang.String" optional="true"/>
    <parameters name="Password" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 22,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode17">
    <nodeSuccessors name="next" next="GetUserByLogin2"/>
    <startNode referencedName="DetermineOrganizations-Current"/>
  </nodes>
<!--@Location 22,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetUserByLogin2">
    <pipelet href="enfinity:/bc_foundation/pipelets/GetUserByLogin.xml"/>
    <nodeSuccessors name="next" next="EndNode25"/>
    <nodeSuccessors name="pipelet_error" next="SetDictionaryValue3"/>
    <parameterBindings name="Domain" objectPath="CurrentOrganization:OrganizationDomain"/>
  </nodes>
<!--@Location 22,3-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode25" name="End" strict="true">
    <returnValues name="User" type="com.intershop.beehive.core.capi.user.User" optional="true"/>
  </nodes>
<!--@Location 23,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetDictionaryValue3">
    <configurationValues name="Name" value="ErrorCode"/>
    <configurationValues name="Value" value="UserNotFound"/>
    <configurationValues name="ValueType" value="Dictionary Value"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetDictionaryValue.xml"/>
    <nodeSuccessors name="next" next="EndNode24"/>
  </nodes>
<!--@Location 24,2-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode24" name="400" strict="true">
    <returnValues name="ErrorCode" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 0,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode3" strict="true" name="Login"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode0"/>
<!--The login name of the user (is get from webform)-->
    <parameters name="Login" type="java.lang.String"/>
<!--The password of the user (is get from webform)-->
    <parameters name="Password" type="java.lang.String"/>
    <parameters name="CurrentOrganization" type="com.intershop.component.organization.capi.Organization"/>
    <parameters name="CurrentAppContext" type="com.intershop.beehive.app.capi.AppContext"/>
  </nodes>
<!--@Location 0,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode0">
    <nodeSuccessors name="next" next="GetApplicationBO1"/>
    <startNode referencedName="DetermineOrganizations-Current"/>
  </nodes>
<!--@Location 0,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetApplicationBO1">
    <pipelet href="enfinity:/bc_application/pipelets/GetApplicationBO.xml"/>
    <nodeSuccessors name="next" next="CallNode3"/>
  </nodes>
<!--@Location 0,3-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode3">
    <nodeSuccessors name="next" next="DecisionNode8"/>
    <nodeSuccessors name="ERROR" next="EndNode6"/>
    <startNode referencedName="ProcessLogin-LoginUser"/>
    <returnValueBindings name="ERROR_User" objectPath="ErrorCode"/>
  </nodes>
<!--@Location 0,4-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode8" conditionKey="CurrentCart">
    <nodeSuccessors name="decision_yes" next="CallNode1"/>
<!--@BendPoints 2,10 2,15-->
    <nodeSuccessors name="decision_no" next="JoinNode21"/>
  </nodes>
<!--@Location 0,5-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode1">
    <nodeSuccessors name="next" next="CallNode21"/>
    <parameterBindings name="ApplicationBO" objectPath="ApplicationBO"/>
    <parameterBindings name="Basket" objectPath="CurrentCart"/>
    <parameterBindings name="User" objectPath="CurrentUser"/>
    <startNode referencedName="ProcessUsersREST-GetBasketBO"/>
  </nodes>
<!--@Location 0,6-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode21">
    <nodeSuccessors name="next" next="JoinNode21"/>
    <parameterBindings name="Basket" objectPath="BasketBO"/>
    <startNode referencedName="ProcessBasket-Calculate"/>
  </nodes>
<!--@Location 0,7-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode21">
    <nodeSuccessors name="next" next="EndNode5"/>
  </nodes>
<!--@Location 0,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode5" name="End" strict="true">
    <returnValues name="CurrentUser" type="com.intershop.beehive.core.capi.user.User"/>
  </nodes>
<!--@Location 1,3-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode6" name="401" strict="true">
    <returnValues name="ErrorCode" type="java.lang.String"/>
  </nodes>
<!--@Location 15,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode0" strict="true" name="RemindPassword"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode18"/>
    <parameters name="CurrentOrganization" type="com.intershop.component.organization.capi.Organization"/>
    <parameters name="Login" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 15,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode18">
    <nodeSuccessors name="next" next="CallNode14"/>
    <nodeSuccessors name="400" next="EndNode20"/>
    <startNode referencedName="ProcessUsersREST-GetUser"/>
  </nodes>
<!--@Location 15,2-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode14">
    <nodeSuccessors name="next" next="EndNode0"/>
    <startNode referencedName="ProcessUsersREST-SendReminderMail"/>
  </nodes>
<!--@Location 15,3-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode0" name="End" strict="true"/>
<!--@Location 16,1-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode20" name="400" strict="true">
    <returnValues name="ErrorCode" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 13,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode11" strict="true" name="RemoveAddress"
      callMode="Private">
    <nodeSuccessors name="next" next="DecisionNode6"/>
<!--The uuid of the address to be looked up.-->
    <parameters name="Address" type="com.intershop.beehive.core.capi.profile.Address"/>
<!--The current user.-->
    <parameters name="CurrentUser" type="com.intershop.beehive.core.capi.user.User"/>
  </nodes>
<!--@Location 13,1-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode6" conditionKey="CurrentUser:Profile:AddressBook:BasicAddressesCount"
      operator="gt" conditionValue="1">
    <nodeSuccessors name="decision_yes" next="CallNode12"/>
    <nodeSuccessors name="decision_no" next="SetDictionaryValue4"/>
  </nodes>
<!--@Location 13,2-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode12">
    <nodeSuccessors name="next" next="EndNode18"/>
    <nodeSuccessors name="ERROR" next="EndNode19"/>
    <parameterBindings name="AddressID" objectPath="Address:AddressID"/>
    <parameterBindings name="Profile" objectPath="CurrentUser:Profile"/>
    <startNode referencedName="ProcessAddress-DeleteAddress"/>
    <returnValueBindings name="ERROR_Address" objectPath="ErrorCode"/>
  </nodes>
<!--@Location 13,3-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode18" strict="true"/>
<!--@Location 14,3-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode19" name="500" strict="true">
    <returnValues name="ErrorCode" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 14,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetDictionaryValue4">
    <configurationValues name="Name" value="ErrorCode"/>
    <configurationValues name="Value" value="One address ist mandatory"/>
    <configurationValues name="ValueType" value="Dictionary Value"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetDictionaryValue.xml"/>
    <nodeSuccessors name="next" next="EndNode26"/>
  </nodes>
<!--@Location 14,2-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode26" name="409" strict="true">
    <returnValues name="ErrorCode" type="java.lang.String"/>
  </nodes>
<!--@Location 17,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode13" strict="true" name="SendRegistrationEmail"
      callMode="Private">
    <nodeSuccessors name="next" next="GetRepositoryByRepositoryDomain0"/>
    <parameters name="User" type="com.intershop.beehive.core.capi.user.User"/>
    <parameters name="CurrentOrganization" type="com.intershop.component.organization.capi.Organization"/>
  </nodes>
<!--@Location 17,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetRepositoryByRepositoryDomain0">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetRepositoryByRepositoryDomain.xml"/>
    <nodeSuccessors name="next" next="GetDomainPreference1"/>
<!--@BendPoints 37,3-->
    <nodeSuccessors name="pipelet_error" next="JoinNode8"/>
    <parameterBindings name="RepositoryDomain" objectPath="CurrentOrganization:OwningDomain"/>
    <returnValueBindings name="Repository" objectPath="ChannelRepository"/>
  </nodes>
<!--@Location 17,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetDomainPreference1">
    <configurationValues name="DefaultPreferenceKey" value="UserRegistrationEmailFrom"/>
    <configurationValues name="Type" value="String"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetDomainPreference.xml"/>
    <nodeSuccessors name="next" next="GetDomainPreference2"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode8"/>
    <parameterBindings name="PreferenceDomain" objectPath="ChannelRepository:Domain"/>
    <returnValueBindings name="PreferenceStringValue" objectPath="UserRegistrationEmailFrom"/>
  </nodes>
<!--@Location 17,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetDomainPreference2">
    <configurationValues name="DefaultPreferenceKey" value="UserRegistrationEmailSubject"/>
    <configurationValues name="Type" value="String"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetDomainPreference.xml"/>
    <nodeSuccessors name="next" next="GetDomainPreference0"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode6"/>
    <parameterBindings name="PreferenceDomain" objectPath="ChannelRepository:Domain"/>
    <returnValueBindings name="PreferenceStringValue" objectPath="UserRegistrationEmailSubject"/>
  </nodes>
<!--@Location 17,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetDomainPreference0">
    <configurationValues name="DefaultPreferenceKey" value="UserRegistrationEmailTemplate"/>
    <configurationValues name="Type" value="String"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetDomainPreference.xml"/>
    <nodeSuccessors name="next" next="ProcessMail0"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode0"/>
    <parameterBindings name="PreferenceDomain" objectPath="ChannelRepository:Domain"/>
    <returnValueBindings name="PreferenceStringValue" objectPath="UserRegistrationEmailTemplate"/>
  </nodes>
<!--@Location 17,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ProcessMail0">
    <configurationValues name="UseErrorConnector" value="true"/>
    <configurationValues name="WaitForResult" value="false"/>
    <pipelet href="enfinity:/bc_mail/pipelets/ProcessMail.xml"/>
    <nodeSuccessors name="next" next="EndNode21"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode7"/>
    <parameterBindings name="Domain" objectPath="CurrentOrganization:OwningDomain"/>
    <parameterBindings name="LocaleID" objectPath="User:Profile:Credentials:ReminderEmail"/>
    <parameterBindings name="MailFrom" objectPath="UserRegistrationEmailFrom"/>
    <parameterBindings name="MailSubject" objectPath="UserRegistrationEmailSubject"/>
    <parameterBindings name="MailTemplate" objectPath="UserRegistrationEmailTemplate"/>
    <parameterBindings name="MailTo" objectPath="User:Profile:Credentials:Login"/>
  </nodes>
<!--@Location 17,6-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode21" strict="true"/>
<!--@Location 18,5-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode7">
    <nodeSuccessors name="next" next="EndNode22"/>
  </nodes>
<!--@Location 18,6-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode22" name="ERROR" strict="true"/>
<!--@Location 18,4-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode0">
    <nodeSuccessors name="next" next="JoinNode7"/>
  </nodes>
<!--@Location 18,3-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode6">
    <nodeSuccessors name="next" next="JoinNode0"/>
  </nodes>
<!--@Location 18,2-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode8">
    <nodeSuccessors name="next" next="JoinNode6"/>
  </nodes>
<!--@Location 19,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode14" strict="true" name="SendReminderMail"
      callMode="Private">
    <nodeSuccessors name="next" next="GetRepositoryByRepositoryDomain1"/>
    <parameters name="User" type="com.intershop.beehive.core.capi.user.User"/>
    <parameters name="CurrentOrganization" type="com.intershop.component.organization.capi.Organization"/>
    <parameters name="WaitForResult" type="java.lang.String" optional="true"/>
    <parameters name="TargetApplicationBO" type="com.intershop.component.application.capi.ApplicationBO"
        optional="true"/>
  </nodes>
<!--@Location 19,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetRepositoryByRepositoryDomain1">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetRepositoryByRepositoryDomain.xml"/>
    <nodeSuccessors name="next" next="GetCurrentDate0"/>
<!--@BendPoints 43,3-->
    <nodeSuccessors name="pipelet_error" next="JoinNode15"/>
    <parameterBindings name="RepositoryDomain" objectPath="CurrentOrganization:OwningDomain"/>
    <returnValueBindings name="Repository" objectPath="ChannelRepository"/>
  </nodes>
<!--@Location 19,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetCurrentDate0">
    <pipelet href="enfinity:/bc_foundation/pipelets/GetCurrentDate.xml"/>
    <nodeSuccessors name="next" next="GetDomainPreference4"/>
  </nodes>
<!--@Location 19,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetDomainPreference4">
    <configurationValues name="DefaultPreferenceKey" value="PasswordReminderLinkLifeTime"/>
    <configurationValues name="Type" value="Integer"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetDomainPreference.xml"/>
<!--@BendPoints 39,8-->
    <nodeSuccessors name="next" next="CalculateDate0"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode15"/>
    <parameterBindings name="PreferenceDomain" objectPath="ChannelRepository:Domain"/>
    <returnValueBindings name="PreferenceIntValue" objectPath="PasswordReminderLinkLifeTime"/>
  </nodes>
<!--@Location 19,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CalculateDate0">
    <configurationValues name="CalculationMethod" value="Add"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/CalculateDate.xml"/>
<!--@BendPoints 39,10-->
    <nodeSuccessors name="next" next="UpdateUserCredentials0"/>
    <parameterBindings name="Date" objectPath="CurrentDate"/>
    <parameterBindings name="Hours" objectPath="PasswordReminderLinkLifeTime"/>
    <returnValueBindings name="CalculatedDate" objectPath="NewPasswordExpiry"/>
  </nodes>
<!--@displayNearNode@set User active and
set NewPasswordExpiry
@Location 19,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateUserCredentials0">
    <pipelet href="enfinity:/bc_foundation/pipelets/UpdateUserCredentials.xml"/>
<!--@BendPoints 39,12-->
    <nodeSuccessors name="next" next="GetDomainPreference5"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode10"/>
    <parameterBindings name="IsActive" constant="true"/>
    <parameterBindings name="NewPasswordExpiry" objectPath="NewPasswordExpiry"/>
  </nodes>
<!--@Location 19,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetDomainPreference5">
    <configurationValues name="DefaultPreferenceKey" value="PasswordReminderEmailFrom"/>
    <configurationValues name="Type" value="String"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetDomainPreference.xml"/>
<!--@BendPoints 39,14-->
    <nodeSuccessors name="next" next="GetDomainPreference3"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode16"/>
    <parameterBindings name="PreferenceDomain" objectPath="ChannelRepository:Domain"/>
    <returnValueBindings name="PreferenceStringValue" objectPath="PasswordReminderEmailFrom"/>
  </nodes>
<!--@Location 19,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetDomainPreference3">
    <configurationValues name="DefaultPreferenceKey" value="PasswordReminderEmailSubject"/>
    <configurationValues name="Type" value="String"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetDomainPreference.xml"/>
<!--@BendPoints 39,16-->
    <nodeSuccessors name="next" next="GetDomainPreference6"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode13"/>
    <parameterBindings name="PreferenceDomain" objectPath="ChannelRepository:Domain"/>
    <returnValueBindings name="PreferenceStringValue" objectPath="PasswordReminderEmailSubject"/>
  </nodes>
<!--@Location 19,8-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetDomainPreference6">
    <configurationValues name="DefaultPreferenceKey" value="PasswordReminderEmailTemplate"/>
    <configurationValues name="Type" value="String"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetDomainPreference.xml"/>
    <nodeSuccessors name="next" next="KeyMapper0"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode12"/>
    <parameterBindings name="PreferenceDomain" objectPath="ChannelRepository:Domain"/>
    <returnValueBindings name="PreferenceStringValue" objectPath="PasswordReminderEmailTemplate"/>
  </nodes>
<!--@Location 19,9-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper0">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="DecisionNode0"/>
    <parameterBindings name="InValue_1" objectPath="User:Profile:Credentials:PasswordReminder"/>
    <returnValueBindings name="OutValue_1" objectPath="SecureHash"/>
  </nodes>
<!--@Location 19,10-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode0" conditionKey="WaitForResult"
      operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="ProcessMail1"/>
<!--@BendPoints 41,21 41,22-->
    <nodeSuccessors name="decision_no" next="ProcessMail2"/>
  </nodes>
<!--@Location 19,12-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ProcessMail1">
    <configurationValues name="WaitForResult" value="true"/>
    <pipelet href="enfinity:/bc_mail/pipelets/ProcessMail.xml"/>
    <nodeSuccessors name="next" next="JoinNode9"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode14"/>
    <parameterBindings name="Domain" objectPath="ChannelRepository:Domain"/>
    <parameterBindings name="LocaleID" objectPath="User:Profile:DataSheet:PreferredLocale"/>
    <parameterBindings name="MailFrom" objectPath="PasswordReminderEmailFrom"/>
    <parameterBindings name="MailSubject" objectPath="PasswordReminderEmailSubject"/>
    <parameterBindings name="MailTemplate" objectPath="PasswordReminderEmailTemplate"/>
    <parameterBindings name="MailTo" objectPath="User:Profile:Credentials:Login"/>
  </nodes>
<!--@Location 19,13-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode9">
<!--@BendPoints 39,28-->
    <nodeSuccessors name="next" next="EndNode23"/>
  </nodes>
<!--@Location 19,14-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode23" strict="true">
    <returnValues name="SecureHash" type="java.lang.String" optional="true"/>
    <returnValues name="PasswordReminderLinkLifeTime" type="java.lang.Integer" optional="true"/>
    <returnValues name="MailResult" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 20,12-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode14">
    <nodeSuccessors name="next" next="JoinNode11"/>
  </nodes>
<!--@Location 20,13-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode11">
    <nodeSuccessors name="next" next="JoinNode9"/>
  </nodes>
<!--@Location 20,11-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ProcessMail2">
    <pipelet href="enfinity:/bc_mail/pipelets/ProcessMail.xml"/>
    <nodeSuccessors name="next" next="JoinNode14"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode17"/>
    <parameterBindings name="Domain" objectPath="ChannelRepository:Domain"/>
    <parameterBindings name="LocaleID" objectPath="User:Profile:DataSheet:PreferredLocale"/>
    <parameterBindings name="MailFrom" objectPath="PasswordReminderEmailFrom"/>
    <parameterBindings name="MailSubject" objectPath="PasswordReminderEmailSubject"/>
    <parameterBindings name="MailTemplate" objectPath="PasswordReminderEmailTemplate"/>
    <parameterBindings name="MailTo" objectPath="User:Profile:Credentials:Login"/>
  </nodes>
<!--@Location 21,11-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode17">
<!--@BendPoints 43,27-->
    <nodeSuccessors name="next" next="JoinNode11"/>
  </nodes>
<!--@Location 21,8-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode12">
    <nodeSuccessors name="next" next="JoinNode17"/>
  </nodes>
<!--@Location 21,7-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode13">
    <nodeSuccessors name="next" next="JoinNode12"/>
  </nodes>
<!--@Location 21,6-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode16">
    <nodeSuccessors name="next" next="JoinNode13"/>
  </nodes>
<!--@Location 21,5-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode10">
    <nodeSuccessors name="next" next="JoinNode16"/>
  </nodes>
<!--@Location 21,3-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode15">
    <nodeSuccessors name="next" next="JoinNode10"/>
  </nodes>
<!--@Location 12,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode10" strict="true" name="UpdateAddress"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode11"/>
    <parameters name="AddressRO" type="com.intershop.sellside.rest.common.capi.resourceobject.AddressRO"/>
    <parameters name="CurrentUser" type="com.intershop.beehive.core.capi.user.User"/>
    <parameters name="Address" type="com.intershop.beehive.core.capi.profile.Address"/>
  </nodes>
<!--@Location 12,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode11">
    <nodeSuccessors name="next" next="EndNode17"/>
    <parameterBindings name="City" objectPath="AddressRO:City"/>
    <parameterBindings name="Country" objectPath="AddressRO:Country"/>
    <parameterBindings name="CountryCode" objectPath="AddressRO:CountryCode"/>
    <parameterBindings name="FirstName" objectPath="AddressRO:FirstName"/>
    <parameterBindings name="LastName" objectPath="AddressRO:LastName"/>
    <parameterBindings name="PhoneHome" objectPath="AddressRO:PhoneHome"/>
    <parameterBindings name="PostalCode" objectPath="AddressRO:PostalCode"/>
    <parameterBindings name="PreferredBillingAddress" objectPath="AddressRO:PreferredBillingAddress"/>
    <parameterBindings name="PreferredShippingAddress" objectPath="AddressRO:PreferredShippingAddress"/>
    <parameterBindings name="State" objectPath="AddressRO:State"/>
    <parameterBindings name="Street" objectPath="AddressRO:Street"/>
    <parameterBindings name="Title" objectPath="AddressRO:Title"/>
    <parameterBindings name="User" objectPath="CurrentUser"/>
    <startNode referencedName="ProcessAddress-UpdateAddress"/>
  </nodes>
<!--@Location 12,2-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode17" strict="true">
    <returnValues name="Address" type="com.intershop.beehive.core.capi.profile.Address"/>
  </nodes>
<!--Updates a user. Does not update any address data as they are a different resource (Use /addresses instead).
@Location 8,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode4" strict="true" name="UpdateUser"
      callMode="Private">
    <nodeSuccessors name="next" next="CheckUserLoggedIn0"/>
    <parameters name="UserRO" type="com.intershop.sellside.rest.common.capi.resourceobject.UserRO"
        optional="true"/>
    <parameters name="Organization" type="com.intershop.component.organization.capi.Organization"/>
<!--
		
        -->
    <parameters name="CurrentUser" type="com.intershop.beehive.core.capi.user.User"/>
    <parameters name="BirthdayDate" type="java.util.Date" optional="true"/>
  </nodes>
<!--@Location 8,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CheckUserLoggedIn0">
    <pipelet href="enfinity:/core/pipelets/CheckUserLoggedIn.xml"/>
    <nodeSuccessors name="next" next="Pipelet11"/>
    <nodeSuccessors name="pipelet_error" next="SetDictionaryValue0"/>
  </nodes>
<!--@Location 8,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet11">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="CallNode9"/>
    <parameterBindings name="InValue_1" objectPath="CurrentUser:Profile:DataSheet:BusinessPartnerNo"/>
    <returnValueBindings name="OutValue_1" objectPath="BusinessPartnerNo"/>
  </nodes>
<!--@Location 8,3-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode9">
<!--@BendPoints 17,6-->
    <nodeSuccessors name="next" next="Pipelet10"/>
    <startNode referencedName="ProcessUsersREST-AddUserDataToDictionary"/>
  </nodes>
<!--@Location 8,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet10">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="SetDictionaryValue2"/>
    <parameterBindings name="InValue_1" objectPath="CurrentUser"/>
    <returnValueBindings name="OutValue_1" objectPath="User"/>
  </nodes>
<!--@Location 8,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetDictionaryValue2">
    <configurationValues name="Name" value="IsActive"/>
    <configurationValues name="Value" value="true"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetDictionaryValue.xml"/>
    <nodeSuccessors name="next" next="CallNode4"/>
  </nodes>
<!--@Location 8,6-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode4">
    <nodeSuccessors name="next" next="EndNode7"/>
    <startNode referencedName="ProcessUser-Update"/>
  </nodes>
<!--@Location 8,7-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode7" name="End" strict="true">
    <returnValues name="User" type="com.intershop.beehive.core.capi.user.User"/>
  </nodes>
<!--@Location 9,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetDictionaryValue0">
    <configurationValues name="Name" value="ErrorCode"/>
    <configurationValues name="Value" value="UserNotLoggedIn"/>
    <configurationValues name="ValueType" value="Dictionary Value"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetDictionaryValue.xml"/>
    <nodeSuccessors name="next" next="EndNode28"/>
  </nodes>
<!--@Location 9,2-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode28" name="401" strict="true">
<!--Set to "UserNotLoggedIn" if the user is not logged in-->
    <returnValues name="ErrorCode" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 0,13-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode7" name="ValidateInput" callMode="Private">
<!--@BendPoints 1,28-->
    <nodeSuccessors name="next" next="VerifyCredential2"/>
  </nodes>
<!--@Location 0,14-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="VerifyCredential2">
    <configurationValues name="NotEmptyOnly" value="true"/>
    <pipelet href="enfinity:/core/pipelets/VerifyCredential.xml"/>
<!--@BendPoints 1,30-->
    <nodeSuccessors name="next" next="Pipelet5"/>
<!--@BendPoints 3,29-->
    <nodeSuccessors name="pipelet_error" next="JoinNode4"/>
    <parameterBindings name="CurrentLocale" objectPath="CurrentRequest:Locale"/>
    <parameterBindings name="Domain" objectPath="CurrentDomain"/>
    <parameterBindings name="Password" objectPath="UserRO:Password"/>
    <parameterBindings name="User" nullBinding="true"/>
    <returnValueBindings name="ViolatedRuleDescription" objectPath="ErrorCode"/>
  </nodes>
<!--@Location 0,15-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet5">
    <pipelet href="enfinity:/bc_foundation/pipelets/VerifyEMailAddress.xml"/>
<!--@BendPoints 1,32-->
    <nodeSuccessors name="next" next="CallNode8"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode4"/>
    <parameterBindings name="EMailAddress" objectPath="Login"/>
  </nodes>
<!--@Location 0,16-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode8">
    <nodeSuccessors name="next" next="EndNode13"/>
    <startNode referencedName="ProcessUsersREST-CheckBirthday"/>
  </nodes>
<!--@Location 0,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode13"/>
<!--@Location 1,15-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode4">
<!--@BendPoints 3,32-->
    <nodeSuccessors name="next" next="EndNode14"/>
  </nodes>
<!--@Location 1,16-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode14" name="ERROR">
    <returnValues name="ErrorCode" type="java.lang.String" optional="true"/>
  </nodes>
</pipeline:Pipeline>
