<?xml version="1.0" encoding="UTF-8"?>
<!--@Group Rebate-->

<pipeline:Pipeline xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:pipeline="http://www.intershop.de/pipeline/2010"
    name="ViewPromotionCodeConfiguration" type="view">
<!--@Location 7,2-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode21" name="Apply">
    <nodeSuccessors name="next" next="CallNode6"/>
  </nodes>
<!--@Location 7,3-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode6">
    <nodeSuccessors name="next" next="CreateForm7"/>
    <startNode referencedName="This:Prefix"/>
  </nodes>
<!--@Location 7,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateForm7">
    <configurationValues name="FormName" value="PromotionCodeConfiguration"/>
    <configurationValues name="FormResource" value="PromotionCodeConfiguration"/>
    <pipelet href="enfinity:/core/pipelets/CreateForm.xml"/>
<!--@BendPoints 15,10 14,11-->
    <nodeSuccessors name="next" next="ValidateForm4"/>
    <returnValueBindings name="Form" objectPath="PromotionCodeForm"/>
  </nodes>
<!--@Location 7,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ValidateForm4">
    <pipelet href="enfinity:/core/pipelets/ValidateForm.xml"/>
<!--@BendPoints 16,11 15,12-->
    <nodeSuccessors name="next" next="CallNode7"/>
<!--@BendPoints 13,12-->
    <nodeSuccessors name="pipelet_error" next="JoinNode16"/>
    <parameterBindings name="Form" objectPath="PromotionCodeForm"/>
  </nodes>
<!--@Location 7,6-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode7">
    <nodeSuccessors name="YesSingleCode" next="CallNode5"/>
    <nodeSuccessors name="Error" next="JoinNode16"/>
<!--@BendPoints 17,16-->
    <nodeSuccessors name="NoSingleCode" next="UpdatePromotionCodeConfiguration2"/>
    <parameterBindings name="SingleCode" objectPath="PromotionCodeForm:SingleCode:Value"/>
    <parameterBindings name="TotalReusePerCode" objectPath="PromotionCodeForm:TotalReusePerCode:Value"/>
    <parameterBindings name="TotalReusePerCodeFlag" objectPath="PromotionCodeForm:TotalReusePerCodeFlag:Value"/>
    <parameterBindings name="TotalReusePerCustomerFlag" objectPath="PromotionCodeForm:TotalReusePerCustomerFlag:Value"/>
    <parameterBindings name="UseSingleCode" objectPath="PromotionCodeForm:UseSingleCode:Value"/>
    <startNode referencedName="ViewPromotionCodeConfiguration-Verify"/>
  </nodes>
<!--@Location 7,7-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode5">
    <nodeSuccessors name="IsUnique" next="UpdatePromotionCodeConfiguration1"/>
    <nodeSuccessors name="IsNotUnique" next="JoinNode3"/>
    <startNode referencedName="ViewPromotionCodeConfiguration-CheckUniqueness"/>
  </nodes>
<!--@Location 7,8-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdatePromotionCodeConfiguration1">
    <pipelet href="enfinity:/bc_marketing/pipelets/UpdatePromotionCodeConfiguration.xml"/>
<!--@BendPoints 15,18-->
    <nodeSuccessors name="next" next="CallNode9"/>
  </nodes>
<!--@Location 7,9-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode9">
    <nodeSuccessors name="next" next="CallNode20"/>
    <startNode referencedName="ViewPromotionCodeConfiguration-RemoveAllCodeGroupsFromPromotion"/>
  </nodes>
<!--@Location 7,13-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode20">
    <nodeSuccessors name="next" next="CallNode11"/>
    <parameterBindings name="Iterator" nullBinding="true"/>
    <startNode referencedName="ProcessPromotion-TouchPromotion"/>
  </nodes>
<!--@Location 7,14-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode11">
    <nodeSuccessors name="next" next="JoinNode1"/>
    <parameterBindings name="PromotionBORepository" objectPath="ApplicationBO:Repository(&quot;PromotionBORepository&quot;)"/>
    <parameterBindings name="Site" objectPath="ChannelRepository:RepositoryDomain:Site"/>
    <startNode referencedName="ViewPromotion-InvalidatePageCache"/>
  </nodes>
<!--@Location 7,15-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode1">
    <nodeSuccessors name="next" next="CallNode17"/>
  </nodes>
<!--@Location 7,16-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode17">
    <nodeSuccessors name="next" next="CallNode0"/>
    <startNode referencedName="ViewPromotionCodeConfiguration-CreatePromotionCodeConfigurationRequiredForm"/>
  </nodes>
<!--@Location 7,17-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode0">
    <nodeSuccessors name="next" next="GetTargetClusters2"/>
    <startNode referencedName="ViewPromotion-GetLocales"/>
  </nodes>
<!--@displayNearNode@To check whether it is an editing or a live system.
@Location 7,18-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetTargetClusters2">
    <pipelet href="enfinity:/core/pipelets/GetTargetClusters.xml"/>
    <nodeSuccessors name="next" next="PrepareApplicationView3"/>
  </nodes>
<!--@Location 7,19-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="PrepareApplicationView3">
    <configurationValues name="SelectedMenuItem" value="OnlineMarketing"/>
    <configurationValues name="WorkingTemplate" value="marketing/PromotionCodeConfiguration"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/PrepareApplicationView.xml"/>
<!--@BendPoints 15,40-->
    <nodeSuccessors name="next" next="InteractionEnd3"/>
    <parameterBindings name="WorkingTemplateSuffix" objectPath="CurrentChannel:TypeCode"/>
  </nodes>
<!--@Location 7,20-->
  <nodes xsi:type="pipeline:InteractionNode" nodeID="InteractionEnd3">
    <template referencedName="application/ApplicationFrame"/>
  </nodes>
<!--@Location 6,8-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode3">
    <nodeSuccessors name="next" next="JoinNode2"/>
  </nodes>
<!--@Location 6,15-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode2">
    <nodeSuccessors name="next" next="JoinNode1"/>
  </nodes>
<!--@Location 6,7-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode16">
    <nodeSuccessors name="next" next="JoinNode3"/>
  </nodes>
<!--@Location 8,8-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdatePromotionCodeConfiguration2">
    <pipelet href="enfinity:/bc_marketing/pipelets/UpdatePromotionCodeConfiguration.xml"/>
<!--@BendPoints 17,18-->
    <nodeSuccessors name="next" next="SetFormParameterValue9"/>
    <parameterBindings name="SingleCode" nullBinding="true"/>
    <parameterBindings name="SingleCodeCustomerUnlimited" nullBinding="true"/>
    <parameterBindings name="SingleCodeTotal" nullBinding="true"/>
  </nodes>
<!--@Location 8,9-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue9">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
<!--@BendPoints 17,20-->
    <nodeSuccessors name="next" next="SetFormParameterValue10"/>
    <parameterBindings name="FormParameter" objectPath="PromotionCodeForm:TotalReusePerCustomerFlag"/>
    <parameterBindings name="Value" constant="(Integer)0"/>
  </nodes>
<!--@Location 8,10-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue10">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
<!--@BendPoints 17,22-->
    <nodeSuccessors name="next" next="GetPromotionCodeGroups4"/>
    <parameterBindings name="FormParameter" objectPath="PromotionCodeForm:TotalReusePerCodeFlag"/>
    <parameterBindings name="Value" constant="(Integer)0"/>
  </nodes>
<!--@Location 8,11-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetPromotionCodeGroups4">
    <pipelet href="enfinity:/bc_marketing/pipelets/GetPromotionCodeGroups.xml"/>
    <nodeSuccessors name="next" next="CallNode13"/>
    <parameterBindings name="Domain" objectPath="PromotionDomain"/>
  </nodes>
<!--@Location 8,12-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode13">
    <nodeSuccessors name="next" next="CallNode19"/>
    <startNode referencedName="ViewPromotionCodeConfiguration-GetPageablePromotionCodeGroups"/>
  </nodes>
<!--@Location 8,13-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode19">
    <nodeSuccessors name="next" next="CallNode18"/>
    <parameterBindings name="Iterator" nullBinding="true"/>
    <startNode referencedName="ProcessPromotion-TouchPromotion"/>
  </nodes>
<!--@Location 8,14-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode18">
<!--@BendPoints 17,31-->
    <nodeSuccessors name="next" next="JoinNode1"/>
    <parameterBindings name="PromotionBORepository" objectPath="ApplicationBO:Repository(&quot;PromotionBORepository&quot;)"/>
    <parameterBindings name="Site" objectPath="ChannelRepository:RepositoryDomain:Site"/>
    <startNode referencedName="ViewPromotion-InvalidatePageCache"/>
  </nodes>
<!--Checks, if a single code already exists in a promotion code group.
@Location 17,20-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode4" strict="true" name="CheckUniqueness"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode23"/>
    <parameters name="PromotionDomain" type="com.intershop.beehive.core.capi.domain.Domain"/>
    <parameters name="SingleCode" type="java.lang.String"/>
    <parameters name="PromotionCodeForm" type="com.intershop.beehive.core.capi.webform.ValidationElement"/>
    <parameters name="Promotion" type="com.intershop.component.marketing.capi.rebate.Promotion"/>
  </nodes>
<!--@Location 17,21-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode23">
    <nodeSuccessors name="IsNotUnique" next="SetFormError2"/>
<!--@BendPoints 37,44 37,46-->
    <nodeSuccessors name="IsUnique" next="EndNode12"/>
    <startNode referencedName="ProcessPromotionCode-CheckUniqueness"/>
  </nodes>
<!--@Location 17,22-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormError2">
    <pipelet href="enfinity:/core/pipelets/SetFormError.xml"/>
<!--@BendPoints 35,46-->
    <nodeSuccessors name="next" next="EndNode11"/>
    <parameterBindings name="ErrorMsg" constant="error.alreadyexists"/>
    <parameterBindings name="TargetObject" objectPath="PromotionCodeForm:SingleCode"/>
  </nodes>
<!--@Location 17,23-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode11" name="IsNotUnique" strict="true">
    <returnValues name="PromotionCodeForm" type="com.intershop.beehive.core.capi.webform.ValidationElement"/>
  </nodes>
<!--@Location 18,23-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode12" name="IsUnique" strict="true"/>
<!--@Location 3,20-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode10" name="CreatePageablePromotionCodeGroups"
      callMode="Private">
    <nodeSuccessors name="next" next="JoinNode24"/>
  </nodes>
<!--@Location 3,23-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode24">
    <nodeSuccessors name="next" next="CallNode16"/>
  </nodes>
<!--@Location 3,24-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode16">
    <nodeSuccessors name="next" next="JoinNode27"/>
    <startNode referencedName="ProcessClipboard-DeleteAllEntries"/>
  </nodes>
<!--@Location 3,25-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode27">
    <nodeSuccessors name="next" next="GetPromotionCodeGroups2"/>
  </nodes>
<!--@Location 3,26-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetPromotionCodeGroups2">
    <pipelet href="enfinity:/bc_marketing/pipelets/GetPromotionCodeGroups.xml"/>
    <nodeSuccessors name="next" next="JoinNode23"/>
  </nodes>
<!--@Location 3,27-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode23">
    <nodeSuccessors name="next" next="CreatePageableFromIterator3"/>
  </nodes>
<!--@Location 3,28-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreatePageableFromIterator3">
    <configurationValues name="PageableName" value="PromotionCodeGroups"/>
    <configurationValues name="Pagesize" value="10"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/CreatePageableFromIterator.xml"/>
    <nodeSuccessors name="next" next="SetPage6"/>
    <parameterBindings name="Iterator" objectPath="PromotionCodeGroups"/>
    <returnValueBindings name="Pageable" objectPath="PromotionCodeGroups"/>
  </nodes>
<!--@Location 3,29-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetPage6">
    <configurationValues name="DefaultPageNumber" value="0"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetPage.xml"/>
<!--@BendPoints 7,61-->
    <nodeSuccessors name="next" next="JoinNode25"/>
    <parameterBindings name="PageNumber" objectPath="PageLocator:PageNumber"/>
    <parameterBindings name="Pageable" objectPath="PromotionCodeGroups"/>
  </nodes>
<!--@Location 2,30-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode25">
<!--@BendPoints 5,65-->
    <nodeSuccessors name="next" next="JoinNode26"/>
  </nodes>
<!--@Location 0,32-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode26">
<!--@BendPoints 1,66-->
    <nodeSuccessors name="next" next="Pipelet5"/>
  </nodes>
<!--@Location 0,33-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet5">
    <configurationValues name="DefaultHandlerPipeline" value="ViewPromotionCodeConfiguration-PagingPromotionCodeGroups"/>
    <configurationValues name="DefaultPageLocatorName" value="PromotionPromotionCodeGroups"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetPageLocator.xml"/>
<!--@BendPoints 1,68-->
    <nodeSuccessors name="next" next="EndNode4"/>
    <parameterBindings name="HandlerPipeline" nullBinding="true"/>
    <parameterBindings name="PageLocatorName" nullBinding="true"/>
    <parameterBindings name="Pageable" objectPath="PromotionCodeGroups"/>
  </nodes>
<!--@Location 0,34-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode4"/>
<!--@Location 21,20-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode7" strict="true" name="CreatePromotionCodeConfigurationRequiredForm"
      callMode="Private">
    <nodeSuccessors name="next" next="CreateForm2"/>
    <parameters name="Promotion" type="com.intershop.component.marketing.capi.rebate.Promotion"/>
  </nodes>
<!--@Location 21,21-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateForm2">
    <configurationValues name="FormName" value="PromotionCodeConfigurationRequired"/>
    <configurationValues name="FormResource" value="PromotionCodeConfigurationRequired"/>
    <pipelet href="enfinity:/core/pipelets/CreateForm.xml"/>
    <nodeSuccessors name="next" next="MapObjectToForm1"/>
    <returnValueBindings name="Form" objectPath="PromotionCodeConfigurationRequiredForm"/>
  </nodes>
<!--@Location 21,22-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="MapObjectToForm1">
    <configurationValues name="NameFilterList" value="CouponCodeRequired"/>
    <configurationValues name="NameFilterType" value="include"/>
    <pipelet href="enfinity:/core/pipelets/MapObjectToForm.xml"/>
    <nodeSuccessors name="next" next="EndNode10"/>
    <parameterBindings name="Form" objectPath="PromotionCodeConfigurationRequiredForm"/>
    <parameterBindings name="SourceObject" objectPath="Promotion"/>
  </nodes>
<!--@Location 21,23-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode10" strict="true">
    <returnValues name="PromotionCodeConfigurationRequiredForm" type="com.intershop.beehive.core.capi.webform.Form"
        optional="true"/>
  </nodes>
<!--@Location 0,2-->
  <nodes xsi:type="pipeline:StartNode" nodeID="Start3" name="Dispatch">
<!--@BendPoints 1,6-->
    <nodeSuccessors name="next" next="DispatchFormAction3"/>
  </nodes>
<!--@Location 0,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="DispatchFormAction3">
    <configurationValues name="OutValue_0" value="ViewPromotionCodeConfiguration-Edit"/>
    <configurationValues name="OutValue_1" value="ViewPromotionCodeConfiguration-Apply"/>
    <configurationValues name="OutValue_2" value="ViewPromotion-New"/>
    <configurationValues name="OutValue_3" value="ViewPromotion-New"/>
    <configurationValues name="OutValue_4" value="ViewPromotionTargetCodeGroupsSelection-ListAll"/>
    <configurationValues name="OutValue_5" value="ViewPromotionCodeConfiguration-PagingPromotionCodeGroups"/>
    <configurationValues name="OutValue_6" value="ViewPromotionCodeConfiguration-Remove"/>
    <configurationValues name="OutValue_7" value="ViewPromotionCodeConfiguration-UpdateCouponCodeRequired"/>
    <configurationValues name="OutValue_8" value="ViewPromotionCodeConfiguration-PagingPromotionCodeGroups"/>
    <configurationValues name="PagingPipeline" value="ViewPromotionCodeConfiguration-PagingPromotionCodeGroups"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/DispatchFormAction.xml"/>
    <nodeSuccessors name="next" next="JoinNode10"/>
<!--@BendPoints 3,7-->
    <nodeSuccessors name="pipelet_error" next="DispatchFormAction2"/>
    <parameterBindings name="Key_0" objectPath="edit"/>
    <parameterBindings name="Key_1" objectPath="apply"/>
    <parameterBindings name="Key_2" objectPath="cancel"/>
    <parameterBindings name="Key_3" objectPath="back"/>
    <parameterBindings name="Key_4" objectPath="addCodeGroup"/>
    <parameterBindings name="Key_5" objectPath="confirmRemoveCodeGroup"/>
    <parameterBindings name="Key_6" objectPath="removeCodeGroup"/>
    <parameterBindings name="Key_7" objectPath="updateCouponCodeRequired"/>
    <parameterBindings name="Key_8" objectPath="cancelRemoveCodeGroup"/>
    <returnValueBindings name="SelectionKey" objectPath="JumpTarget"/>
  </nodes>
<!--@Location 0,4-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode10">
    <nodeSuccessors name="next" next="JoinNode19"/>
  </nodes>
<!--@Location 0,6-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode19">
    <nodeSuccessors name="next" next="Jump7"/>
  </nodes>
<!--@Location 0,7-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="Jump7">
    <startNode referencedName="SecureJump-Start"/>
  </nodes>
<!--@Location 1,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="DispatchFormAction2">
    <configurationValues name="OutValue_0" value="ViewPromotionReplication-SelectTarget"/>
    <configurationValues name="OutValue_1" value="ViewPromotion-CopyDialog"/>
    <configurationValues name="OutValue_2" value="ViewPromotion-Edit"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/DispatchFormAction.xml"/>
    <nodeSuccessors name="next" next="JoinNode10"/>
    <nodeSuccessors name="pipelet_error" next="SetDictionaryValue6"/>
    <parameterBindings name="Key_0" objectPath="selectStagingTarget"/>
    <parameterBindings name="Key_1" objectPath="copyDialog"/>
    <parameterBindings name="Key_2" objectPath="confirmDelete"/>
    <returnValueBindings name="SelectionKey" objectPath="JumpTarget"/>
  </nodes>
<!--@Location 1,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetDictionaryValue6">
    <configurationValues name="Name" value="JumpTarget"/>
    <configurationValues name="Value" value="ViewPromotion-Edit"/>
    <configurationValues name="ValueType" value="Dictionary Value"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetDictionaryValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode19"/>
  </nodes>
<!--@Location 5,2-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode19" name="Edit">
    <nodeSuccessors name="next" next="JoinNode0"/>
  </nodes>
<!--@Location 5,3-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode0">
    <nodeSuccessors name="next" next="CallNode1"/>
  </nodes>
<!--@Location 5,4-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode1">
    <nodeSuccessors name="next" next="CallNode24"/>
    <startNode referencedName="ViewPromotionCodeConfiguration-Prefix"/>
  </nodes>
<!--@Location 5,5-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode24">
    <nodeSuccessors name="next" next="CreateForm6"/>
    <startNode referencedName="ViewPromotionCodeConfiguration-GetPageablePromotionCodeGroups"/>
  </nodes>
<!--@Location 5,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateForm6">
    <configurationValues name="FormName" value="PromotionCodeConfiguration"/>
    <configurationValues name="FormResource" value="PromotionCodeConfiguration"/>
    <pipelet href="enfinity:/core/pipelets/CreateForm.xml"/>
<!--@BendPoints 11,14-->
    <nodeSuccessors name="next" next="CallNode8"/>
    <returnValueBindings name="Form" objectPath="PromotionCodeForm"/>
  </nodes>
<!--@Location 5,7-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode8">
<!--@BendPoints 11,29-->
    <nodeSuccessors name="next" next="JoinNode2"/>
    <startNode referencedName="ViewPromotionCodeConfiguration-InitForm"/>
  </nodes>
<!--@Location 0,20-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode11" name="GetPageablePromotionCodeGroups"
      callMode="Private">
<!--@BendPoints 1,42-->
    <nodeSuccessors name="next" next="Call1"/>
  </nodes>
<!--@Location 0,21-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call1">
    <nodeSuccessors name="next" next="GetPageLocator1"/>
    <startNode referencedName="ProcessClipboard-Update"/>
  </nodes>
<!--@Location 0,22-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetPageLocator1">
    <configurationValues name="DefaultPageLocatorName" value="PromotionPromotionCodeGroups"/>
    <configurationValues name="RestorePageLocatorDictionary" value="False"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetPageLocator.xml"/>
    <nodeSuccessors name="next" next="GetPageable2"/>
<!--@BendPoints 3,45-->
    <nodeSuccessors name="pipelet_error" next="JoinNode21"/>
    <parameterBindings name="PageLocatorName" nullBinding="true"/>
  </nodes>
<!--@Location 0,23-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetPageable2">
    <pipelet href="enfinity:/bc_foundation/pipelets/GetPageable.xml"/>
    <nodeSuccessors name="next" next="DecisionNode12"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode21"/>
    <parameterBindings name="PageableID" objectPath="PageLocator:PageableID"/>
    <returnValueBindings name="Pageable" objectPath="PromotionCodeGroups"/>
  </nodes>
<!--@Location 0,25-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode12" conditionKey="PromotionCodeGroups"
      operator="has_elements">
    <nodeSuccessors name="decision_yes" next="DecisionNode0"/>
    <nodeSuccessors name="decision_no" next="JoinNode27"/>
  </nodes>
<!--@Location 0,29-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode0" conditionKey="PageNumber">
    <nodeSuccessors name="decision_yes" next="VerifyInteger2"/>
    <nodeSuccessors name="decision_no" next="SetPage6"/>
  </nodes>
<!--@Location 0,30-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="VerifyInteger2">
    <pipelet href="enfinity:/bc_foundation/pipelets/VerifyInteger.xml"/>
<!--@BendPoints 1,62-->
    <nodeSuccessors name="next" next="SetPage5"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode25"/>
    <parameterBindings name="Locale" nullBinding="true"/>
    <parameterBindings name="LocalizedString" objectPath="PageNumber"/>
    <parameterBindings name="Pattern" nullBinding="true"/>
    <returnValueBindings name="IntegerObject" objectPath="PageNumber"/>
  </nodes>
<!--@Location 0,31-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetPage5">
    <pipelet href="enfinity:/bc_foundation/pipelets/SetPage.xml"/>
    <nodeSuccessors name="next" next="JoinNode26"/>
    <parameterBindings name="Pageable" objectPath="PromotionCodeGroups"/>
  </nodes>
<!--@Location 1,23-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode21">
    <nodeSuccessors name="next" next="DecisionNode10"/>
  </nodes>
<!--@Location 2,23-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode10" conditionKey="PromotionCodeGroups">
<!--@BendPoints 5,55-->
    <nodeSuccessors name="decision_yes" next="JoinNode23"/>
    <nodeSuccessors name="decision_no" next="JoinNode24"/>
  </nodes>
<!--@Location 11,20-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode2" strict="true" name="InitForm"
      callMode="Private">
<!--@BendPoints 23,42-->
    <nodeSuccessors name="next" next="DecisionNode4"/>
    <parameters name="Promotion" type="com.intershop.component.marketing.capi.rebate.Promotion"/>
    <parameters name="PromotionCodeForm" type="com.intershop.beehive.core.capi.webform.Form"/>
  </nodes>
<!--@Location 11,21-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode4" conditionKey="Promotion:UseSingleCode"
      operator="str_eq" conditionValue="true">
<!--@BendPoints 23,44-->
    <nodeSuccessors name="decision_yes" next="SetFormParameterValue2"/>
<!--@BendPoints 27,43 27,46-->
    <nodeSuccessors name="decision_no" next="SetFormParameterValue1"/>
  </nodes>
<!--@Location 11,22-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue2">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
<!--@BendPoints 23,46-->
    <nodeSuccessors name="next" next="SetFormParameterValue3"/>
    <parameterBindings name="FormParameter" objectPath="PromotionCodeForm:UseSingleCode"/>
    <parameterBindings name="Value" constant="singleCode"/>
  </nodes>
<!--@Location 11,23-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue3">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
<!--@BendPoints 23,48-->
    <nodeSuccessors name="next" next="DecisionNode5"/>
    <parameterBindings name="FormParameter" objectPath="PromotionCodeForm:SingleCode"/>
    <parameterBindings name="Value" objectPath="Promotion:SingleCode"/>
  </nodes>
<!--@Location 11,24-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode5" conditionKey="Promotion:CodeCustomerUnlimited"
      operator="str_eq" conditionValue="true">
<!--@BendPoints 23,50-->
    <nodeSuccessors name="decision_yes" next="SetFormParameterValue4"/>
<!--@BendPoints 24,49 25,48-->
    <nodeSuccessors name="decision_no" next="SetFormParameterValue5"/>
  </nodes>
<!--@Location 11,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue4">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode13"/>
    <parameterBindings name="FormParameter" objectPath="PromotionCodeForm:TotalReusePerCustomerFlag"/>
    <parameterBindings name="Value" constant="(Integer)0"/>
  </nodes>
<!--@Location 11,26-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode13">
<!--@BendPoints 23,54-->
    <nodeSuccessors name="next" next="DecisionNode6"/>
  </nodes>
<!--The promotion code can be reused "unlimited" times. Actually it will be limited by the the maximum integer value: "2147483647"
@Location 11,27-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode6" conditionKey="Promotion:SingleCodeTotal"
      operator="eq" conditionValue="2147483647">
<!--@BendPoints 23,56-->
    <nodeSuccessors name="decision_yes" next="SetFormParameterValue6"/>
<!--@BendPoints 24,55 25,54-->
    <nodeSuccessors name="decision_no" next="SetFormParameterValue7"/>
  </nodes>
<!--@Location 11,28-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue6">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode14"/>
    <parameterBindings name="FormParameter" objectPath="PromotionCodeForm:TotalReusePerCodeFlag"/>
    <parameterBindings name="Value" constant="(Integer)0"/>
  </nodes>
<!--@Location 11,29-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode14">
<!--@BendPoints 23,60-->
    <nodeSuccessors name="next" next="EndNode6"/>
  </nodes>
<!--@Location 11,30-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode6" strict="true">
    <returnValues name="PromotionCodeForm" type="com.intershop.beehive.core.capi.webform.Form"/>
  </nodes>
<!--@Location 12,27-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue7">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
<!--@BendPoints 25,56-->
    <nodeSuccessors name="next" next="SetFormParameterValue8"/>
    <parameterBindings name="FormParameter" objectPath="PromotionCodeForm:TotalReusePerCodeFlag"/>
    <parameterBindings name="Value" constant="(Integer)1"/>
  </nodes>
<!--@Location 12,28-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue8">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode15"/>
    <parameterBindings name="FormParameter" objectPath="PromotionCodeForm:TotalReusePerCode"/>
    <parameterBindings name="Value" objectPath="Promotion:SingleCodeTotal"/>
  </nodes>
<!--@Location 12,29-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode15">
    <nodeSuccessors name="next" next="JoinNode14"/>
  </nodes>
<!--@Location 12,24-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue5">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
<!--@BendPoints 25,53-->
    <nodeSuccessors name="next" next="JoinNode13"/>
    <parameterBindings name="FormParameter" objectPath="PromotionCodeForm:TotalReusePerCustomerFlag"/>
    <parameterBindings name="Value" constant="(Integer)1"/>
  </nodes>
<!--@Location 13,23-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue1">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
<!--@BendPoints 27,59-->
    <nodeSuccessors name="next" next="JoinNode15"/>
    <parameterBindings name="FormParameter" objectPath="PromotionCodeForm:UseSingleCode"/>
    <parameterBindings name="Value" constant="codeGroup"/>
  </nodes>
<!--@Location 6,2-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode12" name="PagingPromotionCodeGroups">
<!--@BendPoints 13,7-->
    <nodeSuccessors name="next" next="JoinNode0"/>
  </nodes>
<!--@Location 3,2-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode3" strict="true" name="Prefix"
      callMode="Private">
    <nodeSuccessors name="next" next="GetPromotionByUUID1"/>
    <parameters name="CurrentChannel" type="java.lang.Object" optional="true"/>
    <parameters name="PromotionUUID" type="java.lang.String"/>
  </nodes>
<!--@Location 3,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetPromotionByUUID1">
    <pipelet href="enfinity:/bc_marketing/pipelets/GetPromotionByUUID.xml"/>
    <nodeSuccessors name="next" next="JoinNode5"/>
<!--@BendPoints 8,7 8,9-->
    <nodeSuccessors name="pipelet_error" next="JoinNode5"/>
  </nodes>
<!--@Location 3,4-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode5">
    <nodeSuccessors name="next" next="CallNode3"/>
  </nodes>
<!--@Location 3,5-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode3">
    <nodeSuccessors name="next" next="EndNode1"/>
    <parameterBindings name="Channel" objectPath="CurrentChannel"/>
    <startNode referencedName="ProcessPromotion-GetPromotionDomainByChannel"/>
  </nodes>
<!--@Location 3,6-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode1" strict="true">
<!--the domain a promotion will be assigned to-->
    <returnValues name="PromotionDomain" type="com.intershop.beehive.core.capi.domain.Domain"/>
    <returnValues name="Promotion" type="com.intershop.component.marketing.capi.rebate.Promotion"/>
  </nodes>
<!--@Location 10,2-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode9" name="Remove">
    <nodeSuccessors name="next" next="CallNode2"/>
  </nodes>
<!--@Location 10,3-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode2">
    <nodeSuccessors name="next" next="Call2"/>
    <startNode referencedName="ViewPromotionCodeConfiguration-Prefix"/>
  </nodes>
<!--@Location 10,4-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call2">
    <nodeSuccessors name="next" next="Loop2"/>
    <startNode referencedName="ProcessClipboard-Get"/>
  </nodes>
<!--@Location 10,5-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="Loop2" loop="UUIDIterator">
<!--@BendPoints 23,11 23,12-->
    <nodeSuccessors name="next" next="CallNode22"/>
    <entry key="PromotionCodeGroupID">
      <nodeSuccessors name="loop_entry_next" next="GetPromotionCodeGroupByID1"/>
    </entry>
  </nodes>
<!--@Location 10,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetPromotionCodeGroupByID1">
    <pipelet href="enfinity:/bc_marketing/pipelets/GetPromotionCodeGroupByID.xml"/>
    <nodeSuccessors name="next" next="CallNode21"/>
<!--@BendPoints 22,13 22,17-->
    <nodeSuccessors name="pipelet_error" next="JoinNode33"/>
    <parameterBindings name="GroupID" objectPath="PromotionCodeGroupID"/>
  </nodes>
<!--@Location 10,7-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode21">
    <nodeSuccessors name="next" next="JoinNode33"/>
    <startNode referencedName="ProcessPromotionCodeGroup-RemoveFromPromotion"/>
  </nodes>
<!--@Location 10,8-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode33">
<!--@BendPoints 20,17 20,11-->
    <nodeSuccessors name="next" next="Loop2_Entry"/>
  </nodes>
<!--@Location 11,6-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode22">
    <nodeSuccessors name="next" next="CallNode4"/>
    <parameterBindings name="Iterator" objectPath="UUIDIterator"/>
    <startNode referencedName="ProcessPromotion-TouchPromotion"/>
  </nodes>
<!--@Location 11,7-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode4">
    <nodeSuccessors name="next" next="InvalidatePageLocatorPageable0"/>
    <parameterBindings name="PromotionBORepository" objectPath="ApplicationBO:Repository(&quot;PromotionBORepository&quot;)"/>
    <parameterBindings name="Site" objectPath="ChannelRepository:RepositoryDomain:Site"/>
    <startNode referencedName="ViewPromotion-InvalidatePageCache"/>
  </nodes>
<!--@Location 11,8-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="InvalidatePageLocatorPageable0">
    <configurationValues name="DefaultPageLocatorName" value="PromotionPromotionCodeGroups"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/InvalidatePageLocatorPageable.xml"/>
    <nodeSuccessors name="next" next="InvalidatePageLocatorPageable1"/>
    <parameterBindings name="PageLocatorName" nullBinding="true"/>
  </nodes>
<!--@Location 11,9-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="InvalidatePageLocatorPageable1">
    <configurationValues name="DefaultPageLocatorName" value="PromotionCodeGroupPromotions"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/InvalidatePageLocatorPageable.xml"/>
    <nodeSuccessors name="next" next="Jump3"/>
  </nodes>
<!--@Location 11,10-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="Jump3">
    <startNode referencedName="ViewPromotionCodeConfiguration-Edit"/>
  </nodes>
<!--@Location 15,20-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode5" strict="true" name="RemoveAllCodeGroupsFromPromotion"
      callMode="Private">
<!--@BendPoints 31,42-->
    <nodeSuccessors name="next" next="CallNode10"/>
    <parameters name="Promotion" type="com.intershop.component.marketing.capi.rebate.Promotion"/>
    <parameters name="PromotionDomain" type="com.intershop.beehive.core.capi.domain.Domain"/>
  </nodes>
<!--@Location 15,21-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode10">
    <nodeSuccessors name="next" next="CallNode12"/>
    <startNode referencedName="ProcessPromotion-RemovePromotionCodeGroupAssignment"/>
  </nodes>
<!--@Location 15,23-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode12">
    <nodeSuccessors name="next" next="EndNode7"/>
    <startNode referencedName="ViewPromotionCodeConfiguration-CreatePageablePromotionCodeGroups"/>
  </nodes>
<!--@Location 15,24-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode7" strict="true"/>
<!--@Location 14,2-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode6" name="UpdateCouponCodeRequired">
<!--@BendPoints 29,6-->
    <nodeSuccessors name="next" next="CallNode15"/>
  </nodes>
<!--@Location 14,3-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode15">
<!--@BendPoints 29,8-->
    <nodeSuccessors name="next" next="CreateForm1"/>
    <startNode referencedName="ViewPromotionCodeConfiguration-Prefix"/>
  </nodes>
<!--@Location 14,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateForm1">
    <configurationValues name="FormName" value="PromotionCodeConfigurationRequired"/>
    <configurationValues name="FormResource" value="PromotionCodeConfigurationRequired"/>
    <pipelet href="enfinity:/core/pipelets/CreateForm.xml"/>
<!--@BendPoints 29,10-->
    <nodeSuccessors name="next" next="ValidateForm1"/>
    <returnValueBindings name="Form" objectPath="PromotionCodeConfigurationRequiredForm"/>
  </nodes>
<!--@Location 14,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ValidateForm1">
    <pipelet href="enfinity:/core/pipelets/ValidateForm.xml"/>
    <nodeSuccessors name="next" next="JoinNode17"/>
<!--@BendPoints 30,11 30,13-->
    <nodeSuccessors name="pipelet_error" next="JoinNode17"/>
    <parameterBindings name="Form" objectPath="PromotionCodeConfigurationRequiredForm"/>
  </nodes>
<!--@Location 14,6-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode17">
<!--@BendPoints 29,14-->
    <nodeSuccessors name="next" next="MapFormToObject1"/>
  </nodes>
<!--@Location 14,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="MapFormToObject1">
    <configurationValues name="NameFilterList" value="CouponCodeRequired"/>
    <configurationValues name="NameFilterType" value="include"/>
    <pipelet href="enfinity:/core/pipelets/MapFormToObject.xml"/>
<!--@BendPoints 29,16-->
    <nodeSuccessors name="next" next="DecisionNode9"/>
    <parameterBindings name="Form" objectPath="PromotionCodeConfigurationRequiredForm"/>
    <parameterBindings name="TargetObject" objectPath="Promotion"/>
  </nodes>
<!--@Location 14,8-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode9" conditionKey="Promotion:CouponCodeRequired"
      operator="str_eq" conditionValue="false">
<!--@BendPoints 29,18-->
    <nodeSuccessors name="decision_yes" next="CallNode14"/>
<!--@BendPoints 31,17 31,25-->
    <nodeSuccessors name="decision_no" next="JoinNode18"/>
  </nodes>
<!--@Location 14,9-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode14">
<!--@BendPoints 29,20-->
    <nodeSuccessors name="next" next="UpdatePromotionCodeConfiguration3"/>
    <startNode referencedName="ProcessPromotion-RemovePromotionCodeGroupAssignment"/>
  </nodes>
<!--@Location 14,10-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdatePromotionCodeConfiguration3">
    <pipelet href="enfinity:/bc_marketing/pipelets/UpdatePromotionCodeConfiguration.xml"/>
    <nodeSuccessors name="next" next="InvalidatePageLocatorPageable2"/>
    <parameterBindings name="SingleCode" nullBinding="true"/>
    <parameterBindings name="SingleCodeCustomerUnlimited" nullBinding="true"/>
    <parameterBindings name="SingleCodeTotal" nullBinding="true"/>
    <parameterBindings name="UseSingleCode" constant="(Boolean)false"/>
  </nodes>
<!--@Location 14,11-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="InvalidatePageLocatorPageable2">
    <configurationValues name="DefaultPageLocatorName" value="PromotionPromotionCodeGroups"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/InvalidatePageLocatorPageable.xml"/>
    <nodeSuccessors name="next" next="JoinNode18"/>
  </nodes>
<!--@Location 14,12-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode18">
    <nodeSuccessors name="next" next="CallNode33"/>
  </nodes>
<!--@Location 14,13-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode33">
    <nodeSuccessors name="next" next="CallNode25"/>
    <parameterBindings name="Iterator" nullBinding="true"/>
    <startNode referencedName="ProcessPromotion-TouchPromotion"/>
  </nodes>
<!--@Location 14,14-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode25">
    <nodeSuccessors name="next" next="JumpNode1"/>
    <parameterBindings name="PromotionBORepository" objectPath="ApplicationBO:Repository(&quot;PromotionBORepository&quot;)"/>
    <parameterBindings name="Site" objectPath="ChannelRepository:RepositoryDomain:Site"/>
    <startNode referencedName="ViewPromotion-InvalidatePageCache"/>
  </nodes>
<!--@Location 14,15-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode1">
    <startNode referencedName="ViewPromotionCodeConfiguration-Edit"/>
  </nodes>
<!--Retrieves all input values and prepares the configuration for the promotion code.
@Location 5,20-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode1" strict="true" name="Verify"
      callMode="Private">
<!--@BendPoints 11,42 10,43-->
    <nodeSuccessors name="next" next="DecisionNode1"/>
    <parameters name="UseSingleCode" type="java.lang.String"/>
    <parameters name="SingleCode" type="java.lang.String"/>
    <parameters name="TotalReusePerCodeFlag" type="java.lang.Integer"/>
    <parameters name="TotalReusePerCode" type="java.lang.Integer" optional="true"/>
    <parameters name="TotalReusePerCustomerFlag" type="java.lang.Integer"/>
    <parameters name="PromotionCodeForm" type="com.intershop.beehive.core.capi.webform.ValidationElement"/>
  </nodes>
<!--@Location 5,21-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode1" conditionKey="UseSingleCode"
      operator="str_eq" conditionValue="singleCode">
<!--@BendPoints 12,43 13,42-->
    <nodeSuccessors name="decision_yes" next="VerifyBoolean1"/>
<!--@BendPoints 11,50-->
    <nodeSuccessors name="decision_no" next="VerifyBoolean2"/>
  </nodes>
<!--@Location 6,21-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="VerifyBoolean1">
    <pipelet href="enfinity:/bc_foundation/pipelets/VerifyBoolean.xml"/>
    <nodeSuccessors name="next" next="TrimString1"/>
<!--@BendPoints 19,43-->
    <nodeSuccessors name="pipelet_error" next="JoinNode6"/>
    <parameterBindings name="NoneLocalizedString" constant="true"/>
    <returnValueBindings name="BooleanValue" objectPath="UseSingleCode"/>
  </nodes>
<!--@Location 6,22-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="TrimString1">
    <pipelet href="enfinity:/bc_foundation/pipelets/TrimString.xml"/>
<!--@BendPoints 13,46 12,47-->
    <nodeSuccessors name="next" next="DecisionNode8"/>
    <parameterBindings name="String" objectPath="SingleCode"/>
    <returnValueBindings name="TrimmedString" objectPath="SingleCode"/>
  </nodes>
<!--@Location 6,23-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode8" conditionKey="SingleCode"
      operator="str_empty">
    <nodeSuccessors name="decision_yes" next="JoinNode6"/>
<!--@BendPoints 13,52 12,53-->
    <nodeSuccessors name="decision_no" next="DecisionNode2"/>
  </nodes>
<!--@Location 9,23-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode6">
<!--@BendPoints 19,48-->
    <nodeSuccessors name="next" next="SetFormError1"/>
  </nodes>
<!--@Location 9,24-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormError1">
    <pipelet href="enfinity:/core/pipelets/SetFormError.xml"/>
    <nodeSuccessors name="next" next="JoinNode12"/>
    <parameterBindings name="ErrorMsg" constant="error.empty"/>
    <parameterBindings name="TargetObject" objectPath="PromotionCodeForm:SingleCode"/>
  </nodes>
<!--@Location 9,25-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode12">
    <nodeSuccessors name="next" next="JoinNode7"/>
  </nodes>
<!--@Location 9,27-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode7">
    <nodeSuccessors name="next" next="JoinNode4"/>
  </nodes>
<!--@Location 9,29-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode4">
    <nodeSuccessors name="next" next="JoinNode9"/>
  </nodes>
<!--@Location 9,31-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode9">
    <nodeSuccessors name="next" next="EndNode5"/>
  </nodes>
<!--@Location 9,33-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode5" name="Error" strict="true">
    <returnValues name="PromotionCodeForm" type="com.intershop.beehive.core.capi.webform.Form"/>
  </nodes>
<!--@Location 6,26-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode2" conditionKey="TotalReusePerCustomerFlag"
      operator="eq" conditionValue="0">
<!--@BendPoints 14,53-->
    <nodeSuccessors name="decision_yes" next="VerifyBoolean3"/>
<!--@BendPoints 13,54-->
    <nodeSuccessors name="decision_no" next="VerifyBoolean4"/>
  </nodes>
<!--@Location 7,26-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="VerifyBoolean3">
    <pipelet href="enfinity:/bc_foundation/pipelets/VerifyBoolean.xml"/>
<!--@BendPoints 16,53 16,57-->
    <nodeSuccessors name="next" next="JoinNode8"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode7"/>
    <parameterBindings name="NoneLocalizedString" constant="true"/>
    <returnValueBindings name="BooleanValue" objectPath="SingleCodeCustomerUnlimited"/>
  </nodes>
<!--@Location 6,28-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode8">
<!--@BendPoints 13,58-->
    <nodeSuccessors name="next" next="DecisionNode3"/>
  </nodes>
<!--@Location 6,29-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode3" conditionKey="TotalReusePerCodeFlag"
      operator="eq" conditionValue="0">
    <nodeSuccessors name="decision_yes" next="VerifyInteger1"/>
<!--@BendPoints 14,59 15,58-->
    <nodeSuccessors name="decision_no" next="DecisionNode7"/>
  </nodes>
<!--The promotion code can be reused "unlimited" times. Actually it will be limited by the the maximum integer value: "2147483647"
@Location 6,31-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="VerifyInteger1">
    <configurationValues name="isOptional" value="false"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/VerifyInteger.xml"/>
    <nodeSuccessors name="next" next="JoinNode11"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode9"/>
    <parameterBindings name="LocalizedString" constant="2147483647"/>
    <returnValueBindings name="IntegerObject" objectPath="SingleCodeTotal"/>
  </nodes>
<!--@Location 6,32-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode11">
    <nodeSuccessors name="next" next="EndNode2"/>
  </nodes>
<!--@Location 6,33-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode2" name="YesSingleCode" strict="true">
    <returnValues name="UseSingleCode" type="java.lang.Boolean"/>
    <returnValues name="SingleCode" type="java.lang.String"/>
    <returnValues name="SingleCodeTotal" type="java.lang.Integer"/>
    <returnValues name="SingleCodeCustomerUnlimited" type="java.lang.Boolean"/>
  </nodes>
<!--@Location 7,29-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode7" conditionKey="TotalReusePerCode">
<!--@BendPoints 15,60-->
    <nodeSuccessors name="decision_yes" next="KeyMapper1"/>
<!--@BendPoints 16,59-->
    <nodeSuccessors name="decision_no" next="SetFormError3"/>
  </nodes>
<!--@Location 7,30-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper1">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
<!--@BendPoints 15,65-->
    <nodeSuccessors name="next" next="JoinNode11"/>
    <parameterBindings name="InValue_1" objectPath="TotalReusePerCode"/>
    <returnValueBindings name="OutValue_1" objectPath="SingleCodeTotal"/>
  </nodes>
<!--@Location 8,29-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormError3">
    <pipelet href="enfinity:/core/pipelets/SetFormError.xml"/>
    <nodeSuccessors name="next" next="JoinNode4"/>
    <parameterBindings name="ErrorMsg" constant="error.empty"/>
    <parameterBindings name="TargetObject" objectPath="PromotionCodeForm:TotalReusePerCode"/>
  </nodes>
<!--@Location 6,27-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="VerifyBoolean4">
    <pipelet href="enfinity:/bc_foundation/pipelets/VerifyBoolean.xml"/>
    <nodeSuccessors name="next" next="JoinNode8"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode7"/>
    <parameterBindings name="NoneLocalizedString" constant="false"/>
    <returnValueBindings name="BooleanValue" objectPath="SingleCodeCustomerUnlimited"/>
  </nodes>
<!--@Location 5,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="VerifyBoolean2">
    <pipelet href="enfinity:/bc_foundation/pipelets/VerifyBoolean.xml"/>
<!--@BendPoints 11,66-->
    <nodeSuccessors name="next" next="EndNode3"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode12"/>
    <parameterBindings name="NoneLocalizedString" constant="false"/>
    <returnValueBindings name="BooleanValue" objectPath="UseSingleCode"/>
  </nodes>
<!--@Location 5,33-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode3" name="NoSingleCode" strict="true">
    <returnValues name="UseSingleCode" type="java.lang.Boolean"/>
  </nodes>
</pipeline:Pipeline>
