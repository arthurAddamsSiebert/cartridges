<?xml version="1.0" encoding="UTF-8"?>
<!--@Group OnlineMarketing-->

<pipeline:Pipeline xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:pipeline="http://www.intershop.de/pipeline/2010"
    name="ViewPromotion" type="view">
<!--@Location 2,33-->
  <nodes xsi:type="pipeline:Text" nodeID="Text0"/>
<!--copied and adapted from 
update pipeline (to avoid one extra 
transmittion which would lead to
update auditing messages)
IS\-5530
@Location 22,9-->
  <nodes xsi:type="pipeline:Text" nodeID="Text1"/>
<!--for changes to update pipeline\-branch
please note that update code
is also used in copy pipeline

@Location 7,0-->
  <nodes xsi:type="pipeline:Text" nodeID="Text2"/>
<!--@Location 21,24-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode15" name="AddOrRemoveCombinationTypes"
      callMode="Private">
<!--@BendPoints 43,50-->
    <nodeSuccessors name="next" next="CreateForm1"/>
  </nodes>
<!--@Location 21,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateForm1">
    <configurationValues name="FormName" value="GeneralPromotionInformation"/>
    <configurationValues name="FormResource" value="GeneralPromotionInformation"/>
    <pipelet href="enfinity:/core/pipelets/CreateForm.xml"/>
    <nodeSuccessors name="next" next="FillForm1"/>
    <returnValueBindings name="Form" objectPath="PromotionForm"/>
  </nodes>
<!--@Location 21,26-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="FillForm1">
    <pipelet href="enfinity:/core/pipelets/FillForm.xml"/>
    <nodeSuccessors name="next" next="DecisionNode7"/>
    <parameterBindings name="Form" objectPath="PromotionForm"/>
  </nodes>
<!--@Location 21,27-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode7" conditionKey="PromotionForm:Combinable:Value"
      operator="str_eq" conditionValue="combinable_with_types">
    <nodeSuccessors name="decision_yes" next="DecisionNode20"/>
<!--@BendPoints 45,55 45,56-->
    <nodeSuccessors name="decision_no" next="CallNode12"/>
  </nodes>
<!--@Location 21,28-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode20" conditionKey="addCombinationType">
    <nodeSuccessors name="decision_yes" next="UpdateAssignmentLists3"/>
<!--@BendPoints 44,57 43,60-->
    <nodeSuccessors name="decision_no" next="DecisionNode13"/>
  </nodes>
<!--@Location 21,29-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateAssignmentLists3">
    <configurationValues name="ComparatorClassName" value="com.intershop.component.marketing.internal.promotion.action.ActionByNameComparator"/>
    <configurationValues name="Sorting" value="true"/>
    <configurationValues name="UpdateMode" value="Add"/>
    <pipelet href="enfinity:/core/pipelets/UpdateAssignmentLists.xml"/>
    <nodeSuccessors name="next" next="DecisionNode13"/>
    <parameterBindings name="AssignedValuesParameter" objectPath="PromotionForm:AssignedCombinationTypes:QualifiedName"/>
    <parameterBindings name="AvailableValuesParameter" constant="AvailableCombinationTypes"/>
    <parameterBindings name="ValuesToAddParameter" constant="CombinationTypesToAdd"/>
    <parameterBindings name="ValuesToRemoveParameter" constant="CombinationTypesToRemove"/>
    <returnValueBindings name="AssignedValues" objectPath="AssignedCombinationTypes"/>
    <returnValueBindings name="AvailableValues" objectPath="AvailableCombinationTypes"/>
  </nodes>
<!--@Location 21,30-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode13" conditionKey="removeCombinationType">
    <nodeSuccessors name="decision_yes" next="UpdateAssignmentLists4"/>
<!--@BendPoints 44,61 43,64-->
    <nodeSuccessors name="decision_no" next="SetFormParameterValue3"/>
  </nodes>
<!--@Location 21,31-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateAssignmentLists4">
    <configurationValues name="ComparatorClassName" value="com.intershop.component.marketing.internal.promotion.action.ActionByNameComparator"/>
    <configurationValues name="Sorting" value="true"/>
    <configurationValues name="UpdateMode" value="Remove"/>
    <pipelet href="enfinity:/core/pipelets/UpdateAssignmentLists.xml"/>
    <nodeSuccessors name="next" next="SetFormParameterValue3"/>
    <parameterBindings name="AssignedValuesParameter" objectPath="PromotionForm:AssignedCombinationTypes:QualifiedName"/>
    <parameterBindings name="AvailableValuesParameter" constant="AvailableCombinationTypes"/>
    <parameterBindings name="ValuesToAddParameter" constant="CombinationTypesToAdd"/>
    <parameterBindings name="ValuesToRemoveParameter" constant="CombinationTypesToRemove"/>
    <returnValueBindings name="AssignedValues" objectPath="AssignedCombinationTypes"/>
    <returnValueBindings name="AvailableValues" objectPath="AvailableCombinationTypes"/>
  </nodes>
<!--@Location 21,32-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue3">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
    <nodeSuccessors name="next" next="GetActionApplicationContext1"/>
    <parameterBindings name="FormParameter" objectPath="PromotionForm:AssignedCombinationTypes"/>
    <parameterBindings name="Value" objectPath="AssignedCombinationTypes"/>
  </nodes>
<!--@Location 21,33-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetActionApplicationContext1">
    <pipelet href="enfinity:/bc_foundation/pipelets/GetActionApplicationContext.xml"/>
    <nodeSuccessors name="next" next="DeterminePromotionCombinable2"/>
    <parameterBindings name="ActionDescriptorRegistryName" constant="promotionActionDescriptorRegistry"/>
    <parameterBindings name="ActionRepositoryName" constant="promotionActionRepository"/>
    <parameterBindings name="SiteName" objectPath="SiteDomain:DomainName"/>
  </nodes>
<!--@Location 21,34-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="DeterminePromotionCombinable2">
    <pipelet href="enfinity:/bc_marketing/pipelets/DeterminePromotionCombinable.xml"/>
<!--@BendPoints 43,70-->
    <nodeSuccessors name="next" next="EndNode8"/>
    <returnValueBindings name="AssignedCombinationTypes" nullBinding="true"/>
    <returnValueBindings name="AvailableCombinationTypes" nullBinding="true"/>
    <returnValueBindings name="Combinable" nullBinding="true"/>
    <returnValueBindings name="MultipleAllowed" nullBinding="true"/>
  </nodes>
<!--@Location 21,35-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode8"/>
<!--@Location 22,28-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode12">
<!--@BendPoints 45,64 43,64-->
    <nodeSuccessors name="next" next="SetFormParameterValue3"/>
    <startNode referencedName="ProcessPromotion-GetCominationTypes"/>
  </nodes>
<!--@Location 27,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode18" name="AssignCombinationTypes">
<!--@BendPoints 55,2-->
    <nodeSuccessors name="next" next="Call14"/>
  </nodes>
<!--@Location 27,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call14">
    <nodeSuccessors name="next" next="CallNode53"/>
    <startNode referencedName="This:Prefix"/>
  </nodes>
<!--@Location 27,2-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode53">
    <nodeSuccessors name="next" next="CallNode54"/>
    <parameterBindings name="Channel" objectPath="CurrentChannel"/>
    <startNode referencedName="ProcessPromotion-GetPromotionDomainByChannel"/>
  </nodes>
<!--@Location 27,3-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode54">
    <nodeSuccessors name="next" next="DecisionNode19"/>
    <startNode referencedName="This:AddOrRemoveCombinationTypes"/>
  </nodes>
<!--@Location 27,4-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode19" conditionKey="Promotion">
    <nodeSuccessors name="decision_yes" next="CallNode55"/>
<!--@BendPoints 57,9 57,10-->
    <nodeSuccessors name="decision_no" next="Pipelet4"/>
  </nodes>
<!--@Location 27,5-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode55">
    <nodeSuccessors name="next" next="SetFormParameterValue8"/>
    <parameterBindings name="NonStrictPeriodMatching" constant="(Boolean)true"/>
    <startNode referencedName="ProcessPromotionBudget-CalculateRemainingBudget"/>
  </nodes>
<!--@Location 27,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue8">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
    <nodeSuccessors name="next" next="SetFormParameterValue16"/>
    <parameterBindings name="FormParameter" objectPath="PromotionForm:Rank"/>
    <parameterBindings name="Value" objectPath="Promotion:Rank"/>
  </nodes>
<!--write budget amount to dict
@Location 27,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue16">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode29"/>
    <parameterBindings name="FormParameter" objectPath="PromotionForm:BudgetAmount"/>
    <parameterBindings name="Value" objectPath="BudgetAmount"/>
  </nodes>
<!--@Location 27,8-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode29">
    <nodeSuccessors name="next" next="Call15"/>
  </nodes>
<!--@Location 27,9-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call15">
    <nodeSuccessors name="next" next="CallNode57"/>
    <startNode referencedName="This:GetLocales"/>
  </nodes>
<!--@Location 27,10-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode57">
    <nodeSuccessors name="next" next="CallNode56"/>
    <startNode referencedName="ViewPromotion-ValidateAppAssignmentForm"/>
  </nodes>
<!--@Location 27,11-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode56">
    <nodeSuccessors name="next" next="GetFormSelection2"/>
    <parameterBindings name="Domain" objectPath="PromotionDomain"/>
    <parameterBindings name="Locale" objectPath="SelectedLocale"/>
    <parameterBindings name="SortBy" constant="displayName"/>
    <startNode referencedName="ProcessPromotionBudget-GetBudgetSources"/>
  </nodes>
<!--@Location 27,12-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetFormSelection2">
    <pipelet href="enfinity:/bc_foundation/pipelets/GetFormSelection.xml"/>
    <nodeSuccessors name="next" next="PrepareApplicationView6"/>
    <parameterBindings name="ParameterName" constant="CombinationTypesToAdd"/>
    <returnValueBindings name="Selection" objectPath="CombinationTypesToAddSelection"/>
  </nodes>
<!--@Location 27,13-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="PrepareApplicationView6">
    <configurationValues name="SelectedMenuItem" value="OnlineMarketing"/>
    <configurationValues name="WorkingTemplate" value="marketing/Promotion"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/PrepareApplicationView.xml"/>
<!--@BendPoints 55,28-->
    <nodeSuccessors name="next" next="InteractionEnd6"/>
    <parameterBindings name="WorkingTemplateSuffix" objectPath="CurrentChannel:TypeCode"/>
  </nodes>
<!--@Location 27,14-->
  <nodes xsi:type="pipeline:InteractionNode" nodeID="InteractionEnd6">
    <template referencedName="application/ApplicationFrame"/>
  </nodes>
<!--@Location 28,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet4">
    <configurationValues name="Method" value="Active Currencies"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetCurrencies.xml"/>
    <nodeSuccessors name="next" next="SetFormParameterValue15"/>
    <parameterBindings name="Domain" objectPath="PromotionDomain"/>
  </nodes>
<!--write budget from form
@Location 28,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue15">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode29"/>
    <parameterBindings name="FormParameter" objectPath="PromotionForm:BudgetAmount"/>
    <parameterBindings name="Value" objectPath="GeneralPromotionInformation_BudgetAmount_Amount"/>
  </nodes>
<!--@Location 33,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode26" name="AssignToCampaign">
    <nodeSuccessors name="next" next="CallNode21"/>
  </nodes>
<!--@Location 33,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode21">
    <nodeSuccessors name="next" next="JumpNode7"/>
    <startNode referencedName="ProcessPromotionCampaignAssignments-AssignPromotionToCampaign"/>
  </nodes>
<!--@Location 33,2-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode7">
    <startNode referencedName="This:Edit"/>
  </nodes>
<!--@Location 21,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode11" name="Copy">
<!--@BendPoints 43,2-->
    <nodeSuccessors name="next" next="Call8"/>
  </nodes>
<!--@Location 21,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call8">
<!--@BendPoints 43,4-->
    <nodeSuccessors name="next" next="CreateForm7"/>
    <startNode referencedName="This:Prefix"/>
  </nodes>
<!--@Location 21,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateForm7">
    <configurationValues name="FormName" value="GeneralPromotionInformation"/>
    <configurationValues name="FormResource" value="GeneralPromotionInformation"/>
    <pipelet href="enfinity:/core/pipelets/CreateForm.xml"/>
    <nodeSuccessors name="next" next="ValidateForm3"/>
    <returnValueBindings name="Form" objectPath="PromotionForm"/>
  </nodes>
<!--@Location 21,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ValidateForm3">
    <pipelet href="enfinity:/core/pipelets/ValidateForm.xml"/>
<!--@BendPoints 43,8-->
    <nodeSuccessors name="next" next="CallNode23" action="begin"/>
<!--@BendPoints 45,7-->
    <nodeSuccessors name="pipelet_error" next="JoinNode17"/>
    <parameterBindings name="Form" objectPath="PromotionForm"/>
  </nodes>
<!--@Location 21,4-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode23">
    <nodeSuccessors name="next" next="KeyMapper13"/>
    <nodeSuccessors name="error" next="JoinNode17" action="rollback"/>
    <parameterBindings name="SourcePromotion" objectPath="Promotion"/>
    <startNode referencedName="ProcessPromotion-CopyPromotion"/>
  </nodes>
<!--@Location 21,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper13">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="SetFormParameterValue0"/>
    <parameterBindings name="InValue_1" objectPath="TargetPromotion"/>
    <returnValueBindings name="OutValue_1" objectPath="Promotion"/>
  </nodes>
<!--Update enabled flag, see IS\-239
@Location 21,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue0">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
    <nodeSuccessors name="next" next="SetDictionaryValue0"/>
    <parameterBindings name="FormParameter" objectPath="PromotionForm:Enabled"/>
    <parameterBindings name="Value" constant="(Boolean)false"/>
  </nodes>
<!--Update enabled flag, see IS\-239
@Location 21,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetDictionaryValue0">
    <configurationValues name="Name" value="GeneralPromotionInformation_Enabled"/>
    <configurationValues name="Value" value="false"/>
    <configurationValues name="ValueType" value="Form Value"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetDictionaryValue.xml"/>
    <nodeSuccessors name="next" next="InvalidatePageLocatorPageable4"/>
  </nodes>
<!--@Location 21,8-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="InvalidatePageLocatorPageable4">
    <configurationValues name="DefaultPageLocatorName" value="PromotionList"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/InvalidatePageLocatorPageable.xml"/>
    <nodeSuccessors name="next" next="CallNode39"/>
  </nodes>
<!--@Location 21,9-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode39">
<!--@BendPoints 43,20-->
    <nodeSuccessors name="next" next="CallNode43"/>
    <parameterBindings name="LocaleId" objectPath="LocaleID"/>
    <parameterBindings name="PromotionActionPriorityHandler" objectPath="ApplicationBO:Repository(&quot;PromotionBORepository&quot;):PromotionActionPriorityHandler"/>
    <startNode referencedName="ProcessPromotion-UpdatePromotion"/>
  </nodes>
<!--@Location 21,10-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode43">
    <nodeSuccessors name="next" next="CallNode14" action="commit"/>
    <nodeSuccessors name="ERROR" next="JoinNode30"/>
    <parameterBindings name="AccountTypeCode" constant="80"/>
    <parameterBindings name="BudgetAmount" objectPath="PromotionForm:BudgetAmount:Value"/>
    <parameterBindings name="BudgetNotificationEmail" objectPath="PromotionForm:BudgetNotificationEmail:Value"/>
    <parameterBindings name="BudgetNotificationThreshold" objectPath="PromotionForm:BudgetNotificationThreshold:Value"/>
    <parameterBindings name="BudgetSource" objectPath="PromotionForm:BudgetSource:Value"/>
    <parameterBindings name="BudgetTypeCode" constant="1"/>
    <parameterBindings name="DisableByBudget" objectPath="PromotionForm:DisableByBudget:Value"/>
    <parameterBindings name="EndDate" objectPath="PromotionForm:EndDate:Value"/>
    <parameterBindings name="Locale" objectPath="SelectedLocale"/>
    <parameterBindings name="Scope" nullBinding="true"/>
    <parameterBindings name="ScopeType" nullBinding="true"/>
    <parameterBindings name="SendMailIfBudgetReached" objectPath="PromotionForm:SendMailIfBudgetReached:Value"/>
    <parameterBindings name="SendMailIfThresholdReached" objectPath="PromotionForm:SendMailIfThresholdReached:Value"/>
    <parameterBindings name="StartDate" objectPath="PromotionForm:StartDate:Value"/>
    <parameterBindings name="Unlimited" objectPath="PromotionForm:Unlimited:Value"/>
    <startNode referencedName="ProcessPromotionBudget-SetBudget"/>
  </nodes>
<!--@Location 21,11-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode14">
    <nodeSuccessors name="next" next="CallNode41"/>
    <parameterBindings name="Repository" objectPath="ChannelRepository"/>
    <startNode referencedName="ProcessPromotion-UpdateAssignments"/>
  </nodes>
<!--@Location 21,12-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode41">
    <nodeSuccessors name="next" next="CallNode47"/>
    <parameterBindings name="Iterator" nullBinding="true"/>
    <startNode referencedName="ProcessPromotion-TouchPromotion"/>
  </nodes>
<!--@Location 21,13-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode47">
    <nodeSuccessors name="next" next="CallNode42"/>
    <parameterBindings name="PromotionBORepository" objectPath="ApplicationBO:Repository(&quot;PromotionBORepository&quot;)"/>
    <parameterBindings name="Site" objectPath="ChannelRepository:RepositoryDomain:Site"/>
    <startNode referencedName="This:InvalidatePageCache"/>
  </nodes>
<!--@Location 21,14-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode42">
    <nodeSuccessors name="next" next="GetFormSelection3"/>
    <startNode referencedName="ViewPromotion-UpdateAppAssignments"/>
  </nodes>
<!--@Location 21,15-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetFormSelection3">
    <pipelet href="enfinity:/bc_foundation/pipelets/GetFormSelection.xml"/>
    <nodeSuccessors name="next" next="JumpNode13"/>
    <parameterBindings name="ParameterName" constant="CombinationTypesToAdd"/>
    <returnValueBindings name="Selection" objectPath="CombinationTypesToAddSelection"/>
  </nodes>
<!--@Location 21,16-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode13">
    <startNode referencedName="This:Edit"/>
  </nodes>
<!--@Location 22,10-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode30">
    <nodeSuccessors name="next" next="JumpNode3"/>
  </nodes>
<!--@Location 22,15-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode3">
    <startNode referencedName="This:CopyDialog"/>
  </nodes>
<!--@Location 22,4-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode17">
    <nodeSuccessors name="next" next="JoinNode30"/>
  </nodes>
<!--@Location 19,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode8" name="CopyDialog">
<!--@BendPoints 39,2-->
    <nodeSuccessors name="next" next="Call7"/>
  </nodes>
<!--@Location 19,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call7">
    <nodeSuccessors name="next" next="DecisionNode17"/>
    <startNode referencedName="This:Prefix"/>
  </nodes>
<!--@Location 19,2-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode17" conditionKey="SelectedObjectUUID">
    <nodeSuccessors name="decision_yes" next="GetPromotionByUUID2"/>
<!--@BendPoints 41,5-->
    <nodeSuccessors name="decision_no" next="JoinNode16"/>
  </nodes>
<!--@Location 19,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetPromotionByUUID2">
    <pipelet href="enfinity:/bc_marketing/pipelets/GetPromotionByUUID.xml"/>
<!--@BendPoints 39,8-->
    <nodeSuccessors name="next" next="CallNode26"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode16"/>
    <parameterBindings name="PromotionUUID" objectPath="SelectedObjectUUID"/>
  </nodes>
<!--@Location 19,4-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode26">
<!--@BendPoints 39,10-->
    <nodeSuccessors name="next" next="DecisionNode5"/>
    <startNode referencedName="ViewPromotion-SetAppAssignmentInPromotionAppAssignmentForm"/>
  </nodes>
<!--@Location 19,5-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode5" conditionKey="PromotionForm"
      operator="undef">
    <nodeSuccessors name="decision_yes" next="CallNode20"/>
<!--@BendPoints 40,11 40,20-->
    <nodeSuccessors name="decision_no" next="Call2"/>
  </nodes>
<!--@Location 19,6-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode20">
    <nodeSuccessors name="next" next="CreateUUID2"/>
    <startNode referencedName="ViewPromotion-InitPromotionFormData"/>
  </nodes>
<!--@Location 19,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateUUID2">
    <pipelet href="enfinity:/bc_foundation/pipelets/CreateUUID.xml"/>
    <nodeSuccessors name="next" next="SetFormParameterValue7"/>
    <returnValueBindings name="UUID" objectPath="DefaultID"/>
  </nodes>
<!--@Location 19,8-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue7">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
    <nodeSuccessors name="next" next="SetFormParameterValue14"/>
    <parameterBindings name="FormParameter" objectPath="PromotionForm:PID"/>
    <parameterBindings name="Value" objectPath="DefaultID"/>
  </nodes>
<!--@Location 19,9-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue14">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
    <nodeSuccessors name="next" next="Call2"/>
    <parameterBindings name="FormParameter" objectPath="PromotionForm:UseCampaignTimeFrame"/>
    <parameterBindings name="Value" constant="(Boolean)false"/>
  </nodes>
<!--@Location 19,10-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call2">
<!--@BendPoints 39,22-->
    <nodeSuccessors name="next" next="PrepareApplicationView1"/>
    <startNode referencedName="This:GetLocales"/>
  </nodes>
<!--@Location 19,11-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="PrepareApplicationView1">
    <configurationValues name="SelectedMenuItem" value="OnlineMarketing"/>
    <configurationValues name="WorkingTemplate" value="marketing/PromotionCopy"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/PrepareApplicationView.xml"/>
<!--@BendPoints 39,24-->
    <nodeSuccessors name="next" next="InteractionEnd1"/>
    <parameterBindings name="WorkingTemplateSuffix" objectPath="CurrentChannel:TypeCode"/>
  </nodes>
<!--@Location 19,12-->
  <nodes xsi:type="pipeline:InteractionNode" nodeID="InteractionEnd1">
    <template referencedName="application/ApplicationFrame"/>
  </nodes>
<!--@Location 20,3-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode16">
<!--@BendPoints 41,8-->
    <nodeSuccessors name="next" next="KeyMapper16"/>
  </nodes>
<!--@Location 20,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper16">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
<!--@BendPoints 41,10-->
    <nodeSuccessors name="next" next="Jump1"/>
    <parameterBindings name="InValue_1" constant="true"/>
    <returnValueBindings name="OutValue_1" objectPath="ERRORCopyPromotion"/>
  </nodes>
<!--@Location 20,5-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="Jump1">
    <startNode referencedName="ViewPromotionList-ListAll"/>
  </nodes>
<!--@Location 10,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode13" name="Create">
    <nodeSuccessors name="next" next="Call3"/>
  </nodes>
<!--@Location 10,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call3">
<!--@BendPoints 21,4-->
    <nodeSuccessors name="next" next="CallNode7"/>
    <startNode referencedName="This:Prefix"/>
  </nodes>
<!--@Location 10,2-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode7">
    <nodeSuccessors name="next" next="CallNode1"/>
<!--@BendPoints 24,6 24,22-->
    <nodeSuccessors name="Error" next="JoinNode40"/>
    <startNode referencedName="ViewPromotion-ValidateForm"/>
  </nodes>
<!--@Location 10,3-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode1">
    <nodeSuccessors name="next" next="CallNode22"/>
    <startNode referencedName="This:GetSelectedCurrency"/>
  </nodes>
<!--@Location 10,4-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode22">
    <nodeSuccessors name="next" next="Pipelet3" action="begin"/>
    <parameterBindings name="Channel" objectPath="CurrentChannel"/>
    <startNode referencedName="ProcessPromotion-GetPromotionDomainByChannel"/>
  </nodes>
<!--@Location 10,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet3">
    <pipelet href="enfinity:/bc_marketing/pipelets/CreatePromotion.xml"/>
    <nodeSuccessors name="next" next="KeyMapper7"/>
<!--@BendPoints 23,11 23,12-->
    <nodeSuccessors name="pipelet_error" next="SetFormError1" action="rollback"/>
    <parameterBindings name="CurrencyCode" objectPath="SelectedCurrency"/>
    <parameterBindings name="Domain" objectPath="PromotionDomain"/>
    <parameterBindings name="PromotionID" objectPath="PromotionForm:PID:Value"/>
  </nodes>
<!--@displayNearNode@set Boolean.FALSE as default for Promtion:CouponCodeRequired
@Location 10,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper7">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
<!--@BendPoints 21,14-->
    <nodeSuccessors name="next" next="CallNode2"/>
    <parameterBindings name="InValue_1" constant="(Boolean)false"/>
    <returnValueBindings name="OutValue_1" objectPath="Promotion:CouponCodeRequired"/>
  </nodes>
<!--@Location 10,7-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode2">
    <nodeSuccessors name="next" next="CallNode10"/>
    <parameterBindings name="CreatorId" objectPath="CurrentUser:Profile:UUID"/>
    <parameterBindings name="LocaleId" objectPath="LocaleID"/>
    <parameterBindings name="PromotionActionPriorityHandler" objectPath="ApplicationBO:Repository(&quot;PromotionBORepository&quot;):PromotionActionPriorityHandler"/>
    <startNode referencedName="ProcessPromotion-UpdatePromotion"/>
  </nodes>
<!--@Location 10,8-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode10">
    <nodeSuccessors name="next" next="CallNode35"/>
    <parameterBindings name="AccountTypeCode" constant="80"/>
    <parameterBindings name="BudgetNotificationEmail" objectPath="PromotionForm:BudgetNotificationEmail:Value"/>
    <parameterBindings name="BudgetNotificationThreshold" objectPath="PromotionForm:BudgetNotificationThreshold:Value"/>
    <parameterBindings name="BudgetSource" objectPath="PromotionForm:BudgetSource:Value"/>
    <parameterBindings name="BudgetTypeCode" constant="1"/>
    <parameterBindings name="DisableByBudget" objectPath="PromotionForm:DisableByBudget:Value"/>
    <parameterBindings name="EndDate" objectPath="PromotionForm:EndDate:Value"/>
    <parameterBindings name="Locale" objectPath="SelectedLocale"/>
    <parameterBindings name="Scope" nullBinding="true"/>
    <parameterBindings name="ScopeType" nullBinding="true"/>
    <parameterBindings name="SendMailIfBudgetReached" objectPath="PromotionForm:SendMailIfBudgetReached:Value"/>
    <parameterBindings name="SendMailIfThresholdReached" objectPath="PromotionForm:SendMailIfThresholdReached:Value"/>
    <parameterBindings name="StartDate" objectPath="PromotionForm:StartDate:Value"/>
    <parameterBindings name="Unlimited" objectPath="PromotionForm:Unlimited:Value"/>
    <startNode referencedName="ProcessPromotionBudget-SetBudget"/>
  </nodes>
<!--@Location 10,9-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode35">
    <nodeSuccessors name="next" next="InvalidatePageLocatorPageable3"/>
    <startNode referencedName="ViewPromotion-UpdateAppAssignments"/>
  </nodes>
<!--@Location 10,10-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="InvalidatePageLocatorPageable3">
    <configurationValues name="DefaultPageLocatorName" value="PromotionList"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/InvalidatePageLocatorPageable.xml"/>
<!--@BendPoints 21,22-->
    <nodeSuccessors name="next" next="CreateRebate2"/>
  </nodes>
<!--@Location 10,11-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateRebate2">
    <pipelet href="enfinity:/bc_marketing/pipelets/CreateRebate.xml"/>
    <nodeSuccessors name="next" next="ExtensionPointNode_El_XMMCzEeigOr3p1azOdA"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode_JJ0HsMCzEeigOr3p1azOdA"/>
    <parameterBindings name="CurrencyCode" objectPath="SelectedCurrency"/>
    <parameterBindings name="Domain" objectPath="Promotion:Domain"/>
  </nodes>
<!--Called after a new promotion was created. 
@Location 10,12-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode_El_XMMCzEeigOr3p1azOdA"
      name="CreatedPromotion" strict="true">
    <nodeSuccessors name="next" next="JumpNode6" action="commit"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode_JJ0HsMCzEeigOr3p1azOdA"/>
    <parameters name="Promotion" type="com.intershop.component.marketing.capi.rebate.Promotion"/>
  </nodes>
<!--@Location 10,13-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode6">
    <startNode referencedName="This:Edit"/>
  </nodes>
<!--@Location 11,11-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode_JJ0HsMCzEeigOr3p1azOdA">
    <nodeSuccessors name="next" next="JoinNode40" action="rollback"/>
  </nodes>
<!--@Location 12,11-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode40">
    <nodeSuccessors name="next" next="GetFormSelection1"/>
  </nodes>
<!--@Location 12,12-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetFormSelection1">
    <pipelet href="enfinity:/bc_foundation/pipelets/GetFormSelection.xml"/>
    <nodeSuccessors name="next" next="Call10"/>
    <parameterBindings name="ParameterName" constant="CombinationTypesToAdd"/>
    <returnValueBindings name="Selection" objectPath="CombinationTypesToAddSelection"/>
  </nodes>
<!--@Location 12,13-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call10">
    <nodeSuccessors name="next" next="Pipelet20"/>
    <startNode referencedName="This:GetLocales"/>
  </nodes>
<!--@Location 12,14-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet20">
    <configurationValues name="Method" value="Active Currencies"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetCurrencies.xml"/>
    <nodeSuccessors name="next" next="CallNode40"/>
    <parameterBindings name="Domain" objectPath="CurrentChannel:RepositoryDomain"/>
  </nodes>
<!--@Location 12,15-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode40">
    <nodeSuccessors name="next" next="CallNode27"/>
    <parameterBindings name="Domain" objectPath="CurrentChannel:RepositoryDomain"/>
    <parameterBindings name="Locale" objectPath="SelectedLocale"/>
    <parameterBindings name="SortBy" constant="displayName"/>
    <startNode referencedName="ProcessPromotionBudget-GetBudgetSources"/>
  </nodes>
<!--@Location 12,16-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode27">
    <nodeSuccessors name="next" next="PrepareApplicationView2"/>
    <startNode referencedName="ViewPromotion-InitCombination"/>
  </nodes>
<!--@Location 12,17-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="PrepareApplicationView2">
    <configurationValues name="SelectedMenuItem" value="OnlineMarketing"/>
    <configurationValues name="WorkingTemplate" value="marketing/Promotion"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/PrepareApplicationView.xml"/>
<!--@BendPoints 25,36-->
    <nodeSuccessors name="next" next="InteractionEnd2"/>
    <parameterBindings name="WorkingTemplateSuffix" objectPath="CurrentChannel:TypeCode"/>
  </nodes>
<!--@Location 12,18-->
  <nodes xsi:type="pipeline:InteractionNode" nodeID="InteractionEnd2">
    <template referencedName="application/ApplicationFrame"/>
  </nodes>
<!--@Location 11,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormError1">
    <pipelet href="enfinity:/core/pipelets/SetFormError.xml"/>
<!--@BendPoints 23,22-->
    <nodeSuccessors name="next" next="JoinNode40"/>
    <parameterBindings name="ErrorMsg" constant="error.PromotionAlreadyExists"/>
    <parameterBindings name="TargetObject" objectPath="PromotionForm:PID"/>
  </nodes>
<!--@Location 1,41-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode29" name="CreatePromotionAppAssignmentForm"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode48"/>
  </nodes>
<!--@Location 1,42-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode48">
    <nodeSuccessors name="next" next="DecisionNode8"/>
    <startNode referencedName="ProcessApplication-GetApplications"/>
    <returnValueBindings name="Applications" objectPath="Apps"/>
  </nodes>
<!--@Location 1,43-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode8" conditionKey="Apps"
      operator="has_elements">
    <nodeSuccessors name="decision_yes" next="CallNode0"/>
<!--@BendPoints 5,87-->
    <nodeSuccessors name="decision_no" next="JoinNode11"/>
  </nodes>
<!--@Location 1,44-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode0">
    <nodeSuccessors name="next" next="GetIteratorSize0"/>
    <parameterBindings name="Applications" objectPath="Apps"/>
    <parameterBindings name="SortBy" constant="name"/>
    <parameterBindings name="SortDirection" constant="ascending"/>
    <startNode referencedName="ProcessApplication-Sort"/>
    <returnValueBindings name="Applications" objectPath="Apps"/>
  </nodes>
<!--@Location 1,45-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetIteratorSize0">
    <pipelet href="enfinity:/bc_foundation/pipelets/GetIteratorSize.xml"/>
    <nodeSuccessors name="next" next="CreatePageableFromIterator1"/>
    <parameterBindings name="Iterator" objectPath="Apps"/>
    <returnValueBindings name="Size" objectPath="AppsCount"/>
  </nodes>
<!--@Location 1,46-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreatePageableFromIterator1">
    <configurationValues name="Pagesize" value="0"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/CreatePageableFromIterator.xml"/>
    <nodeSuccessors name="next" next="CreateListForm1"/>
    <parameterBindings name="Iterator" objectPath="Apps"/>
    <parameterBindings name="PageSize" objectPath="AppsCount"/>
    <returnValueBindings name="Pageable" objectPath="AppsPageable"/>
  </nodes>
<!--@Location 1,47-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateListForm1">
    <configurationValues name="FormName" value="PromotionAppAssignment"/>
    <configurationValues name="ObjectIDMethod" value="getUUID"/>
    <configurationValues name="ResourceName" value="PromotionAppAssignment"/>
    <pipelet href="enfinity:/core/pipelets/CreateListForm.xml"/>
    <nodeSuccessors name="next" next="JoinNode7"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode11"/>
    <parameterBindings name="PageableObject" objectPath="AppsPageable"/>
    <returnValueBindings name="Form" objectPath="PromotionAppAssignmentForm"/>
  </nodes>
<!--@Location 1,48-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode7">
<!--@BendPoints 3,98-->
    <nodeSuccessors name="next" next="EndNode11"/>
  </nodes>
<!--@Location 1,49-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode11"/>
<!--@Location 2,47-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode11">
<!--@BendPoints 5,97-->
    <nodeSuccessors name="next" next="JoinNode7"/>
  </nodes>
<!--@Location 3,24-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode5" strict="true" name="DefaultStartEndDate"
      callMode="Private">
<!--@BendPoints 7,50-->
    <nodeSuccessors name="next" next="Pipelet1"/>
    <parameters name="PromotionForm" type="com.intershop.beehive.core.capi.webform.Form"/>
  </nodes>
<!--@Location 3,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet1">
    <pipelet href="enfinity:/bc_foundation/pipelets/GetCurrentDate.xml"/>
<!--@BendPoints 7,52-->
    <nodeSuccessors name="next" next="CalculateDate1"/>
    <returnValueBindings name="CurrentDate" objectPath="StartDate"/>
  </nodes>
<!--@Location 3,26-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CalculateDate1">
    <configurationValues name="CalculationMethod" value="Add"/>
    <configurationValues name="DefaultDays" value="1"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/CalculateDate.xml"/>
<!--@BendPoints 7,54-->
    <nodeSuccessors name="next" next="SetFormParameterValue24"/>
    <parameterBindings name="Date" objectPath="StartDate"/>
    <returnValueBindings name="CalculatedDate" objectPath="EndDate"/>
  </nodes>
<!--@Location 3,27-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue24">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
<!--@BendPoints 7,56-->
    <nodeSuccessors name="next" next="SetFormParameterValue25"/>
    <parameterBindings name="FormParameter" objectPath="PromotionForm:StartDate"/>
    <parameterBindings name="Value" objectPath="StartDate"/>
  </nodes>
<!--@Location 3,28-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue25">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
<!--@BendPoints 7,58-->
    <nodeSuccessors name="next" next="EndNode5"/>
    <parameterBindings name="FormParameter" objectPath="PromotionForm:EndDate"/>
    <parameterBindings name="Value" objectPath="EndDate"/>
  </nodes>
<!--@Location 3,29-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode5" strict="true">
    <returnValues name="StartDate" type="java.util.Date"/>
    <returnValues name="EndDate" type="java.util.Date"/>
    <returnValues name="PromotionForm" type="com.intershop.beehive.core.capi.webform.Form"/>
  </nodes>
<!--@Location 23,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode16" name="Delete">
    <nodeSuccessors name="next" next="Call20"/>
  </nodes>
<!--@Location 23,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call20">
    <nodeSuccessors name="next" next="Decision10"/>
    <startNode referencedName="This:Prefix"/>
  </nodes>
<!--@Location 23,2-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="Decision10" conditionKey="Promotion">
    <nodeSuccessors name="decision_yes" next="LoopNode3" action="begin"/>
<!--@BendPoints 51,5 51,14-->
    <nodeSuccessors name="decision_no" next="Jump6"/>
  </nodes>
<!--@Location 23,4-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode3" loop="Promotion:PromotionPageletAssignmentPOs">
<!--@BendPoints 48,9 48,13 47,13-->
    <nodeSuccessors name="next" next="RemovePromotionBasketReservations_Ee3HkNHiEeiXv_hF-v8oCA"/>
    <entry key="PageletPromotionAssignment">
      <nodeSuccessors name="loop_entry_next" next="CallNode24"/>
    </entry>
  </nodes>
<!--@Location 23,5-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode24">
<!--@BendPoints 47,12 46,12 46,9-->
    <nodeSuccessors name="next" next="LoopNode3_Entry"/>
    <parameterBindings name="Assignment" objectPath="PageletPromotionAssignment"/>
    <parameterBindings name="Domain" objectPath="PageletPromotionAssignment:Domain"/>
    <startNode referencedName="ProcessAssignments-DeleteAssignment"/>
  </nodes>
<!--@Location 23,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemovePromotionBasketReservations_Ee3HkNHiEeiXv_hF-v8oCA">
    <pipelet href="enfinity:/bc_marketing/pipelets/RemovePromotionBasketReservations.xml"/>
    <nodeSuccessors name="next" next="Pipelet19"/>
  </nodes>
<!--@Location 23,8-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet19">
    <configurationValues name="RemoveOnlyIfNoRebates" value="false"/>
    <configurationValues name="RemoveOnlyIfNotEnabled" value="true"/>
    <pipelet href="enfinity:/bc_marketing/pipelets/RemovePromotion.xml"/>
    <nodeSuccessors name="next" next="InvalidatePageLocatorPageable2" action="commit"/>
<!--@BendPoints 49,17 49,20-->
    <nodeSuccessors name="pipelet_error" next="JumpNode8" action="rollback"/>
  </nodes>
<!--@Location 23,9-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="InvalidatePageLocatorPageable2">
    <configurationValues name="DefaultPageLocatorName" value="PromotionList"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/InvalidatePageLocatorPageable.xml"/>
    <nodeSuccessors name="next" next="Jump2"/>
  </nodes>
<!--@Location 23,10-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="Jump2">
    <startNode referencedName="ViewPromotionList-ListAll"/>
  </nodes>
<!--@Location 24,10-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode8">
    <startNode referencedName="This:Edit"/>
  </nodes>
<!--@Location 25,7-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="Jump6">
    <startNode referencedName="ViewPromotionList-ListAll"/>
  </nodes>
<!--@Location 3,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="Start3" name="Dispatch">
    <nodeSuccessors name="next" next="DispatchFormAction2"/>
  </nodes>
<!--@Location 3,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="DispatchFormAction2">
    <configurationValues name="OutValue_0" value="ViewPromotion-Create"/>
    <configurationValues name="OutValue_1" value="ViewPromotion-JumpToList"/>
    <configurationValues name="OutValue_2" value="ViewPromotion-Update"/>
    <configurationValues name="OutValue_3" value="ViewPromotion-Delete"/>
    <configurationValues name="OutValue_4" value="ViewPromotion-Edit"/>
    <configurationValues name="OutValue_5" value="ViewPromotion-Edit"/>
    <configurationValues name="OutValue_6" value="ViewPromotion-Copy"/>
    <configurationValues name="OutValue_7" value="ViewPromotion-Edit"/>
    <configurationValues name="OutValue_8" value="ViewPromotion-New"/>
    <configurationValues name="OutValue_9" value="ViewPromotion-SetLocaleEdit"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/DispatchFormAction.xml"/>
    <nodeSuccessors name="next" next="JoinNode2"/>
<!--@BendPoints 9,3 9,4-->
    <nodeSuccessors name="pipelet_error" next="DispatchFormAction1"/>
    <parameterBindings name="Key_0" objectPath="create"/>
    <parameterBindings name="Key_1" objectPath="cancel"/>
    <parameterBindings name="Key_2" objectPath="update"/>
    <parameterBindings name="Key_3" objectPath="delete"/>
    <parameterBindings name="Key_4" objectPath="confirmDelete"/>
    <parameterBindings name="Key_5" objectPath="cancelDelete"/>
    <parameterBindings name="Key_6" objectPath="copy"/>
    <parameterBindings name="Key_7" objectPath="reset"/>
    <parameterBindings name="Key_8" objectPath="new"/>
    <parameterBindings name="Key_9" objectPath="setLocaleEdit"/>
    <returnValueBindings name="SelectionKey" objectPath="JumpTarget"/>
  </nodes>
<!--@Location 3,2-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode2">
    <nodeSuccessors name="next" next="JoinNode5"/>
  </nodes>
<!--@Location 3,3-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode5">
    <nodeSuccessors name="next" next="JoinNode0"/>
  </nodes>
<!--@Location 3,4-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode0">
    <nodeSuccessors name="next" next="Jump7"/>
  </nodes>
<!--@Location 3,5-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="Jump7">
    <startNode referencedName="SecureJump-Start"/>
  </nodes>
<!--@Location 4,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="DispatchFormAction1">
    <configurationValues name="OutValue_0" value="ViewPromotion-AssignCombinationTypes"/>
    <configurationValues name="OutValue_1" value="ViewPromotion-AssignCombinationTypes"/>
    <configurationValues name="OutValue_2" value="ViewPromotion-CopyDialog"/>
    <configurationValues name="OutValue_3" value="ViewPromotion-Edit"/>
    <configurationValues name="OutValue_4" value="ViewPromotion-ShowDefaultPriorities"/>
    <configurationValues name="OutValue_5" value="ViewPromotionCampaignAssignment-Search"/>
    <configurationValues name="OutValue_6" value="ViewPromotionCampaignAssignment-SearchCampaigns"/>
    <configurationValues name="OutValue_7" value="ViewPromotionCampaignAssignment-RemoveFromCampaign"/>
    <configurationValues name="OutValue_8" value="ViewPromotion-SetLocaleEditWithinCopyDialog"/>
    <configurationValues name="OutValue_9" value="ViewPromotionReplication-SelectTarget"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/DispatchFormAction.xml"/>
<!--@BendPoints 9,6 8,6-->
    <nodeSuccessors name="next" next="JoinNode2"/>
    <nodeSuccessors name="pipelet_error" next="DispatchFormAction0"/>
    <parameterBindings name="Key_0" objectPath="addCombinationType"/>
    <parameterBindings name="Key_1" objectPath="removeCombinationType"/>
    <parameterBindings name="Key_2" objectPath="copyDialog"/>
    <parameterBindings name="Key_3" objectPath="cancelCopy"/>
    <parameterBindings name="Key_4" objectPath="showDefaultPriorities"/>
    <parameterBindings name="Key_5" objectPath="hideDefaultRanks"/>
    <parameterBindings name="Key_6" objectPath="assignToCampaign"/>
    <parameterBindings name="Key_7" objectPath="removeFromCampaign"/>
    <parameterBindings name="Key_8" objectPath="setLocaleEditWithinCopyDialog"/>
    <parameterBindings name="Key_9" objectPath="selectStagingTarget"/>
    <returnValueBindings name="SelectionKey" objectPath="JumpTarget"/>
  </nodes>
<!--@Location 5,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="DispatchFormAction0">
    <configurationValues name="OutValue_0" value="ViewPromotion-ExecutePreview"/>
    <configurationValues name="OutValue_1" value="ViewPreview-CancelPreview"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/DispatchFormAction.xml"/>
    <nodeSuccessors name="next" next="JoinNode5"/>
<!--@BendPoints 11,8-->
    <nodeSuccessors name="pipelet_error" next="SetDictionaryValue6"/>
    <parameterBindings name="Key_0" objectPath="preview"/>
    <parameterBindings name="Key_1" objectPath="cancelPreview"/>
    <returnValueBindings name="SelectionKey" objectPath="JumpTarget"/>
  </nodes>
<!--@Location 5,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetDictionaryValue6">
    <configurationValues name="Name" value="JumpTarget"/>
    <configurationValues name="Value" value="ViewPromotionList-ListAll"/>
    <configurationValues name="ValueType" value="Dictionary Value"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetDictionaryValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode0"/>
  </nodes>
<!--@Location 8,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode1" name="Edit">
<!--@BendPoints 17,2-->
    <nodeSuccessors name="next" next="Call4"/>
  </nodes>
<!--@Location 8,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call4">
<!--@BendPoints 17,4-->
    <nodeSuccessors name="next" next="CallNode36"/>
    <startNode referencedName="This:Prefix"/>
  </nodes>
<!--@Location 8,2-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode36">
    <nodeSuccessors name="next" next="InvalidatePageLocatorPageable0"/>
    <startNode referencedName="ViewPromotion-SetAppAssignmentInPromotionAppAssignmentForm"/>
  </nodes>
<!--@Location 8,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="InvalidatePageLocatorPageable0">
    <configurationValues name="DefaultPageLocatorName" value="PromotionPromotionCodeGroups"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/InvalidatePageLocatorPageable.xml"/>
    <nodeSuccessors name="next" next="JoinNode22"/>
  </nodes>
<!--@Location 8,4-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode22">
<!--@BendPoints 17,10-->
    <nodeSuccessors name="next" next="CallNode13"/>
  </nodes>
<!--@Location 8,5-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode13">
    <nodeSuccessors name="next" next="JoinNode42"/>
    <startNode referencedName="ViewPromotion-InitPromotionFormData"/>
  </nodes>
<!--@Location 8,6-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode42">
    <nodeSuccessors name="next" next="CallNode5"/>
  </nodes>
<!--@Location 8,7-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode5">
    <nodeSuccessors name="next" next="Call12"/>
    <parameterBindings name="NonStrictPeriodMatching" constant="(Boolean)true"/>
    <startNode referencedName="ProcessPromotionBudget-CalculateRemainingBudget"/>
  </nodes>
<!--@Location 8,8-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call12">
<!--@BendPoints 17,18-->
    <nodeSuccessors name="next" next="CallNode4"/>
    <startNode referencedName="This:GetLocales"/>
  </nodes>
<!--@Location 8,9-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode4">
<!--@BendPoints 17,20-->
    <nodeSuccessors name="next" next="CallNode50"/>
    <startNode referencedName="ViewPromotion-InitCombination"/>
  </nodes>
<!--@Location 8,10-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode50">
    <nodeSuccessors name="next" next="GetTargetClusters1"/>
    <parameterBindings name="Domain" objectPath="Promotion:Domain"/>
    <parameterBindings name="Locale" objectPath="SelectedLocale"/>
    <parameterBindings name="SortBy" constant="displayName"/>
    <startNode referencedName="ProcessPromotionBudget-GetBudgetSources"/>
  </nodes>
<!--@displayNearNode@To check whether it is an editing or a live system.
@Location 8,11-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetTargetClusters1">
    <pipelet href="enfinity:/core/pipelets/GetTargetClusters.xml"/>
    <nodeSuccessors name="next" next="PrepareApplicationView5"/>
  </nodes>
<!--@Location 8,12-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="PrepareApplicationView5">
    <configurationValues name="SelectedMenuItem" value="OnlineMarketing"/>
    <configurationValues name="WorkingTemplate" value="marketing/Promotion"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/PrepareApplicationView.xml"/>
<!--@BendPoints 17,26-->
    <nodeSuccessors name="next" next="InteractionEnd5"/>
    <parameterBindings name="WorkingTemplateSuffix" objectPath="CurrentChannel:TypeCode"/>
  </nodes>
<!--@Location 8,13-->
  <nodes xsi:type="pipeline:InteractionNode" nodeID="InteractionEnd5">
    <template referencedName="application/ApplicationFrame"/>
  </nodes>
<!--@Location 37,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode0" name="ExecutePreview">
<!--@BendPoints 75,5-->
    <nodeSuccessors name="next" next="JoinNode1"/>
  </nodes>
<!--@Location 38,2-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode1">
    <nodeSuccessors name="next" next="CallNode63"/>
  </nodes>
<!--@Location 38,3-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode63">
    <nodeSuccessors name="next" next="CallNode61"/>
    <startNode referencedName="This:Prefix"/>
  </nodes>
<!--@Location 38,4-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode61">
    <nodeSuccessors name="next" next="KeyMapper6"/>
    <nodeSuccessors name="Error" next="KeyMapper17"/>
    <parameterBindings name="BackofficeApplicationBO" objectPath="ApplicationBO"/>
    <parameterBindings name="User" objectPath="CurrentUser"/>
    <startNode referencedName="ProcessPreviewApplication-GetPreferredPreviewApplication"/>
    <returnValueBindings name="ApplicationBO" objectPath="TargetApplicationBO"/>
  </nodes>
<!--@Location 38,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper6">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
<!--@BendPoints 77,12-->
    <nodeSuccessors name="next" next="CallNode59"/>
    <parameterBindings name="InValue_1" objectPath="ChannelRepository"/>
    <returnValueBindings name="OutValue_1" objectPath="Repository"/>
  </nodes>
<!--@Location 38,6-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode59">
    <nodeSuccessors name="next" next="CallNode58"/>
    <nodeSuccessors name="ERROR" next="KeyMapper9"/>
    <startNode referencedName="ProcessPreviewAttributeContext-CreateConfigurationAttributesMap"/>
  </nodes>
<!--@Location 38,7-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode58">
    <nodeSuccessors name="next" next="GetCurrentDate1"/>
    <nodeSuccessors name="ERROR" next="KeyMapper10"/>
    <parameterBindings name="ApplicationBO" objectPath="TargetApplicationBO"/>
    <parameterBindings name="PreviewContextID" objectPath="CurrentSession:SessionID"/>
    <startNode referencedName="ProcessPreviewContext-GetOrCreate"/>
  </nodes>
<!--@Location 38,8-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetCurrentDate1">
    <pipelet href="enfinity:/bc_foundation/pipelets/GetCurrentDate.xml"/>
    <nodeSuccessors name="next" next="UpdatePreviewApplicationForPromotion0"/>
  </nodes>
<!--@Location 38,9-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdatePreviewApplicationForPromotion0">
    <pipelet href="enfinity:/bc_marketing/pipelets/UpdatePreviewApplicationForPromotion.xml"/>
    <nodeSuccessors name="next" next="DecisionNode0"/>
    <nodeSuccessors name="pipelet_error" next="KeyMapper14"/>
  </nodes>
<!--@Location 38,10-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode0" conditionKey="preview">
    <nodeSuccessors name="decision_yes" next="JoinNode24"/>
    <nodeSuccessors name="decision_no" next="CallNode25"/>
  </nodes>
<!--@Location 38,11-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode24">
    <nodeSuccessors name="next" next="CallNode31"/>
  </nodes>
<!--@Location 38,12-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode31">
    <nodeSuccessors name="next" next="CallNode32"/>
    <parameterBindings name="StartDate" objectPath="Promotion:StartDate"/>
    <startNode referencedName="ProcessPreviewDate-UpdatePreviewDate"/>
  </nodes>
<!--@Location 38,14-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode32">
    <nodeSuccessors name="next" next="UpdateMapping0"/>
    <startNode referencedName="ProcessReturnTarget-GetPreviewContextPipeline"/>
  </nodes>
<!--@Location 38,15-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateMapping0">
    <configurationValues name="DefaultKey" value="confirmPreview"/>
    <configurationValues name="Mode" value="Remove"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/UpdateMapping.xml"/>
    <nodeSuccessors name="next" next="CallNode60"/>
    <parameterBindings name="InMap" objectPath="ContextPipelineMap"/>
  </nodes>
<!--@Location 38,16-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode60">
<!--@BendPoints 77,34-->
    <nodeSuccessors name="next" next="GetUserGroupByID1"/>
    <startNode referencedName="ProcessOrganization-GetConsumerOrg"/>
  </nodes>
<!--@Location 38,17-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetUserGroupByID1">
    <configurationValues name="DefaultUserGroupID" value="Everyone"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetUserGroupByID.xml"/>
    <nodeSuccessors name="next" next="JoinNode41"/>
<!--@BendPoints 78,35 78,37-->
    <nodeSuccessors name="pipelet_error" next="JoinNode41"/>
    <parameterBindings name="Domain" objectPath="Organization:OrganizationDomain"/>
    <parameterBindings name="UserGroupID" nullBinding="true"/>
    <returnValueBindings name="UserGroup" objectPath="EveryoneUserGroup"/>
  </nodes>
<!--@Location 38,18-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode41">
    <nodeSuccessors name="next" next="AddObjectToVector2"/>
  </nodes>
<!--@Location 38,19-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector2">
    <configurationValues name="Mode" value="Forbid Duplicates"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
    <nodeSuccessors name="next" next="KeyMapper15"/>
    <parameterBindings name="InVector" nullBinding="true"/>
    <parameterBindings name="Object" objectPath="EveryoneUserGroup"/>
    <parameterBindings name="Objects" objectPath="UserGroups"/>
    <returnValueBindings name="OutVector" objectPath="UserGroupsCollection"/>
  </nodes>
<!--@Location 38,20-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper15">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="SetSelectedPreviewConfigurationAttributeValues0"/>
    <parameterBindings name="InValue_1" objectPath="ApplicationBO:Repository(&quot;PromotionBORepository&quot;):PromotionBOByID(Promotion:ID):Extension(&quot;CustomerSegment&quot;):CustomerSegmentBOs"/>
    <returnValueBindings name="OutValue_1" objectPath="CustomerSegmentBOsCollection"/>
  </nodes>
<!--@Location 38,21-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetSelectedPreviewConfigurationAttributeValues0">
    <configurationValues name="AttributeSet" value="com.intershop.component.marketing.capi.preview.MarketingPreviewConfigurationAttributeSet"/>
    <configurationValues name="AttributeSetValue" value="PreviewCustomerSegmentBOs"/>
    <pipelet href="enfinity:/bc_preview/pipelets/SetSelectedPreviewConfigurationAttributeValues.xml"/>
    <nodeSuccessors name="next" next="SetSelectedPreviewConfigurationAttributeValues2"/>
    <parameterBindings name="PreviewConfigurationAttributeID" nullBinding="true"/>
    <parameterBindings name="ValueObjects" objectPath="CustomerSegmentBOsCollection"/>
  </nodes>
<!--@Location 38,22-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetSelectedPreviewConfigurationAttributeValues2">
    <configurationValues name="AttributeSet" value="com.intershop.component.marketing.capi.preview.MarketingPreviewConfigurationAttributeSet"/>
    <configurationValues name="AttributeSetValue" value="PreviewUserGroups"/>
    <pipelet href="enfinity:/bc_preview/pipelets/SetSelectedPreviewConfigurationAttributeValues.xml"/>
    <nodeSuccessors name="next" next="SetSelectedPreviewConfigurationAttributeValue3"/>
    <parameterBindings name="PreviewConfigurationAttributeID" nullBinding="true"/>
    <parameterBindings name="ValueObjects" objectPath="UserGroupsCollection"/>
  </nodes>
<!--@Location 38,23-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetSelectedPreviewConfigurationAttributeValue3">
    <configurationValues name="AttributeSet" value="com.intershop.component.marketing.capi.preview.MarketingPreviewConfigurationAttributeSet"/>
    <configurationValues name="AttributeSetValue" value="PreviewPromotions"/>
    <pipelet href="enfinity:/bc_preview/pipelets/SetSelectedPreviewConfigurationAttributeValue.xml"/>
    <nodeSuccessors name="next" next="JumpNode12"/>
    <parameterBindings name="ValueObject" objectPath="Promotion"/>
  </nodes>
<!--@Location 38,24-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode12">
    <parameterBindings name="ApplicationBO" objectPath="TargetApplicationBO"/>
    <parameterBindings name="CallTargetObject" objectPath="Promotion"/>
    <parameterBindings name="ContentRepositoryUUID" objectPath="CurrentChannel:UUID"/>
    <parameterBindings name="Repository" objectPath="ChannelRepository"/>
    <startNode referencedName="PreviewLinks-Preview"/>
  </nodes>
<!--@Location 39,10-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode25">
    <nodeSuccessors name="endsInPast" next="KeyMapper0"/>
    <nodeSuccessors name="ok" next="JoinNode24"/>
    <nodeSuccessors name="startsInPast" next="KeyMapper11"/>
    <parameterBindings name="EndDate" objectPath="Promotion:EndDate"/>
    <parameterBindings name="StartDate" objectPath="Promotion:StartDate"/>
    <startNode referencedName="ProcessPreviewDate-CheckPreviewDate"/>
  </nodes>
<!--@Location 39,12-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper0">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
<!--@BendPoints 80,25 80,27-->
    <nodeSuccessors name="next" next="JoinNode28"/>
    <parameterBindings name="InValue_1" constant="PREVIEW_START_AND_END_IN_PAST_BUT_PASTPREVIEW_DISABLED"/>
    <returnValueBindings name="OutValue_1" objectPath="confirmPreview"/>
  </nodes>
<!--@Location 40,13-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode28">
    <nodeSuccessors name="next" next="JoinNode26"/>
  </nodes>
<!--@Location 41,13-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode26">
    <nodeSuccessors name="next" next="CallNode64"/>
  </nodes>
<!--@Location 41,14-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode64">
    <nodeSuccessors name="next" next="CallNode52"/>
    <startNode referencedName="ProcessReturnTarget-PutPreviewContextPipeline"/>
  </nodes>
<!--@Location 41,15-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode52">
    <nodeSuccessors name="next" next="AddMultipleEntriesToMap7"/>
    <startNode referencedName="ProcessReturnTarget-GetPreviewContextPipeline"/>
  </nodes>
<!--@Location 41,17-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddMultipleEntriesToMap7">
    <configurationValues name="Mode" value="OverwriteValue"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddMultipleEntriesToMap.xml"/>
    <nodeSuccessors name="next" next="JumpNode11"/>
    <parameterBindings name="InMap" objectPath="ContextPipelineMap"/>
    <parameterBindings name="Key1" constant="PreviewPromotionError"/>
    <parameterBindings name="Key2" constant="confirmPreview"/>
    <parameterBindings name="Key3" constant="PromotionUUID"/>
    <parameterBindings name="Value1" objectPath="PreviewPromotionError"/>
    <parameterBindings name="Value2" objectPath="confirmPreview"/>
    <parameterBindings name="Value3" objectPath="PromotionUUID"/>
    <returnValueBindings name="OutMap" objectPath="ContextPipelineMap"/>
  </nodes>
<!--@Location 41,18-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode11">
    <startNode referencedName="ProcessPipelineInvocation-InvokeTargetPipeline"/>
  </nodes>
<!--@Location 40,12-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper11">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="JoinNode28"/>
    <parameterBindings name="InValue_1" constant="PREVIEW_START_IN_PAST_BUT_PASTPREVIEW_DISABLED"/>
    <returnValueBindings name="OutValue_1" objectPath="confirmPreview"/>
  </nodes>
<!--@Location 40,9-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper14">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="JoinNode6"/>
    <parameterBindings name="InValue_1" constant="PREVIEW_DEFAULT_APPLICATION_NOT_PREVIEWABLE_ERROR"/>
    <returnValueBindings name="OutValue_1" objectPath="PreviewPromotionError"/>
  </nodes>
<!--@Location 41,9-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode6">
    <nodeSuccessors name="next" next="JoinNode26"/>
  </nodes>
<!--@Location 40,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper10">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="JoinNode36"/>
    <parameterBindings name="InValue_1" constant="PREVIEW_APPLICATION_NOT_PREVIEWABLE_ERROR"/>
    <returnValueBindings name="OutValue_1" objectPath="PreviewPromotionError"/>
  </nodes>
<!--@Location 41,7-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode36">
    <nodeSuccessors name="next" next="JoinNode6"/>
  </nodes>
<!--@Location 40,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper9">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="JoinNode37"/>
    <parameterBindings name="InValue_1" constant="PREVIEW_GENERAL_ERROR"/>
    <returnValueBindings name="OutValue_1" objectPath="PreviewPromotionError"/>
  </nodes>
<!--@Location 41,6-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode37">
    <nodeSuccessors name="next" next="JoinNode36"/>
  </nodes>
<!--@Location 40,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper17">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
<!--@BendPoints 83,9-->
    <nodeSuccessors name="next" next="JoinNode37"/>
    <parameterBindings name="InValue_1" constant="PREVIEW_GENERAL_ERROR"/>
    <returnValueBindings name="OutValue_1" objectPath="PreviewPromotionError"/>
  </nodes>
<!--@Location 16,24-->
  <nodes xsi:type="pipeline:StartNode" nodeID="Start10" name="GetLocales" callMode="Private">
    <nodeSuccessors name="next" next="DetermineLocales1"/>
  </nodes>
<!--@Location 16,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="DetermineLocales1">
    <pipelet href="enfinity:/core/pipelets/DetermineLocales.xml"/>
    <nodeSuccessors name="next" next="Decision6"/>
    <returnValueBindings name="Locales" objectPath="AllLocales"/>
  </nodes>
<!--@Location 16,26-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="Decision6" conditionKey="UpdateLocale"
      operator="undef">
<!--@BendPoints 33,54-->
    <nodeSuccessors name="decision_yes" next="GetLocale2"/>
<!--@BendPoints 35,53-->
    <nodeSuccessors name="decision_no" next="KeyMapper2"/>
  </nodes>
<!--@Location 16,27-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetLocale2">
    <configurationValues name="LocaleFallback" value="Session Locale"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetLocale.xml"/>
    <nodeSuccessors name="next" next="Join7"/>
    <parameterBindings name="LocaleId" objectPath="LocaleID"/>
    <returnValueBindings name="Locale" objectPath="SelectedLocale"/>
  </nodes>
<!--@Location 16,28-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="Join7">
    <nodeSuccessors name="next" next="End5"/>
  </nodes>
<!--@Location 16,29-->
  <nodes xsi:type="pipeline:EndNode" nodeID="End5"/>
<!--@Location 17,27-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper2">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
<!--@BendPoints 35,57-->
    <nodeSuccessors name="next" next="Join7"/>
    <parameterBindings name="InValue_1" objectPath="UpdateLocale"/>
    <returnValueBindings name="OutValue_1" objectPath="SelectedLocale"/>
  </nodes>
<!--@Location 18,24-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode6" name="GetSelectedCurrency"
      callMode="Private">
    <nodeSuccessors name="next" next="DecisionNode2"/>
  </nodes>
<!--@Location 18,25-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode2" conditionKey="PromotionForm:Currency:Value"
      operator="str_empty">
    <nodeSuccessors name="decision_yes" next="JoinNode4"/>
<!--@BendPoints 39,51 39,52-->
    <nodeSuccessors name="decision_no" next="DecisionNode1"/>
  </nodes>
<!--@Location 18,27-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode4">
<!--@BendPoints 37,56-->
    <nodeSuccessors name="next" next="KeyMapper4"/>
  </nodes>
<!--@Location 18,28-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper4">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="JoinNode3"/>
    <parameterBindings name="InValue_1" nullBinding="true"/>
    <returnValueBindings name="OutValue_1" objectPath="SelectedCurrency"/>
  </nodes>
<!--@Location 18,29-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode3">
<!--@BendPoints 37,60-->
    <nodeSuccessors name="next" next="EndNode9"/>
  </nodes>
<!--@Location 18,30-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode9">
    <returnValues name="SelectedCurrency" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 19,26-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode1" conditionKey="PromotionForm:Currency:Value"
      operator="str_eq" conditionValue=".All.">
<!--@BendPoints 39,55-->
    <nodeSuccessors name="decision_yes" next="JoinNode4"/>
<!--@BendPoints 40,53 39,56-->
    <nodeSuccessors name="decision_no" next="KeyMapper5"/>
  </nodes>
<!--@Location 19,28-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper5">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
<!--@BendPoints 39,59-->
    <nodeSuccessors name="next" next="JoinNode3"/>
    <parameterBindings name="InValue_1" objectPath="PromotionForm:Currency:Value"/>
    <returnValueBindings name="OutValue_1" objectPath="SelectedCurrency"/>
  </nodes>
<!--@Location 12,24-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode10" strict="true" name="InitBudgetFormData"
      callMode="Private">
    <nodeSuccessors name="next" next="GetBudgetByUUID2"/>
    <parameters name="Promotion" type="com.intershop.component.marketing.capi.rebate.Promotion"/>
    <parameters name="PromotionForm" type="com.intershop.beehive.core.capi.webform.Form"/>
    <parameters name="SelectedLocale" type="com.intershop.beehive.core.capi.localization.LocaleInformation"/>
  </nodes>
<!--@Location 12,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetBudgetByUUID2">
    <pipelet href="enfinity:/bc_organization/pipelets/GetBudgetByUUID.xml"/>
<!--@BendPoints 25,52-->
    <nodeSuccessors name="next" next="SetFormParameterValue9"/>
<!--@BendPoints 26,51 26,55-->
    <nodeSuccessors name="pipelet_error" next="JoinNode10"/>
    <parameterBindings name="BudgetUUID" objectPath="Promotion:BudgetID"/>
  </nodes>
<!--@Location 12,26-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue9">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode10"/>
    <parameterBindings name="FormParameter" objectPath="PromotionForm:BudgetSource"/>
    <parameterBindings name="Value" objectPath="Promotion:BudgetSource:UUID"/>
  </nodes>
<!--@Location 12,27-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode10">
    <nodeSuccessors name="next" next="AddMultipleEntriesToMap1"/>
  </nodes>
<!--@Location 12,28-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddMultipleEntriesToMap1">
    <configurationValues name="Mode" value="OverwriteValue"/>
    <configurationValues name="ValueSeparatorChar" value=","/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddMultipleEntriesToMap.xml"/>
<!--@BendPoints 25,58-->
    <nodeSuccessors name="next" next="AddMultipleEntriesToMap2"/>
    <parameterBindings name="InMap" objectPath="FormParameters"/>
    <parameterBindings name="Key2" objectPath="PromotionForm:DisableByBudget"/>
    <parameterBindings name="Key3" objectPath="PromotionForm:BudgetNotificationThreshold"/>
    <parameterBindings name="Key4" objectPath="PromotionForm:BudgetAmount"/>
    <parameterBindings name="Key5" objectPath="PromotionForm:BudgetNotificationEmail"/>
    <parameterBindings name="Value2" objectPath="Promotion:DisableByBudget"/>
    <parameterBindings name="Value3" objectPath="Promotion:BudgetNotificationThreshold"/>
    <parameterBindings name="Value4" objectPath="Promotion:BudgetAmount"/>
    <parameterBindings name="Value5" objectPath="Promotion:BudgetNotificationEmail"/>
    <returnValueBindings name="OutMap" objectPath="FormParameters"/>
  </nodes>
<!--@Location 12,29-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddMultipleEntriesToMap2">
    <configurationValues name="Mode" value="OverwriteValue"/>
    <configurationValues name="ValueSeparatorChar" value=","/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddMultipleEntriesToMap.xml"/>
<!--@BendPoints 25,60-->
    <nodeSuccessors name="next" next="SetFormParameterValues1"/>
    <parameterBindings name="InMap" objectPath="FormParameters"/>
    <parameterBindings name="Key2" objectPath="PromotionForm:SendMailIfBudgetReached"/>
    <parameterBindings name="Key3" objectPath="PromotionForm:SendMailIfThresholdReached"/>
    <parameterBindings name="Value2" objectPath="Promotion:SendMailIfBudgetReached"/>
    <parameterBindings name="Value3" objectPath="Promotion:SendMailIfThresholdReached"/>
    <returnValueBindings name="OutMap" objectPath="FormParameters"/>
  </nodes>
<!--@Location 12,30-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValues1">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValues.xml"/>
<!--@BendPoints 25,62-->
    <nodeSuccessors name="next" next="EndNode7"/>
    <parameterBindings name="FormParameterValuesMap" objectPath="FormParameters"/>
  </nodes>
<!--@Location 12,31-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode7" strict="true">
    <returnValues name="PromotionForm" type="com.intershop.beehive.core.capi.webform.Form"/>
  </nodes>
<!--@Location 14,24-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode19" strict="true" name="InitCombination"
      callMode="Private">
<!--@BendPoints 29,50-->
    <nodeSuccessors name="next" next="GetActionApplicationContext2"/>
    <parameters name="PromotionForm" type="com.intershop.beehive.core.capi.webform.Form"/>
    <parameters name="SiteDomain" type="java.lang.String" optional="true"/>
    <parameters name="Promotion" type="com.intershop.component.marketing.capi.rebate.Promotion"
        optional="true"/>
  </nodes>
<!--@Location 14,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetActionApplicationContext2">
    <pipelet href="enfinity:/bc_foundation/pipelets/GetActionApplicationContext.xml"/>
    <nodeSuccessors name="next" next="DeterminePromotionCombinable1"/>
    <parameterBindings name="ActionDescriptorRegistryName" constant="promotionActionDescriptorRegistry"/>
    <parameterBindings name="ActionRepositoryName" constant="promotionActionRepository"/>
    <parameterBindings name="SiteName" objectPath="SiteDomain:DomainName"/>
  </nodes>
<!--@Location 14,26-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="DeterminePromotionCombinable1">
    <pipelet href="enfinity:/bc_marketing/pipelets/DeterminePromotionCombinable.xml"/>
    <nodeSuccessors name="next" next="AddMultipleEntriesToMap8"/>
  </nodes>
<!--@Location 14,27-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddMultipleEntriesToMap8">
    <configurationValues name="Mode" value="OverwriteValue"/>
    <configurationValues name="ValueSeparatorChar" value=","/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddMultipleEntriesToMap.xml"/>
<!--@BendPoints 29,56-->
    <nodeSuccessors name="next" next="SetFormParameterValues2"/>
    <parameterBindings name="InMap" objectPath="FormParameters"/>
    <parameterBindings name="Key1" objectPath="PromotionForm:Combinable"/>
    <parameterBindings name="Key2" objectPath="PromotionForm:AssignedCombinationTypes"/>
    <parameterBindings name="Key3" objectPath="PromotionForm:AvailableCombinationTypes"/>
    <parameterBindings name="Key4" objectPath="PromotionForm:MultipleAllowed"/>
    <parameterBindings name="Value1" objectPath="Combinable"/>
    <parameterBindings name="Value2" objectPath="AssignedCombinationTypes"/>
    <parameterBindings name="Value3" objectPath="AvailableCombinationTypes"/>
    <parameterBindings name="Value4" objectPath="MultipleAllowed"/>
    <returnValueBindings name="OutMap" objectPath="FormParameters"/>
  </nodes>
<!--@Location 14,28-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValues2">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValues.xml"/>
<!--@BendPoints 29,58-->
    <nodeSuccessors name="next" next="EndNode10"/>
    <parameterBindings name="FormParameterValuesMap" objectPath="FormParameters"/>
  </nodes>
<!--@Location 14,29-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode10" strict="true">
    <returnValues name="PromotionForm" type="com.intershop.beehive.core.capi.webform.Form"/>
<!--a hash map of all action zypes, key is ActionType:ID-->
    <returnValues name="AllPromotionTypes" type="java.util.HashMap" optional="true"/>
    <returnValues name="AvailableCombinationTypes" type="java.util.Iterator"/>
    <returnValues name="AssignedCombinationTypes" type="java.util.Iterator"/>
  </nodes>
<!--@Location 8,24-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode17" strict="true" name="InitGeneralPromotionFormData"
      callMode="Private">
    <nodeSuccessors name="next" next="GetDomainByUUID1"/>
    <parameters name="PromotionForm" type="com.intershop.beehive.core.capi.webform.Form"/>
    <parameters name="Promotion" type="com.intershop.component.marketing.capi.rebate.Promotion"/>
    <parameters name="SelectedLocale" type="com.intershop.beehive.core.capi.localization.LocaleInformation"
        optional="true"/>
  </nodes>
<!--@Location 8,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetDomainByUUID1">
    <pipelet href="enfinity:/bc_foundation/pipelets/GetDomainByUUID.xml"/>
    <nodeSuccessors name="next" next="JoinNode19"/>
<!--@BendPoints 18,51 18,53-->
    <nodeSuccessors name="pipelet_error" next="JoinNode19"/>
    <parameterBindings name="DomainUUID" objectPath="Promotion:Domain:SiteID"/>
    <returnValueBindings name="Domain" objectPath="SiteDomain"/>
  </nodes>
<!--@Location 8,26-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode19">
    <nodeSuccessors name="next" next="AddMultipleEntriesToMap3"/>
  </nodes>
<!--@Location 8,27-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddMultipleEntriesToMap3">
    <configurationValues name="Mode" value="OverwriteValue"/>
    <configurationValues name="ValueSeparatorChar" value=","/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddMultipleEntriesToMap.xml"/>
    <nodeSuccessors name="next" next="AddMultipleEntriesToMap5"/>
    <parameterBindings name="InMap" objectPath="FormParameters"/>
    <parameterBindings name="Key1" objectPath="PromotionForm:Name"/>
    <parameterBindings name="Key2" objectPath="PromotionForm:PID"/>
    <parameterBindings name="Key3" objectPath="PromotionForm:Description"/>
    <parameterBindings name="Key4" objectPath="PromotionForm:Enabled"/>
    <parameterBindings name="Key5" objectPath="PromotionForm:EffectDiscountLevel"/>
    <parameterBindings name="Value1" objectPath="Promotion:DisplayName(SelectedLocale)"/>
    <parameterBindings name="Value2" objectPath="Promotion:ID"/>
    <parameterBindings name="Value3" objectPath="Promotion:Description(SelectedLocale)"/>
    <parameterBindings name="Value4" objectPath="Promotion:Enabled"/>
    <parameterBindings name="Value5" objectPath="Promotion:EffectDiscountLevel"/>
    <returnValueBindings name="OutMap" objectPath="FormParameters"/>
  </nodes>
<!--@Location 8,28-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddMultipleEntriesToMap5">
    <configurationValues name="Mode" value="OverwriteValue"/>
    <configurationValues name="ValueSeparatorChar" value=","/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddMultipleEntriesToMap.xml"/>
<!--@BendPoints 17,58-->
    <nodeSuccessors name="next" next="SetFormParameterValues3"/>
    <parameterBindings name="InMap" objectPath="FormParameters"/>
    <parameterBindings name="Key1" objectPath="PromotionForm:StartDate"/>
    <parameterBindings name="Key2" objectPath="PromotionForm:EndDate"/>
    <parameterBindings name="Key3" objectPath="PromotionForm:UseCampaignTimeFrame"/>
    <parameterBindings name="Key4" objectPath="PromotionForm:BudgetSource"/>
    <parameterBindings name="Value1" objectPath="Promotion:StartDate"/>
    <parameterBindings name="Value2" objectPath="Promotion:EndDate"/>
    <parameterBindings name="Value3" objectPath="Promotion:UseCampaignTimeFrame"/>
    <parameterBindings name="Value4" objectPath="Promotion:BudgetSource:UUID"/>
    <returnValueBindings name="OutMap" objectPath="FormParameters"/>
  </nodes>
<!--@Location 8,29-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValues3">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValues.xml"/>
<!--@BendPoints 17,60-->
    <nodeSuccessors name="next" next="EndNode1"/>
    <parameterBindings name="FormParameterValuesMap" objectPath="FormParameters"/>
  </nodes>
<!--@Location 8,30-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode1" strict="true">
    <returnValues name="PromotionForm" type="com.intershop.beehive.core.capi.webform.Form"/>
    <returnValues name="PromotionDisplayName" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 1,24-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode4" strict="true" name="InitNewPromotionForm"
      callMode="Private">
    <nodeSuccessors name="next" next="CreateUUID1"/>
    <parameters name="PromotionForm" type="com.intershop.beehive.core.capi.webform.Form"/>
    <parameters name="BudgetNotificationEmail" type="java.lang.String"/>
    <parameters name="SelectedLocale" type="com.intershop.beehive.core.capi.localization.LocaleInformation"/>
    <parameters name="CurrencyMnemonic" type="java.lang.String"/>
  </nodes>
<!--@Location 1,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateUUID1">
    <pipelet href="enfinity:/bc_foundation/pipelets/CreateUUID.xml"/>
    <nodeSuccessors name="next" next="AddMultipleEntriesToMap4"/>
    <returnValueBindings name="UUID" objectPath="DefaultID"/>
  </nodes>
<!--@Location 1,26-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddMultipleEntriesToMap4">
    <configurationValues name="Mode" value="OverwriteValue"/>
    <configurationValues name="ValueSeparatorChar" value=","/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddMultipleEntriesToMap.xml"/>
    <nodeSuccessors name="next" next="AddMultipleEntriesToMap6"/>
    <parameterBindings name="InMap" objectPath="FormParameters"/>
    <parameterBindings name="Key1" objectPath="PromotionForm:Name"/>
    <parameterBindings name="Key2" objectPath="PromotionForm:PID"/>
    <parameterBindings name="Key3" objectPath="PromotionForm:Description"/>
    <parameterBindings name="Key4" objectPath="PromotionForm:BudgetNotificationEmail"/>
    <parameterBindings name="Key5" objectPath="PromotionForm:RankSelection"/>
    <parameterBindings name="Value1" constant=""/>
    <parameterBindings name="Value2" objectPath="DefaultID"/>
    <parameterBindings name="Value3" constant=""/>
    <parameterBindings name="Value4" objectPath="BudgetNotificationEmail"/>
    <parameterBindings name="Value5" constant="(java.lang.Boolean)true"/>
    <returnValueBindings name="OutMap" objectPath="FormParameters"/>
  </nodes>
<!--@Location 1,27-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddMultipleEntriesToMap6">
    <configurationValues name="Mode" value="OverwriteValue"/>
    <configurationValues name="ValueSeparatorChar" value=","/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddMultipleEntriesToMap.xml"/>
    <nodeSuccessors name="next" next="SetFormParameterValues4"/>
    <parameterBindings name="InMap" objectPath="FormParameters"/>
    <parameterBindings name="Key1" objectPath="PromotionForm:Unlimited"/>
    <parameterBindings name="Key2" objectPath="PromotionForm:Currency"/>
    <parameterBindings name="Key3" objectPath="PromotionForm:BudgetAmount"/>
    <parameterBindings name="Key4" objectPath="PromotionForm:BudgetNotificationThreshold"/>
    <parameterBindings name="Key5" objectPath="PromotionForm:EffectDiscountLevel"/>
    <parameterBindings name="Value1" constant="unlimited"/>
    <parameterBindings name="Value2" objectPath="CurrencyMnemonic"/>
    <parameterBindings name="Value3" constant=""/>
    <parameterBindings name="Value4" constant=""/>
    <parameterBindings name="Value5" constant="(java.lang.Boolean)false"/>
    <returnValueBindings name="OutMap" objectPath="FormParameters"/>
  </nodes>
<!--@Location 1,28-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValues4">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValues.xml"/>
<!--@BendPoints 3,58-->
    <nodeSuccessors name="next" next="CallNode3"/>
    <parameterBindings name="FormParameterValuesMap" objectPath="FormParameters"/>
  </nodes>
<!--@Location 1,29-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode3">
    <nodeSuccessors name="next" next="CallNode8"/>
    <startNode referencedName="ViewPromotion-DefaultStartEndDate"/>
  </nodes>
<!--@Location 1,30-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode8">
    <nodeSuccessors name="next" next="EndNode6"/>
    <startNode referencedName="ViewPromotion-InitCombination"/>
  </nodes>
<!--@Location 1,31-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode6" strict="true">
    <returnValues name="StartDate" type="java.util.Date"/>
    <returnValues name="EndDate" type="java.util.Date"/>
    <returnValues name="PromotionForm" type="com.intershop.beehive.core.capi.webform.Form"/>
    <returnValues name="AssignedCombinationTypes" type="java.util.Iterator"/>
    <returnValues name="AvailableCombinationTypes" type="java.util.Iterator"/>
    <returnValues name="AllPromotionTypes" type="java.util.HashMap" optional="true"/>
  </nodes>
<!--@Location 5,24-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode3" strict="true" name="InitPromotionFormData"
      callMode="Private">
    <nodeSuccessors name="next" next="DecisionNode10"/>
    <parameters name="Promotion" type="com.intershop.component.marketing.capi.rebate.Promotion"/>
    <parameters name="SelectedLocale" type="com.intershop.beehive.core.capi.localization.LocaleInformation"/>
    <parameters name="PromotionForm" type="com.intershop.beehive.core.capi.webform.Form"
        optional="true"/>
  </nodes>
<!--@Location 5,25-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode10" conditionKey="PromotionForm"
      operator="undef">
    <nodeSuccessors name="decision_yes" next="CreateForm3"/>
<!--@BendPoints 13,51 13,55-->
    <nodeSuccessors name="decision_no" next="JoinNode25"/>
  </nodes>
<!--@Location 5,26-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateForm3">
    <configurationValues name="FormName" value="GeneralPromotionInformation"/>
    <configurationValues name="FormResource" value="GeneralPromotionInformation"/>
    <pipelet href="enfinity:/core/pipelets/CreateForm.xml"/>
    <nodeSuccessors name="next" next="JoinNode25"/>
    <parameterBindings name="Locale" objectPath="SelectedLocale"/>
    <returnValueBindings name="Form" objectPath="PromotionForm"/>
  </nodes>
<!--@Location 5,27-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode25">
    <nodeSuccessors name="next" next="CallNode17"/>
  </nodes>
<!--@Location 5,28-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode17">
    <nodeSuccessors name="next" next="CallNode6"/>
    <startNode referencedName="ViewPromotion-InitGeneralPromotionFormData"/>
  </nodes>
<!--@Location 5,29-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode6">
<!--@BendPoints 11,60-->
    <nodeSuccessors name="next" next="CallNode15"/>
    <startNode referencedName="ViewPromotion-InitPromotionPriorityFormData"/>
  </nodes>
<!--@Location 5,30-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode15">
<!--@BendPoints 11,62-->
    <nodeSuccessors name="next" next="DecisionNode12"/>
    <startNode referencedName="ViewPromotion-InitCombination"/>
  </nodes>
<!--@Location 5,31-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode12" conditionKey="Promotion:Unlimited"
      operator="str_eq" conditionValue="true">
<!--@BendPoints 11,64-->
    <nodeSuccessors name="decision_yes" next="SetFormParameterValue13"/>
<!--@BendPoints 13,63 13,64-->
    <nodeSuccessors name="decision_no" next="SetFormParameterValue1"/>
  </nodes>
<!--@Location 5,32-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue13">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode27"/>
    <parameterBindings name="FormParameter" objectPath="PromotionForm:Unlimited"/>
    <parameterBindings name="Value" objectPath="Promotion:Unlimited"/>
  </nodes>
<!--@Location 5,33-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode27">
<!--@BendPoints 11,68 10,69-->
    <nodeSuccessors name="next" next="DecisionNode3"/>
  </nodes>
<!--There exists no budget to the current promotion.
@Location 5,34-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode3" conditionKey="Promotion:BudgetID">
<!--@BendPoints 13,69-->
    <nodeSuccessors name="decision_yes" next="CallNode18"/>
    <nodeSuccessors name="decision_no" next="SetFormParameterValue26"/>
  </nodes>
<!--@Location 6,35-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode18">
<!--@BendPoints 13,73-->
    <nodeSuccessors name="next" next="JoinNode9"/>
    <startNode referencedName="ViewPromotion-InitBudgetFormData"/>
  </nodes>
<!--@Location 5,36-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode9">
    <nodeSuccessors name="next" next="DecisionNode6"/>
  </nodes>
<!--@Location 5,37-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode6" conditionKey="Promotion:Currency">
    <nodeSuccessors name="decision_yes" next="SetFormParameterValue5"/>
<!--@BendPoints 13,75 13,76-->
    <nodeSuccessors name="decision_no" next="SetFormParameterValue4"/>
  </nodes>
<!--@Location 5,38-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue5">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode13"/>
    <parameterBindings name="FormParameter" objectPath="PromotionForm:Currency"/>
    <parameterBindings name="Value" objectPath="Promotion:Currency:Mnemonic"/>
  </nodes>
<!--@Location 5,39-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode13">
<!--@BendPoints 11,80-->
    <nodeSuccessors name="next" next="EndNode2"/>
  </nodes>
<!--@Location 5,40-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode2" strict="true">
    <returnValues name="PromotionForm" type="com.intershop.beehive.core.capi.webform.Form"/>
    <returnValues name="AvailableCombinationTypes" type="java.util.Iterator"/>
  </nodes>
<!--@Location 6,38-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue4">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
<!--@BendPoints 13,79-->
    <nodeSuccessors name="next" next="JoinNode13"/>
    <parameterBindings name="FormParameter" objectPath="PromotionForm:Currency"/>
    <parameterBindings name="Value" constant=".All."/>
  </nodes>
<!--@Location 5,35-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue26">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode9"/>
    <parameterBindings name="FormParameter" objectPath="PromotionForm:BudgetAmount"/>
    <parameterBindings name="Value" constant=""/>
  </nodes>
<!--@Location 6,32-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue1">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
<!--@BendPoints 13,67-->
    <nodeSuccessors name="next" next="JoinNode27"/>
    <parameterBindings name="FormParameter" objectPath="PromotionForm:Unlimited"/>
    <parameterBindings name="Value" objectPath="Promotion:Unlimited"/>
  </nodes>
<!--@Location 10,24-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode9" strict="true" name="InitPromotionPriorityFormData"
      callMode="Private">
<!--@BendPoints 21,50-->
    <nodeSuccessors name="next" next="SetFormParameterValue6"/>
    <parameters name="PromotionForm" type="com.intershop.beehive.core.capi.webform.Form"/>
    <parameters name="Promotion" type="com.intershop.component.marketing.capi.rebate.Promotion"/>
  </nodes>
<!--@Location 10,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue6">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
<!--@BendPoints 21,52-->
    <nodeSuccessors name="next" next="SetFormParameterValue11"/>
    <parameterBindings name="FormParameter" objectPath="PromotionForm:Rank"/>
    <parameterBindings name="Value" objectPath="Promotion:Rank"/>
  </nodes>
<!--@Location 10,26-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue11">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
<!--@BendPoints 21,54-->
    <nodeSuccessors name="next" next="EndNode4"/>
    <parameterBindings name="FormParameter" objectPath="PromotionForm:RankSelection"/>
    <parameterBindings name="Value" objectPath="Promotion:HasDefaultRank"/>
  </nodes>
<!--@Location 10,27-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode4" strict="true">
    <returnValues name="PromotionForm" type="com.intershop.beehive.core.capi.webform.Form"/>
  </nodes>
<!--@Location 26,24-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode34" strict="true" name="InvalidatePageCache"
      callMode="Private">
    <nodeSuccessors name="next" next="DecisionNode24"/>
    <parameters name="Site" type="com.intershop.beehive.core.capi.domain.Domain"/>
    <parameters name="Promotion" type="com.intershop.component.marketing.capi.rebate.Promotion"
        optional="true"/>
    <parameters name="PromotionBO" type="com.intershop.component.promotion.capi.PromotionBO"
        optional="true"/>
    <parameters name="AdditionalKeywords" type="java.util.Collection&lt;java.lang.String>"
        optional="true"/>
    <parameters name="PromotionBORepository" type="com.intershop.component.promotion.capi.PromotionBORepository"
        optional="true"/>
  </nodes>
<!--@Location 26,25-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode24" conditionKey="PromotionBO">
    <nodeSuccessors name="decision_yes" next="AddObjectToCollection0"/>
    <nodeSuccessors name="decision_no" next="GetPromotionBOByID0"/>
  </nodes>
<!--@Location 26,26-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToCollection0">
    <pipelet href="enfinity:/core/pipelets/AddObjectToCollection.xml"/>
    <nodeSuccessors name="next" next="InvalidatePageCache0"/>
    <parameterBindings name="InCollection" objectPath="AdditionalKeywords"/>
    <parameterBindings name="InObject" objectPath="PromotionBO:PromotionID"/>
    <returnValueBindings name="OutIterator" objectPath="Keywords"/>
  </nodes>
<!--@Location 26,27-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="InvalidatePageCache0">
    <pipelet href="enfinity:/bc_foundation/pipelets/InvalidatePageCache.xml"/>
    <nodeSuccessors name="next" next="JoinNode34"/>
  </nodes>
<!--@Location 26,28-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode34">
    <nodeSuccessors name="next" next="EndNode0"/>
  </nodes>
<!--@Location 26,29-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode0" strict="true"/>
<!--@Location 27,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetPromotionBOByID0">
    <pipelet href="enfinity:/bc_promotion/pipelets/GetPromotionBOByID.xml"/>
<!--@BendPoints 55,53-->
    <nodeSuccessors name="next" next="AddObjectToCollection0"/>
<!--@BendPoints 56,51 56,57-->
    <nodeSuccessors name="pipelet_error" next="JoinNode34"/>
    <parameterBindings name="ID" objectPath="Promotion:ID"/>
    <returnValueBindings name="Promotion" objectPath="PromotionBO"/>
  </nodes>
<!--@Location 3,7-->
  <nodes xsi:type="pipeline:StartNode" nodeID="Start2" name="JumpToList">
    <nodeSuccessors name="next" next="GetPageLocator2"/>
  </nodes>
<!--@Location 3,8-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetPageLocator2">
    <configurationValues name="DefaultPageLocatorName" value="PromotionList"/>
    <configurationValues name="RestorePageLocatorDictionary" value="False"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetPageLocator.xml"/>
    <nodeSuccessors name="next" next="Jump5"/>
<!--@BendPoints 9,17 9,18-->
    <nodeSuccessors name="pipelet_error" next="Jump3"/>
  </nodes>
<!--@Location 3,9-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="Jump5" callModePermissions="Private">
    <startNode objectPath="PageLocator:Pipeline"/>
  </nodes>
<!--@Location 4,9-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="Jump3">
    <startNode referencedName="ViewPromotionList-ListAll"/>
  </nodes>
<!--@Location 12,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode12" name="New">
    <nodeSuccessors name="next" next="Call6"/>
  </nodes>
<!--@Location 12,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call6">
    <nodeSuccessors name="next" next="GetLocale1"/>
    <startNode referencedName="This:Prefix"/>
  </nodes>
<!--@Location 12,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetLocale1">
    <configurationValues name="LocaleFallback" value="Lead Locale"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetLocale.xml"/>
    <nodeSuccessors name="next" next="CreateForm4"/>
    <parameterBindings name="LocaleId" objectPath="LocaleID"/>
    <returnValueBindings name="Locale" objectPath="SelectedLocale"/>
  </nodes>
<!--@Location 12,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateForm4">
    <configurationValues name="FormName" value="GeneralPromotionInformation"/>
    <configurationValues name="FormResource" value="GeneralPromotionInformation"/>
    <pipelet href="enfinity:/core/pipelets/CreateForm.xml"/>
    <nodeSuccessors name="next" next="CallNode19"/>
    <returnValueBindings name="Form" objectPath="PromotionForm"/>
  </nodes>
<!--@Location 12,6-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode19">
    <nodeSuccessors name="next" next="CallNode37"/>
    <parameterBindings name="BudgetNotificationEmail" objectPath="CurrentUserProfile:BasicCredentials:ReminderEmail"/>
    <parameterBindings name="CurrencyMnemonic" objectPath="CurrencyMnemonic"/>
    <startNode referencedName="ViewPromotion-InitNewPromotionForm"/>
  </nodes>
<!--@Location 12,7-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode37">
    <nodeSuccessors name="next" next="JoinNode40"/>
    <startNode referencedName="ViewPromotion-SetDefaultSelectionInPromotionAppAssignmentForm"/>
  </nodes>
<!--@Location 16,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode33" name="NewWithTemplate"
      secure="true">
    <nodeSuccessors name="next" next="PrepareApplicationView0"/>
  </nodes>
<!--@Location 16,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="PrepareApplicationView0">
    <configurationValues name="WorkingTemplate" value="marketing/CreatePromotionWithTemplate.isml"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/PrepareApplicationView.xml"/>
    <nodeSuccessors name="next" next="InteractionNode0"/>
  </nodes>
<!--@Location 16,3-->
  <nodes xsi:type="pipeline:InteractionNode" nodeID="InteractionNode0">
    <template referencedName="application/ApplicationFrame.isml"/>
  </nodes>
<!--@Location 0,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="Start1" name="Prefix" callMode="Private">
    <nodeSuccessors name="next" next="DecisionNode11"/>
  </nodes>
<!--@Location 0,1-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode11" conditionKey="PrefixDone"
      operator="undef">
    <nodeSuccessors name="decision_yes" next="Decision4"/>
<!--@BendPoints 2,3-->
    <nodeSuccessors name="decision_no" next="EndNode3"/>
  </nodes>
<!--@Location 0,2-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="Decision4" conditionKey="Rebate"
      operator="undef">
    <nodeSuccessors name="decision_yes" next="Decision5"/>
<!--@BendPoints 3,5-->
    <nodeSuccessors name="decision_no" next="JoinNode15"/>
  </nodes>
<!--@Location 0,3-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="Decision5" conditionKey="RebateUUID">
    <nodeSuccessors name="decision_yes" next="Pipelet2"/>
    <nodeSuccessors name="decision_no" next="JoinNode15"/>
  </nodes>
<!--@Location 0,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="Pipelet2">
    <pipelet href="enfinity:/bc_marketing/pipelets/GetRebateByUUID.xml"/>
    <nodeSuccessors name="next" next="KeyMapper1"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode33"/>
  </nodes>
<!--@Location 0,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper1">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
<!--@BendPoints 1,13-->
    <nodeSuccessors name="next" next="Join2"/>
    <parameterBindings name="InValue_1" objectPath="Rebate:Promotion"/>
    <returnValueBindings name="OutValue_1" objectPath="Promotion"/>
  </nodes>
<!--@Location 1,6-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="Join2">
<!--@BendPoints 3,14 1,14-->
    <nodeSuccessors name="next" next="Decision1"/>
  </nodes>
<!--@Location 0,7-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="Decision1" conditionKey="Promotion"
      operator="undef">
    <nodeSuccessors name="decision_yes" next="Decision2"/>
<!--@BendPoints 3,15 4,23-->
    <nodeSuccessors name="decision_no" next="Join1"/>
  </nodes>
<!--@Location 0,8-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="Decision2" conditionKey="PromotionUUID">
    <nodeSuccessors name="decision_yes" next="GetPromotionByUUID1"/>
<!--@BendPoints 3,17-->
    <nodeSuccessors name="decision_no" next="JoinNode32"/>
  </nodes>
<!--@Location 0,9-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetPromotionByUUID1">
    <pipelet href="enfinity:/bc_marketing/pipelets/GetPromotionByUUID.xml"/>
    <nodeSuccessors name="next" next="GetFirstElementOfIterator1"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode32"/>
  </nodes>
<!--@Location 0,10-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetFirstElementOfIterator1">
    <pipelet href="enfinity:/bc_foundation/pipelets/GetFirstElementOfIterator.xml"/>
<!--@BendPoints 1,23-->
    <nodeSuccessors name="next" next="Join1"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode31"/>
    <parameterBindings name="Iterator" objectPath="Promotion:Rebates"/>
    <returnValueBindings name="FirstElement" objectPath="Rebate"/>
  </nodes>
<!--@Location 1,11-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="Join1">
<!--@BendPoints 3,24-->
    <nodeSuccessors name="next" next="GetLocale4"/>
  </nodes>
<!--@Location 1,12-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetLocale4">
    <configurationValues name="LocaleFallback" value="Lead Locale"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetLocale.xml"/>
    <nodeSuccessors name="next" next="SetDictionaryValue1"/>
    <parameterBindings name="LocaleId" objectPath="LocaleID"/>
    <returnValueBindings name="Locale" objectPath="SelectedLocale"/>
  </nodes>
<!--@Location 1,13-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetDictionaryValue1">
    <configurationValues name="Name" value="PrefixDone"/>
    <configurationValues name="Value" value="true"/>
    <configurationValues name="ValueType" value="Dictionary Value"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetDictionaryValue.xml"/>
    <nodeSuccessors name="next" next="KeyMapper12"/>
  </nodes>
<!--@Location 1,14-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper12">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="GetCurrency0"/>
    <parameterBindings name="InValue_1" objectPath="ApplicationBO:Repository(&quot;PromotionBORepository&quot;):PromotionActionPriorityHandler:SortedDescriptorsByPriority"/>
    <parameterBindings name="InValue_2" objectPath="ApplicationBO:Repository(&quot;PromotionBORepository&quot;):PromotionActionPriorityHandler"/>
    <parameterBindings name="InValue_3" objectPath="CurrentRequest:CurrencyCode"/>
    <returnValueBindings name="OutValue_1" objectPath="ActionDescriptors"/>
    <returnValueBindings name="OutValue_2" objectPath="PromotionActionPriorityHandler"/>
    <returnValueBindings name="OutValue_3" objectPath="CurrencyMnemonic"/>
  </nodes>
<!--@Location 1,15-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetCurrency0">
    <pipelet href="enfinity:/bc_foundation/pipelets/GetCurrency.xml"/>
    <nodeSuccessors name="next" next="End1"/>
<!--@BendPoints 5,31-->
    <nodeSuccessors name="pipelet_error" next="KeyMapper3"/>
    <parameterBindings name="Mnemonic" objectPath="CurrencyMnemonic"/>
  </nodes>
<!--@Location 1,17-->
  <nodes xsi:type="pipeline:EndNode" nodeID="End1"/>
<!--@Location 2,16-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper3">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
<!--@BendPoints 6,34 4,34-->
    <nodeSuccessors name="next" next="End1"/>
    <parameterBindings name="InValue_1" objectPath="ApplicationBO:DefaultCurrency:Mnemonic"/>
    <parameterBindings name="InValue_10" nullBinding="true"/>
    <parameterBindings name="InValue_2" nullBinding="true"/>
    <parameterBindings name="InValue_3" nullBinding="true"/>
    <parameterBindings name="InValue_4" nullBinding="true"/>
    <parameterBindings name="InValue_5" nullBinding="true"/>
    <parameterBindings name="InValue_6" nullBinding="true"/>
    <parameterBindings name="InValue_7" nullBinding="true"/>
    <parameterBindings name="InValue_8" nullBinding="true"/>
    <parameterBindings name="InValue_9" nullBinding="true"/>
    <returnValueBindings name="OutValue_1" objectPath="DefaultCurrencyMnemonic"/>
    <returnValueBindings name="OutValue_10" nullBinding="true"/>
    <returnValueBindings name="OutValue_2" nullBinding="true"/>
    <returnValueBindings name="OutValue_3" nullBinding="true"/>
    <returnValueBindings name="OutValue_4" nullBinding="true"/>
    <returnValueBindings name="OutValue_5" nullBinding="true"/>
    <returnValueBindings name="OutValue_6" nullBinding="true"/>
    <returnValueBindings name="OutValue_7" nullBinding="true"/>
    <returnValueBindings name="OutValue_8" nullBinding="true"/>
    <returnValueBindings name="OutValue_9" nullBinding="true"/>
  </nodes>
<!--@Location 1,10-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode31">
    <nodeSuccessors name="next" next="Join1"/>
  </nodes>
<!--@Location 1,9-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode32">
    <nodeSuccessors name="next" next="JoinNode31"/>
  </nodes>
<!--@Location 1,4-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode33">
    <nodeSuccessors name="next" next="Join2"/>
  </nodes>
<!--@Location 1,3-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode15">
    <nodeSuccessors name="next" next="JoinNode33"/>
  </nodes>
<!--@Location 1,1-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode3"/>
<!--@Location 38,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode31" name="PreviewPromotion">
    <nodeSuccessors name="next" next="CallNode9"/>
  </nodes>
<!--@Location 38,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode9">
    <nodeSuccessors name="next" next="JoinNode1"/>
    <startNode referencedName="ProcessReturnTarget-PutPreviewContextPipeline"/>
  </nodes>
<!--@Location 30,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode25" name="RemoveFromCampaign">
    <nodeSuccessors name="next" next="CallNode30"/>
  </nodes>
<!--@Location 30,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode30">
    <nodeSuccessors name="next" next="JumpNode4"/>
    <startNode referencedName="ProcessPromotionCampaignAssignments-RemovePromotionFromCampaign"/>
  </nodes>
<!--@Location 30,2-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode4">
    <startNode referencedName="This:Edit"/>
  </nodes>
<!--@Location 36,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode27" name="SelectCampaign">
<!--@BendPoints 73,2-->
    <nodeSuccessors name="next" next="GetPromotionByUUID3"/>
<!--UUID of a promotion-->
    <parameters name="PromotionUUID" type="java.lang.String"/>
  </nodes>
<!--@Location 36,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetPromotionByUUID3">
    <pipelet href="enfinity:/bc_marketing/pipelets/GetPromotionByUUID.xml"/>
    <nodeSuccessors name="next" next="PrepareApplicationView3"/>
  </nodes>
<!--@Location 36,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="PrepareApplicationView3">
    <configurationValues name="SelectedMenuItem" value="OnlineMarketing"/>
    <configurationValues name="WorkingTemplate" value="marketing/PromotionCopy"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/PrepareApplicationView.xml"/>
<!--@BendPoints 73,6-->
    <nodeSuccessors name="next" next="InteractionEnd3"/>
    <parameterBindings name="WorkingTemplateSuffix" objectPath="CurrentChannel:TypeCode"/>
  </nodes>
<!--@Location 36,3-->
  <nodes xsi:type="pipeline:InteractionNode" nodeID="InteractionEnd3">
    <template referencedName="application/ApplicationFrame"/>
  </nodes>
<!--@Location 15,41-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode24" name="SetAppAssignmentInPromotionAppAssignmentForm"
      callMode="Private">
<!--@BendPoints 31,84-->
    <nodeSuccessors name="next" next="CallNode46"/>
  </nodes>
<!--@Location 15,42-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode46">
<!--@BendPoints 31,86-->
    <nodeSuccessors name="next" next="KeyMapper8"/>
    <startNode referencedName="ViewPromotion-CreatePromotionAppAssignmentForm"/>
  </nodes>
<!--@Location 15,43-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper8">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="LoopNode4"/>
    <parameterBindings name="InValue_1" objectPath="Promotion:createAppIDsIterator"/>
    <returnValueBindings name="OutValue_1" objectPath="AssignedAppIDs"/>
  </nodes>
<!--@Location 15,44-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode4" loop="AssignedAppIDs">
<!--@BendPoints 33,89 33,96-->
    <nodeSuccessors name="next" next="EndNode15"/>
    <entry key="AppUUID">
<!--@BendPoints 31,90-->
      <nodeSuccessors name="loop_entry_next" next="SetFormParameterValue12"/>
    </entry>
  </nodes>
<!--@Location 15,45-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue12">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
<!--@BendPoints 31,93 30,89-->
    <nodeSuccessors name="next" next="LoopNode4_Entry"/>
    <parameterBindings name="FormParameter" objectPath="PromotionAppAssignmentForm:get(AppUUID):Selection"/>
    <parameterBindings name="Value" constant="(Boolean)true"/>
  </nodes>
<!--@Location 15,48-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode15"/>
<!--@Location 4,41-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode22" name="SetDefaultSelectionInPromotionAppAssignmentForm"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode44"/>
  </nodes>
<!--@Location 4,42-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode44">
    <nodeSuccessors name="next" next="LoopNode1"/>
    <startNode referencedName="ViewPromotion-CreatePromotionAppAssignmentForm"/>
  </nodes>
<!--@Location 4,43-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode1" loop="Apps">
<!--@BendPoints 12,87-->
    <nodeSuccessors name="next" next="EndNode12"/>
    <entry key="App">
<!--@BendPoints 9,88-->
      <nodeSuccessors name="loop_entry_next" next="DecisionNode29"/>
    </entry>
  </nodes>
<!--@Location 4,44-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode29" conditionKey="App:Default">
    <nodeSuccessors name="decision_yes" next="DecisionNode30"/>
<!--@BendPoints 11,89-->
    <nodeSuccessors name="decision_no" next="JoinNode39"/>
  </nodes>
<!--@Location 4,45-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode30" conditionKey="App:Default"
      operator="str_eq" conditionValue="true">
<!--@BendPoints 9,92-->
    <nodeSuccessors name="decision_yes" next="SetFormParameterValue10"/>
    <nodeSuccessors name="decision_no" next="JoinNode39"/>
  </nodes>
<!--@Location 4,46-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue10">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode12"/>
    <parameterBindings name="FormParameter" objectPath="PromotionAppAssignmentForm:get(App:UUID):Selection"/>
    <parameterBindings name="Value" constant="(Boolean)true"/>
  </nodes>
<!--@Location 4,47-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode12">
<!--@BendPoints 8,95 8,87-->
    <nodeSuccessors name="next" next="LoopNode1_Entry"/>
  </nodes>
<!--@Location 5,45-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode39">
<!--@BendPoints 11,95-->
    <nodeSuccessors name="next" next="JoinNode12"/>
  </nodes>
<!--@Location 6,43-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode12"/>
<!--@Location 24,24-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode28" strict="true" name="SetFormErrors"
      callMode="Private">
    <nodeSuccessors name="next" next="SetFormError3"/>
<!--the error message will be set to targt object-->
    <parameters name="ErrorMsg" type="java.lang.String"/>
<!--the target object for the error message-->
    <parameters name="TargetObject" type="com.intershop.beehive.core.capi.webform.ValidationElement"/>
  </nodes>
<!--@Location 24,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormError3">
    <pipelet href="enfinity:/core/pipelets/SetFormError.xml"/>
    <nodeSuccessors name="next" next="EndNode18"/>
  </nodes>
<!--@Location 24,26-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode18" strict="true"/>
<!--@Location 9,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode7" name="SetLocaleEdit">
<!--@BendPoints 19,2-->
    <nodeSuccessors name="next" next="Call5"/>
  </nodes>
<!--@Location 9,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call5">
    <nodeSuccessors name="next" next="CallNode38"/>
    <startNode referencedName="This:Prefix"/>
  </nodes>
<!--@Location 9,2-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode38">
    <nodeSuccessors name="next" next="DecisionNode4"/>
    <startNode referencedName="ViewPromotion-ValidateAppAssignmentForm"/>
  </nodes>
<!--@Location 9,3-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode4" conditionKey="Promotion">
<!--@BendPoints 19,9-->
    <nodeSuccessors name="decision_yes" next="JoinNode22"/>
<!--@BendPoints 20,7 19,10-->
    <nodeSuccessors name="decision_no" next="CreateForm9"/>
  </nodes>
<!--@Location 9,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateForm9">
    <configurationValues name="FormName" value="GeneralPromotionInformation"/>
    <configurationValues name="FormResource" value="GeneralPromotionInformation"/>
    <pipelet href="enfinity:/core/pipelets/CreateForm.xml"/>
<!--@BendPoints 19,12-->
    <nodeSuccessors name="next" next="JumpNode1"/>
    <returnValueBindings name="Form" objectPath="PromotionForm"/>
  </nodes>
<!--@Location 9,6-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode1">
    <startNode referencedName="ViewPromotion-New"/>
  </nodes>
<!--@Location 4,10-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode14" name="SetLocaleEditWithinCopyDialog">
<!--@BendPoints 9,22-->
    <nodeSuccessors name="next" next="Call11"/>
  </nodes>
<!--@Location 4,11-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call11">
    <nodeSuccessors name="next" next="DecisionNode21"/>
    <startNode referencedName="This:Prefix"/>
  </nodes>
<!--@Location 4,12-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode21" conditionKey="Promotion">
<!--@BendPoints 9,28-->
    <nodeSuccessors name="decision_yes" next="JumpNode10"/>
<!--@BendPoints 11,25 11,26-->
    <nodeSuccessors name="decision_no" next="CreateForm6"/>
  </nodes>
<!--@Location 4,14-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode10">
    <startNode referencedName="ViewPromotion-CopyDialog"/>
  </nodes>
<!--@Location 5,13-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateForm6">
    <configurationValues name="FormName" value="GeneralPromotionInformation"/>
    <configurationValues name="FormResource" value="GeneralPromotionInformation"/>
    <pipelet href="enfinity:/core/pipelets/CreateForm.xml"/>
<!--@BendPoints 11,28-->
    <nodeSuccessors name="next" next="JumpNode9"/>
    <returnValueBindings name="Form" objectPath="PromotionForm"/>
  </nodes>
<!--@Location 5,14-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode9">
    <startNode referencedName="ViewPromotion-New"/>
  </nodes>
<!--@Location 18,41-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode30" name="ShowApplicationSelectionError"
      callMode="Private">
    <nodeSuccessors name="next" next="DecisionNode22"/>
  </nodes>
<!--@Location 18,42-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode22" conditionKey="Apps">
    <nodeSuccessors name="decision_yes" next="DecisionNode23"/>
<!--@BendPoints 41,85-->
    <nodeSuccessors name="decision_no" next="JoinNode8"/>
  </nodes>
<!--@Location 18,43-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode23" conditionKey="Apps"
      operator="has_elements">
    <nodeSuccessors name="decision_yes" next="LoopNode5"/>
    <nodeSuccessors name="decision_no" next="JoinNode8"/>
  </nodes>
<!--@Location 18,44-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode5" loop="Apps">
<!--@BendPoints 38,89-->
    <nodeSuccessors name="next" next="EndNode17"/>
    <entry key="App">
<!--@BendPoints 37,90-->
      <nodeSuccessors name="loop_entry_next" next="DecisionNode14"/>
    </entry>
  </nodes>
<!--@Location 18,45-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode14" conditionKey="PromotionAppAssignmentForm:get(App:UUID):Selection:Value"
      operator="str_neq" conditionValue="true">
<!--@BendPoints 37,92 36,89-->
    <nodeSuccessors name="decision_yes" next="LoopNode5_Entry"/>
    <nodeSuccessors name="decision_no" next="JoinNode18"/>
  </nodes>
<!--@Location 20,45-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode18">
<!--@BendPoints 41,93 39,93-->
    <nodeSuccessors name="next" next="EndNode16"/>
  </nodes>
<!--@Location 19,47-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode16" name="NO"/>
<!--@Location 19,44-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode17" name="YES"/>
<!--@Location 20,43-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode8">
    <nodeSuccessors name="next" next="JoinNode18"/>
  </nodes>
<!--@Location 14,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode20" name="ShowDefaultPriorities">
    <nodeSuccessors name="next" next="Call13"/>
  </nodes>
<!--@Location 14,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call13">
    <nodeSuccessors name="next" next="GetLocale5"/>
    <startNode referencedName="This:Prefix"/>
  </nodes>
<!--@Location 14,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetLocale5">
    <configurationValues name="LocaleFallback" value="Lead Locale"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetLocale.xml"/>
    <nodeSuccessors name="next" next="CreateForm8"/>
    <parameterBindings name="LocaleId" objectPath="LocaleID"/>
    <returnValueBindings name="Locale" objectPath="SelectedLocale"/>
  </nodes>
<!--@Location 14,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateForm8">
    <configurationValues name="FormName" value="GeneralPromotionInformation"/>
    <configurationValues name="FormResource" value="GeneralPromotionInformation"/>
    <pipelet href="enfinity:/core/pipelets/CreateForm.xml"/>
    <nodeSuccessors name="next" next="DecisionNode18"/>
    <returnValueBindings name="Form" objectPath="PromotionForm"/>
  </nodes>
<!--@Location 14,4-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode18" conditionKey="ShowDefaultPriorities">
    <nodeSuccessors name="decision_yes" next="RemoveDictionaryValue2"/>
<!--@BendPoints 31,9 31,10-->
    <nodeSuccessors name="decision_no" next="SetDictionaryValue3"/>
  </nodes>
<!--@Location 14,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemoveDictionaryValue2">
    <configurationValues name="Key" value="ShowDefaultPriorities"/>
    <configurationValues name="RemoveFormValues" value="true"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/RemoveDictionaryValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode21"/>
  </nodes>
<!--@Location 14,6-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode21">
    <nodeSuccessors name="next" next="FillForm3"/>
  </nodes>
<!--@Location 14,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="FillForm3">
    <pipelet href="enfinity:/core/pipelets/FillForm.xml"/>
    <nodeSuccessors name="next" next="CallNode49"/>
    <parameterBindings name="Form" objectPath="PromotionForm"/>
  </nodes>
<!--@Location 14,8-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode49">
<!--@BendPoints 29,23-->
    <nodeSuccessors name="next" next="JoinNode40"/>
    <startNode referencedName="ViewPromotion-ValidateAppAssignmentForm"/>
  </nodes>
<!--@Location 15,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetDictionaryValue3">
    <configurationValues name="Name" value="ShowDefaultPriorities"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetDictionaryValue.xml"/>
<!--@BendPoints 31,13-->
    <nodeSuccessors name="next" next="JoinNode21"/>
  </nodes>
<!--@Location 6,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode2" name="Update">
<!--@BendPoints 13,2-->
    <nodeSuccessors name="next" next="Call1"/>
  </nodes>
<!--@Location 6,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="Call1">
<!--@BendPoints 13,4-->
    <nodeSuccessors name="next" next="CallNode65"/>
    <startNode referencedName="This:Prefix"/>
  </nodes>
<!--@Location 6,2-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode65">
    <nodeSuccessors name="next" next="InvalidatePageLocatorPageable1"/>
<!--@BendPoints 15,5 15,13-->
    <nodeSuccessors name="Error" next="JoinNode42"/>
    <startNode referencedName="ViewPromotion-ValidateForm"/>
  </nodes>
<!--@Location 6,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="InvalidatePageLocatorPageable1">
    <configurationValues name="DefaultPageLocatorName" value="PromotionList"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/InvalidatePageLocatorPageable.xml"/>
    <nodeSuccessors name="next" next="CallNode33" action="begin"/>
  </nodes>
<!--@Location 6,4-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode33">
<!--@BendPoints 13,10-->
    <nodeSuccessors name="next" next="CallNode34"/>
    <parameterBindings name="LocaleId" objectPath="LocaleID"/>
    <parameterBindings name="PromotionActionPriorityHandler" objectPath="ApplicationBO:Repository(&quot;PromotionBORepository&quot;):PromotionActionPriorityHandler"/>
    <startNode referencedName="ProcessPromotion-UpdatePromotion"/>
  </nodes>
<!--@Location 6,5-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode34">
    <nodeSuccessors name="next" next="CallNode28" action="commit"/>
    <parameterBindings name="AccountTypeCode" constant="80"/>
    <parameterBindings name="BudgetNotificationEmail" objectPath="PromotionForm:BudgetNotificationEmail:Value"/>
    <parameterBindings name="BudgetNotificationThreshold" objectPath="PromotionForm:BudgetNotificationThreshold:Value"/>
    <parameterBindings name="BudgetSource" objectPath="PromotionForm:BudgetSource:Value"/>
    <parameterBindings name="BudgetTypeCode" constant="1"/>
    <parameterBindings name="DisableByBudget" objectPath="PromotionForm:DisableByBudget:Value"/>
    <parameterBindings name="EndDate" objectPath="PromotionForm:EndDate:Value"/>
    <parameterBindings name="Locale" objectPath="SelectedLocale"/>
    <parameterBindings name="Scope" nullBinding="true"/>
    <parameterBindings name="ScopeType" nullBinding="true"/>
    <parameterBindings name="SendMailIfBudgetReached" objectPath="PromotionForm:SendMailIfBudgetReached:Value"/>
    <parameterBindings name="SendMailIfThresholdReached" objectPath="PromotionForm:SendMailIfThresholdReached:Value"/>
    <parameterBindings name="StartDate" objectPath="PromotionForm:StartDate:Value"/>
    <parameterBindings name="Unlimited" objectPath="PromotionForm:Unlimited:Value"/>
    <startNode referencedName="ProcessPromotionBudget-SetBudget"/>
  </nodes>
<!--@Location 6,6-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode28">
    <nodeSuccessors name="next" next="CallNode11"/>
    <parameterBindings name="Repository" objectPath="ChannelRepository"/>
    <startNode referencedName="ProcessPromotion-UpdateAssignments"/>
  </nodes>
<!--@Location 6,7-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode11">
    <nodeSuccessors name="next" next="CallNode51"/>
    <parameterBindings name="Iterator" nullBinding="true"/>
    <startNode referencedName="ProcessPromotion-TouchPromotion"/>
  </nodes>
<!--@Location 6,8-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode51">
    <nodeSuccessors name="next" next="CallNode16"/>
    <parameterBindings name="PromotionBORepository" objectPath="ApplicationBO:Repository(&quot;PromotionBORepository&quot;)"/>
    <parameterBindings name="Site" objectPath="ChannelRepository:RepositoryDomain:Site"/>
    <startNode referencedName="This:InvalidatePageCache"/>
  </nodes>
<!--@Location 6,9-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode16">
    <nodeSuccessors name="next" next="GetFormSelection0"/>
    <startNode referencedName="ViewPromotion-UpdateAppAssignments"/>
  </nodes>
<!--@Location 6,13-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetFormSelection0">
    <pipelet href="enfinity:/bc_foundation/pipelets/GetFormSelection.xml"/>
    <nodeSuccessors name="next" next="JumpNode5"/>
    <parameterBindings name="ParameterName" constant="CombinationTypesToAdd"/>
    <returnValueBindings name="Selection" objectPath="CombinationTypesToAddSelection"/>
  </nodes>
<!--@Location 6,14-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode5">
    <startNode referencedName="This:Edit"/>
  </nodes>
<!--@Location 11,41-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode23" name="UpdateAppAssignments"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode29"/>
    <parameters name="Apps" type="com.intershop.beehive.foundation.util.ResettableIterator&lt;E>"
        optional="true"/>
    <parameters name="CurrentChannel" type="com.intershop.component.mvc.capi.catalog.Repository"
        optional="true"/>
    <parameters name="PromotionAppAssignmentForm" type="com.intershop.beehive.core.capi.webform.Form"
        optional="true"/>
  </nodes>
<!--@Location 11,42-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode29">
    <nodeSuccessors name="next" next="LoopNode2"/>
    <parameterBindings name="Channel" objectPath="CurrentChannel"/>
    <startNode referencedName="ProcessPromotion-GetPromotionDomainByChannel"/>
  </nodes>
<!--@Location 11,43-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode2" loop="Apps">
<!--@BendPoints 24,87 27,95 23,95-->
    <nodeSuccessors name="next" next="EndNode14"/>
    <entry key="App">
<!--@BendPoints 23,88-->
      <nodeSuccessors name="loop_entry_next" next="DecisionNode15"/>
    </entry>
  </nodes>
<!--@Location 11,44-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode15" conditionKey="PromotionAppAssignmentForm:get(App:UUID):Selection:Value"
      operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="AssignPromotionToApplication1"/>
<!--@BendPoints 25,89-->
    <nodeSuccessors name="decision_no" next="UnassignPromotionFromApplication1"/>
  </nodes>
<!--@Location 11,45-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AssignPromotionToApplication1">
    <pipelet href="enfinity:/bc_marketing/pipelets/AssignPromotionToApplication.xml"/>
    <nodeSuccessors name="next" next="JoinNode14"/>
    <parameterBindings name="Application" objectPath="App"/>
    <parameterBindings name="Domain" objectPath="PromotionDomain"/>
  </nodes>
<!--@Location 11,46-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode14">
<!--@BendPoints 21,93 21,87-->
    <nodeSuccessors name="next" next="LoopNode2_Entry"/>
  </nodes>
<!--@Location 12,45-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UnassignPromotionFromApplication1">
    <pipelet href="enfinity:/bc_marketing/pipelets/UnassignPromotionFromApplication.xml"/>
<!--@BendPoints 25,93 24,93-->
    <nodeSuccessors name="next" next="JoinNode14"/>
    <parameterBindings name="Application" objectPath="App"/>
    <parameterBindings name="Domain" objectPath="PromotionDomain"/>
  </nodes>
<!--@Location 11,48-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode14"/>
<!--@Location 7,41-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode21" name="ValidateAppAssignmentForm"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode45"/>
  </nodes>
<!--@Location 7,42-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode45">
    <nodeSuccessors name="next" next="DecisionNode16"/>
    <startNode referencedName="ViewPromotion-CreatePromotionAppAssignmentForm"/>
  </nodes>
<!--@Location 7,43-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode16" conditionKey="Apps"
      operator="has_elements">
    <nodeSuccessors name="decision_yes" next="ValidateForm5"/>
<!--@BendPoints 17,87 17,93-->
    <nodeSuccessors name="decision_no" next="JoinNode23"/>
  </nodes>
<!--@Location 7,44-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ValidateForm5">
    <pipelet href="enfinity:/core/pipelets/ValidateForm.xml"/>
    <nodeSuccessors name="next" next="JoinNode20"/>
<!--@BendPoints 16,89 16,91-->
    <nodeSuccessors name="pipelet_error" next="JoinNode20"/>
    <parameterBindings name="Form" objectPath="PromotionAppAssignmentForm"/>
  </nodes>
<!--@Location 7,45-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode20">
    <nodeSuccessors name="next" next="JoinNode23"/>
  </nodes>
<!--@Location 7,46-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode23">
<!--@BendPoints 15,94-->
    <nodeSuccessors name="next" next="EndNode13"/>
  </nodes>
<!--@Location 7,47-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode13"/>
<!--@displayNearNode@This node validates all form fields using
 the validation framework and performs 
 some additional checks to find all form 
errors. If an error has occured, the 
execution paths leaves via the ERROR exit, 
otherwise it uses the normal one.
@Location 22,41-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode32" name="ValidateForm" callMode="Private">
<!--@BendPoints 45,84-->
    <nodeSuccessors name="next" next="CreateForm11"/>
  </nodes>
<!--@Location 22,42-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateForm11">
    <configurationValues name="FormName" value="GeneralPromotionInformation"/>
    <configurationValues name="FormResource" value="GeneralPromotionInformation"/>
    <pipelet href="enfinity:/core/pipelets/CreateForm.xml"/>
<!--@BendPoints 45,86-->
    <nodeSuccessors name="next" next="ValidateForm6"/>
    <returnValueBindings name="Form" objectPath="PromotionForm"/>
  </nodes>
<!--@Location 22,43-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ValidateForm6">
    <pipelet href="enfinity:/core/pipelets/ValidateForm.xml"/>
    <nodeSuccessors name="next" next="JoinNode44"/>
<!--@BendPoints 46,87 46,89-->
    <nodeSuccessors name="pipelet_error" next="JoinNode44"/>
    <parameterBindings name="Form" objectPath="PromotionForm"/>
  </nodes>
<!--@Location 22,44-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode44">
    <nodeSuccessors name="next" next="CallNode72"/>
  </nodes>
<!--@Location 22,45-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode72">
    <nodeSuccessors name="next" next="CallNode74"/>
    <startNode referencedName="ViewPromotion-ValidateAppAssignmentForm"/>
  </nodes>
<!--@Location 22,46-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode74">
    <nodeSuccessors name="NO" next="DecisionNode27"/>
    <nodeSuccessors name="YES" next="CallNode76"/>
    <startNode referencedName="ViewPromotion-ShowApplicationSelectionError"/>
  </nodes>
<!--@Location 22,48-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode27" conditionKey="PromotionForm:BudgetAmount:isInvalid"
      operator="str_eq" conditionValue="false">
<!--@BendPoints 45,98-->
    <nodeSuccessors name="decision_yes" next="CallNode73"/>
<!--@BendPoints 47,97 47,102-->
    <nodeSuccessors name="decision_no" next="CallNode75"/>
  </nodes>
<!--@Location 22,49-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode73">
<!--@BendPoints 45,101 45,102-->
    <nodeSuccessors name="Budget" next="DecisionNode28"/>
<!--@BendPoints 46,100-->
    <nodeSuccessors name="Error" next="CallNode75"/>
<!--@BendPoints 44,100 44,109-->
    <nodeSuccessors name="NoBudget" next="JoinNode35"/>
    <parameterBindings name="BudgetAmount" objectPath="PromotionForm:BudgetAmount:Value"/>
    <parameterBindings name="BudgetAmountAsLocalizedString" objectPath="PromotionForm:BudgetAmount:FormattedValue"/>
    <parameterBindings name="CurrencyMnemonic" objectPath="PromotionForm:Currency:Value"/>
    <parameterBindings name="Unlimited" objectPath="PromotionForm:Unlimited:Value"/>
    <startNode referencedName="ProcessPromotionBudget-VerifyBudgetData"/>
  </nodes>
<!--@Location 22,51-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode28" conditionKey="Promotion">
<!--@BendPoints 45,104-->
    <nodeSuccessors name="decision_yes" next="CallNode71"/>
<!--@BendPoints 46,103 46,108-->
    <nodeSuccessors name="decision_no" next="JoinNode35"/>
  </nodes>
<!--@Location 22,52-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode71">
<!--@BendPoints 45,106-->
    <nodeSuccessors name="NO" next="CallNode70"/>
<!--@BendPoints 44,106 44,108-->
    <nodeSuccessors name="YES" next="JoinNode35"/>
    <parameterBindings name="BudgetAmountNew" objectPath="BudgetAmount"/>
    <parameterBindings name="Enabled" objectPath="PromotionForm:Enabled:Value"/>
    <startNode referencedName="ProcessPromotionBudget-CheckPromotionActivationAllowed"/>
  </nodes>
<!--@Location 22,53-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode70">
    <nodeSuccessors name="next" next="JoinNode35"/>
    <parameterBindings name="ErrorMsg" constant="error.BudgetExhausted"/>
    <parameterBindings name="TargetObject" objectPath="PromotionForm:Enabled"/>
    <startNode referencedName="ViewPromotion-SetFormErrors"/>
  </nodes>
<!--@Location 22,54-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode35">
    <nodeSuccessors name="next" next="DecisionNode9"/>
  </nodes>
<!--@Location 22,55-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode9" conditionKey="PromotionAppAssignmentForm:Invalid"
      operator="str_eq" conditionValue="false">
    <nodeSuccessors name="decision_yes" next="DecisionNode26"/>
<!--@BendPoints 47,111 47,114-->
    <nodeSuccessors name="decision_no" next="EndNode20"/>
  </nodes>
<!--@Location 22,56-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode26" conditionKey="PromotionForm:Invalid"
      operator="str_eq" conditionValue="false">
<!--@BendPoints 45,114-->
    <nodeSuccessors name="decision_yes" next="EndNode19"/>
<!--@BendPoints 46,113-->
    <nodeSuccessors name="decision_no" next="EndNode20"/>
  </nodes>
<!--@Location 22,57-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode19"/>
<!--@Location 23,57-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode20" name="Error"/>
<!--@Location 23,51-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode75">
<!--@BendPoints 47,109-->
    <nodeSuccessors name="next" next="JoinNode35"/>
    <parameterBindings name="ErrorMsg" constant="error.BudgetAmount"/>
    <parameterBindings name="TargetObject" objectPath="PromotionForm:BudgetAmount"/>
    <startNode referencedName="ViewPromotion-SetFormErrors"/>
  </nodes>
<!--@Location 23,47-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode76">
    <nodeSuccessors name="next" next="DecisionNode27"/>
    <parameterBindings name="ErrorMsg" constant="error.Application"/>
    <parameterBindings name="TargetObject" objectPath="PromotionAppAssignmentForm"/>
    <startNode referencedName="ViewPromotion-SetFormErrors"/>
  </nodes>
</pipeline:Pipeline>
