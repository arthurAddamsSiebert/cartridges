<?xml version="1.0" encoding="UTF-8"?>
<!--Handles promotion templates
@Group OnlineMarketing-->

<pipeline:Pipeline xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:pipeline="http://www.intershop.de/pipeline/2010"
    name="ViewPromotionTemplate" type="view">
<!--@Location 10,22-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode16" name="AssignTargetGroup"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode6"/>
  </nodes>
<!--@Location 10,23-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode6">
    <nodeSuccessors name="next" next="GetUserGroupByID1"/>
    <startNode referencedName="ProcessOrganization_52-GetConsumerOrg"/>
  </nodes>
<!--@Location 10,24-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetUserGroupByID1">
    <configurationValues name="DefaultUserGroupID" value="Everyone"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetUserGroupByID.xml"/>
    <nodeSuccessors name="next" next="CheckPromotionUserGroup_PDF2oNBdEeeVBKcMfrKtAw"/>
<!--@BendPoints 23,49 23,55-->
    <nodeSuccessors name="pipelet_error" next="JoinNode_Osmz0NBeEeeVBKcMfrKtAw"/>
    <parameterBindings name="Domain" objectPath="Organization:OrganizationDomain:Domain"/>
    <parameterBindings name="UserGroupID" objectPath="PromotionForm:TargetGroup:Value"/>
  </nodes>
<!--@Location 10,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CheckPromotionUserGroup_PDF2oNBdEeeVBKcMfrKtAw">
    <pipelet href="enfinity:/sld_ch_base/pipelets/CheckPromotionUserGroup.xml"/>
    <nodeSuccessors name="next" next="AddUserGroupToPromotionTargetGroup1"/>
<!--@BendPoints 22,51 22,54-->
    <nodeSuccessors name="pipelet_error" next="JoinNode_Osmz0NBeEeeVBKcMfrKtAw"/>
    <parameterBindings name="ApplicationBORepository" objectPath="ApplicationBO:Repository(&quot;ApplicationBORepository&quot;)"/>
  </nodes>
<!--@Location 10,26-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddUserGroupToPromotionTargetGroup1">
    <pipelet href="enfinity:/bc_marketing/pipelets/AddUserGroupToPromotionTargetGroup.xml"/>
    <nodeSuccessors name="next" next="JoinNode_Osmz0NBeEeeVBKcMfrKtAw"/>
    <parameterBindings name="UserGroup" objectPath="UserGroup"/>
  </nodes>
<!--@Location 10,27-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode_Osmz0NBeEeeVBKcMfrKtAw">
    <nodeSuccessors name="next" next="EndNode_VdJTgNBeEeeVBKcMfrKtAw"/>
  </nodes>
<!--@Location 10,28-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode_VdJTgNBeEeeVBKcMfrKtAw"/>
<!--@Location 5,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode8" name="Create">
    <nodeSuccessors name="next" next="CallNode17"/>
  </nodes>
<!--@Location 5,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode17">
    <nodeSuccessors name="next" next="GetPromotionTemplateByName0"/>
    <startNode referencedName="This:Prefix"/>
  </nodes>
<!--@Location 5,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetPromotionTemplateByName0">
    <pipelet href="enfinity:/bc_marketing/pipelets/GetPromotionTemplateByName.xml"/>
    <nodeSuccessors name="next" next="DecisionNode19"/>
    <parameterBindings name="TemplateName" objectPath="promotionTemplate"/>
  </nodes>
<!--@Location 5,3-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode19" conditionKey="TemplateConfig">
    <nodeSuccessors name="decision_yes" next="CreateFreeShippinngDefaultConfiguration0"/>
    <nodeSuccessors name="decision_no" next="LogMessage3"/>
  </nodes>
<!--@Location 5,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateFreeShippinngDefaultConfiguration0">
    <pipelet href="enfinity:/bc_marketing/pipelets/ReadDefaultPromotionConfiguration.xml"/>
    <nodeSuccessors name="next" next="CallNode16"/>
    <parameterBindings name="ConfigurationFile" objectPath="TemplateConfig:CreationTemplate"/>
    <parameterBindings name="ConfigurationFilePath" objectPath="TemplateConfig:CreationTemplatePath"/>
  </nodes>
<!--@Location 5,5-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode16">
    <nodeSuccessors name="next" next="CallNode0"/>
    <nodeSuccessors name="Error" next="JoinNode7"/>
    <startNode referencedName="ViewPromotionTemplate-ValidateForm"/>
  </nodes>
<!--@Location 5,6-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode0">
    <nodeSuccessors name="next" next="CallNode15"/>
    <startNode referencedName="ViewPromotionTemplate-SetPromotionDefaultValues"/>
  </nodes>
<!--@Location 5,7-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode15">
    <nodeSuccessors name="next" next="CallNode14"/>
    <startNode referencedName="This:GetSelectedCurrency"/>
  </nodes>
<!--@Location 5,8-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode14">
    <nodeSuccessors name="next" next="CreatePromotion0" action="begin"/>
    <parameterBindings name="Channel" objectPath="CurrentChannel"/>
    <startNode referencedName="ProcessPromotion-GetPromotionDomainByChannel"/>
  </nodes>
<!--@Location 5,9-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreatePromotion0">
    <pipelet href="enfinity:/bc_marketing/pipelets/CreatePromotion.xml"/>
    <nodeSuccessors name="next" next="CallNode4"/>
<!--@BendPoints 13,19-->
    <nodeSuccessors name="pipelet_error" next="SetFormError1" action="rollback"/>
    <parameterBindings name="CurrencyCode" objectPath="SelectedCurrency"/>
    <parameterBindings name="Domain" objectPath="PromotionDomain"/>
    <parameterBindings name="PromotionID" objectPath="PromotionForm:PID:Value"/>
  </nodes>
<!--@Location 5,10-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode4">
    <nodeSuccessors name="next" next="UpdateCustomAttribute0"/>
    <parameterBindings name="CreatorId" objectPath="CurrentUser:Profile:UUID"/>
    <parameterBindings name="LocaleId" objectPath="LocaleID"/>
    <parameterBindings name="PromotionActionPriorityHandler" objectPath="ApplicationBO:Repository(&quot;PromotionBORepository&quot;):PromotionActionPriorityHandler"/>
    <startNode referencedName="ProcessPromotion-UpdatePromotion"/>
  </nodes>
<!--@Location 5,11-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateCustomAttribute0">
    <pipelet href="enfinity:/bc_foundation/pipelets/UpdateCustomAttribute.xml"/>
    <nodeSuccessors name="next" next="CallNode20"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode7"/>
    <parameterBindings name="AttributeName" constant="DisableMessages"/>
    <parameterBindings name="AttributeType" constant="Boolean"/>
    <parameterBindings name="AttributeValue" constant="(Boolean)false"/>
    <parameterBindings name="ExtensibleObject" objectPath="Promotion"/>
  </nodes>
<!--@Location 5,12-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode20">
    <nodeSuccessors name="next" next="CallNode2"/>
    <nodeSuccessors name="ERROR" next="JoinNode7"/>
    <parameterBindings name="Locale" objectPath="SelectedLocale"/>
    <parameterBindings name="Scope" nullBinding="true"/>
    <parameterBindings name="ScopeType" nullBinding="true"/>
    <parameterBindings name="Unlimited" constant="(Boolean)true"/>
    <startNode referencedName="ProcessPromotionBudget-SetBudget"/>
  </nodes>
<!--@Location 5,13-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode2">
    <nodeSuccessors name="next" next="CallNode5"/>
    <startNode referencedName="ViewPromotionTemplate-UpdateAppAssignments"/>
  </nodes>
<!--@Location 5,14-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode5">
    <nodeSuccessors name="next" next="CallNode8"/>
    <startNode referencedName="ViewPromotionTemplate-AssignTargetGroup"/>
  </nodes>
<!--@Location 5,15-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode8">
    <nodeSuccessors name="next" next="ExtensionPointNode_Tlus8MCzEeigOr3p1azOdA"/>
    <startNode referencedName="ViewPromotionTemplate-CreatePromotionRule"/>
  </nodes>
<!--Called after a new promotion was created. 
@Location 5,16-->
  <nodes xsi:type="pipeline:ExtensionPointNode" nodeID="ExtensionPointNode_Tlus8MCzEeigOr3p1azOdA"
      name="CreatedPromotion" strict="true">
    <nodeSuccessors name="next" next="InvalidatePageLocatorPageable0" action="commit"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode7" action="rollback"/>
    <parameters name="Promotion" type="com.intershop.component.marketing.capi.rebate.Promotion"/>
  </nodes>
<!--@Location 5,17-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="InvalidatePageLocatorPageable0">
    <configurationValues name="DefaultPageLocatorName" value="PromotionList"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/InvalidatePageLocatorPageable.xml"/>
    <nodeSuccessors name="next" next="SetDictionaryValue2"/>
  </nodes>
<!--@Location 5,18-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetDictionaryValue2">
    <configurationValues name="Name" value="SortBy"/>
    <configurationValues name="Value" value="PromotionName"/>
    <configurationValues name="ValueType" value="Dictionary Value"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetDictionaryValue.xml"/>
    <nodeSuccessors name="next" next="JumpNode4"/>
  </nodes>
<!--@Location 5,19-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode4">
    <startNode referencedName="ViewPromotionList-ListAll"/>
  </nodes>
<!--@Location 8,10-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode7">
    <nodeSuccessors name="next" next="CallNode10"/>
  </nodes>
<!--@Location 8,11-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode10">
    <nodeSuccessors name="next" next="GetCurrencies0"/>
    <startNode referencedName="This:GetLocales"/>
  </nodes>
<!--@Location 8,12-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetCurrencies0">
    <configurationValues name="Method" value="Active Currencies"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetCurrencies.xml"/>
    <nodeSuccessors name="next" next="PrepareApplicationView1"/>
    <parameterBindings name="Domain" objectPath="CurrentChannel:RepositoryDomain"/>
  </nodes>
<!--@Location 8,13-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="PrepareApplicationView1">
    <configurationValues name="SelectedMenuItem" value="OnlineMarketing"/>
    <configurationValues name="WorkingTemplate" value="marketing/CreatePromotionWithTemplate.isml"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/PrepareApplicationView.xml"/>
    <nodeSuccessors name="next" next="InteractionNode1"/>
  </nodes>
<!--@Location 8,14-->
  <nodes xsi:type="pipeline:InteractionNode" nodeID="InteractionNode1">
    <template referencedName="application/ApplicationFrame.isml"/>
  </nodes>
<!--@Location 6,10-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormError1">
    <pipelet href="enfinity:/core/pipelets/SetFormError.xml"/>
    <nodeSuccessors name="next" next="JoinNode7"/>
    <parameterBindings name="ErrorMsg" constant="error.PromotionAlreadyExists"/>
    <parameterBindings name="TargetObject" objectPath="PromotionForm:PID"/>
  </nodes>
<!--@Location 6,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="LogMessage3">
    <configurationValues name="Level" value="Error"/>
    <pipelet href="enfinity:/core/pipelets/LogMessage.xml"/>
    <nodeSuccessors name="next" next="JumpNode8"/>
    <parameterBindings name="MessageParam0" constant="promotionTemplate"/>
    <parameterBindings name="MessageParam1" objectPath="promotionTemplate"/>
    <parameterBindings name="MessageParam2" objectPath="CurrentPipelineName"/>
    <parameterBindings name="MessageParam3" objectPath="CurrentStartNodeName"/>
    <parameterBindings name="MessageText" constant="{3}-{4}: Variable {0} contains invalid value. ({1})"/>
  </nodes>
<!--@Location 6,4-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode8">
    <startNode referencedName="Error-Start"/>
  </nodes>
<!--@Location 1,29-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode12" name="CreatePromotionAppAssignmentForm"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode27"/>
  </nodes>
<!--@Location 1,30-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode27">
    <nodeSuccessors name="next" next="DecisionNode11"/>
    <startNode referencedName="ProcessApplication-GetApplications"/>
    <returnValueBindings name="Applications" objectPath="Apps"/>
  </nodes>
<!--@Location 1,31-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode11" conditionKey="Apps"
      operator="has_elements">
    <nodeSuccessors name="decision_yes" next="CallNode26"/>
<!--@BendPoints 5,63-->
    <nodeSuccessors name="decision_no" next="JoinNode10"/>
  </nodes>
<!--@Location 1,32-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode26">
    <nodeSuccessors name="next" next="GetIteratorSize0"/>
    <parameterBindings name="Applications" objectPath="Apps"/>
    <parameterBindings name="SortBy" constant="name"/>
    <parameterBindings name="SortDirection" constant="ascending"/>
    <startNode referencedName="ProcessApplication-Sort"/>
    <returnValueBindings name="Applications" objectPath="Apps"/>
  </nodes>
<!--@Location 1,33-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetIteratorSize0">
    <pipelet href="enfinity:/bc_foundation/pipelets/GetIteratorSize.xml"/>
    <nodeSuccessors name="next" next="CreatePageableFromIterator0"/>
    <parameterBindings name="Iterator" objectPath="Apps"/>
    <returnValueBindings name="Size" objectPath="AppsCount"/>
  </nodes>
<!--@Location 1,34-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreatePageableFromIterator0">
    <configurationValues name="Pagesize" value="0"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/CreatePageableFromIterator.xml"/>
    <nodeSuccessors name="next" next="CreateListForm0"/>
    <parameterBindings name="Iterator" objectPath="Apps"/>
    <parameterBindings name="PageSize" objectPath="AppsCount"/>
    <returnValueBindings name="Pageable" objectPath="AppsPageable"/>
  </nodes>
<!--@Location 1,35-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateListForm0">
    <configurationValues name="FormName" value="PromotionAppAssignment"/>
    <configurationValues name="ObjectIDMethod" value="getUUID"/>
    <configurationValues name="ResourceName" value="PromotionAppAssignment"/>
    <pipelet href="enfinity:/core/pipelets/CreateListForm.xml"/>
    <nodeSuccessors name="next" next="JoinNode11"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode10"/>
    <parameterBindings name="PageableObject" objectPath="AppsPageable"/>
    <returnValueBindings name="Form" objectPath="PromotionAppAssignmentForm"/>
  </nodes>
<!--@Location 1,36-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode11">
<!--@BendPoints 3,74-->
    <nodeSuccessors name="next" next="EndNode9"/>
  </nodes>
<!--@Location 1,37-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode9"/>
<!--@Location 2,35-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode10">
<!--@BendPoints 5,73-->
    <nodeSuccessors name="next" next="JoinNode11"/>
  </nodes>
<!--@Location 14,22-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode17" name="CreatePromotionRule"
      callMode="Private">
    <nodeSuccessors name="next" next="DecisionNode17"/>
  </nodes>
<!--@Location 14,24-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode17" conditionKey="promotionTemplate"
      operator="str_eq" conditionValue="CreateFreeShippingPromotion">
    <nodeSuccessors name="decision_yes" next="CreateFreeShippingRebate0"/>
<!--@BendPoints 30,49-->
    <nodeSuccessors name="decision_no" next="DecisionNode18"/>
  </nodes>
<!--@Location 14,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateFreeShippingRebate0">
    <pipelet href="enfinity:/bc_marketing/pipelets/CreateFreeShippingRebate.xml"/>
    <nodeSuccessors name="next" next="CallNode22"/>
    <parameterBindings name="LocaleInformation" objectPath="CurrentRequest:Current:Locale"/>
    <parameterBindings name="MinOrderValue" objectPath="ActionForm:TargetPrice:Value"/>
  </nodes>
<!--@Location 14,26-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode22">
    <nodeSuccessors name="next" next="EndNode15"/>
    <startNode referencedName="ProcessPromotion-UpdatePromotionPriorityToDefault"/>
  </nodes>
<!--@Location 14,27-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode15"/>
<!--@Location 15,24-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode18" conditionKey="promotionTemplate"
      operator="str_eq" conditionValue="CreateFixDiscountPromotion">
    <nodeSuccessors name="decision_yes" next="CreateFixDiscountRebate0"/>
    <nodeSuccessors name="decision_no" next="LogMessage1"/>
  </nodes>
<!--@Location 15,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateFixDiscountRebate0">
    <pipelet href="enfinity:/bc_marketing/pipelets/CreateFixDiscountRebate.xml"/>
    <nodeSuccessors name="next" next="CallNode22"/>
    <parameterBindings name="GrantedDiscountValue" objectPath="ActionForm:GrantedDiscount:Value"/>
    <parameterBindings name="LocaleInformation" objectPath="CurrentRequest:Current:Locale"/>
    <parameterBindings name="MinOrderValue" objectPath="ActionForm:TargetPrice:Value"/>
  </nodes>
<!--@Location 16,24-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="LogMessage1">
    <configurationValues name="Level" value="Error"/>
    <pipelet href="enfinity:/core/pipelets/LogMessage.xml"/>
    <nodeSuccessors name="next" next="EndNode15"/>
    <parameterBindings name="MessageParam0" constant="promotionTemplate"/>
    <parameterBindings name="MessageParam1" objectPath="promotionTemplate"/>
    <parameterBindings name="MessageParam2" objectPath="CurrentPipelineName"/>
    <parameterBindings name="MessageParam3" objectPath="CurrentStartNodeName"/>
    <parameterBindings name="MessageText" constant="{3}-{4}: Variable {0} contains invalid value. ({1})"/>
  </nodes>
<!--@Location 2,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode2" name="Dispatch">
    <nodeSuccessors name="next" next="DispatchFormAction0"/>
  </nodes>
<!--@Location 2,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="DispatchFormAction0">
    <configurationValues name="OutValue_0" value="ViewPromotionTemplate-Create"/>
    <configurationValues name="OutValue_1" value="ViewPromotionTemplate-JumpToList"/>
    <configurationValues name="OutValue_2" value="ViewPromotionTemplate-SetLocaleEdit"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/DispatchFormAction.xml"/>
    <nodeSuccessors name="next" next="JoinNode0"/>
<!--@BendPoints 7,3-->
    <nodeSuccessors name="pipelet_error" next="SetDictionaryValue1"/>
    <parameterBindings name="Key_0" objectPath="create"/>
    <parameterBindings name="Key_1" objectPath="cancel"/>
    <parameterBindings name="Key_2" objectPath="setLocaleEdit"/>
    <returnValueBindings name="SelectionKey" objectPath="JumpTarget"/>
  </nodes>
<!--@Location 2,2-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode0">
    <nodeSuccessors name="next" next="JumpNode1"/>
  </nodes>
<!--@Location 2,3-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode1">
    <startNode referencedName="SecureJump-Start"/>
  </nodes>
<!--@Location 3,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetDictionaryValue1">
    <configurationValues name="Name" value="JumpTarget"/>
    <configurationValues name="Value" value="ViewPromotionList-ListAll"/>
    <configurationValues name="ValueType" value="Dictionary Value"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetDictionaryValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode0"/>
  </nodes>
<!--@Location 3,22-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode5" name="GetLocales" callMode="Private">
    <nodeSuccessors name="next" next="DetermineLocales0"/>
  </nodes>
<!--@Location 3,23-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="DetermineLocales0">
    <pipelet href="enfinity:/core/pipelets/DetermineLocales.xml"/>
    <nodeSuccessors name="next" next="DecisionNode2"/>
    <returnValueBindings name="Locales" objectPath="AllLocales"/>
  </nodes>
<!--@Location 3,24-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode2" conditionKey="UpdateLocale"
      operator="undef">
<!--@BendPoints 7,50-->
    <nodeSuccessors name="decision_yes" next="GetLocale2"/>
<!--@BendPoints 9,49-->
    <nodeSuccessors name="decision_no" next="KeyMapper3"/>
  </nodes>
<!--@Location 3,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetLocale2">
    <configurationValues name="LocaleFallback" value="Session Locale"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetLocale.xml"/>
    <nodeSuccessors name="next" next="JoinNode1"/>
    <parameterBindings name="LocaleId" objectPath="LocaleID"/>
    <returnValueBindings name="Locale" objectPath="SelectedLocale"/>
  </nodes>
<!--@Location 3,26-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode1">
    <nodeSuccessors name="next" next="EndNode3"/>
  </nodes>
<!--@Location 3,27-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode3"/>
<!--@Location 4,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper3">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
<!--@BendPoints 9,53-->
    <nodeSuccessors name="next" next="JoinNode1"/>
    <parameterBindings name="InValue_1" objectPath="UpdateLocale"/>
    <returnValueBindings name="OutValue_1" objectPath="SelectedLocale"/>
  </nodes>
<!--@Location 5,22-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode15" name="GetSelectedCurrency"
      callMode="Private">
    <nodeSuccessors name="next" next="DecisionNode9"/>
  </nodes>
<!--@Location 5,23-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode9" conditionKey="PromotionForm:Currency:Value"
      operator="str_empty">
    <nodeSuccessors name="decision_yes" next="JoinNode13"/>
<!--@BendPoints 13,47 13,48-->
    <nodeSuccessors name="decision_no" next="DecisionNode8"/>
  </nodes>
<!--@Location 5,25-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode13">
<!--@BendPoints 11,52-->
    <nodeSuccessors name="next" next="KeyMapper4"/>
  </nodes>
<!--@Location 5,26-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper4">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="JoinNode14"/>
    <parameterBindings name="InValue_1" nullBinding="true"/>
    <returnValueBindings name="OutValue_1" objectPath="SelectedCurrency"/>
  </nodes>
<!--@Location 5,27-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode14">
<!--@BendPoints 11,56-->
    <nodeSuccessors name="next" next="EndNode13"/>
  </nodes>
<!--@Location 5,28-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode13">
    <returnValues name="SelectedCurrency" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 6,24-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode8" conditionKey="PromotionForm:Currency:Value"
      operator="str_eq" conditionValue=".All.">
<!--@BendPoints 13,51-->
    <nodeSuccessors name="decision_yes" next="JoinNode13"/>
<!--@BendPoints 14,49 14,52 13,52-->
    <nodeSuccessors name="decision_no" next="KeyMapper5"/>
  </nodes>
<!--@Location 6,26-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper5">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
<!--@BendPoints 13,55-->
    <nodeSuccessors name="next" next="JoinNode14"/>
    <parameterBindings name="InValue_1" objectPath="PromotionForm:Currency:Value"/>
    <returnValueBindings name="OutValue_1" objectPath="SelectedCurrency"/>
  </nodes>
<!--@Location 1,22-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode4" strict="true" name="InitTemplatePromotionForm"
      callMode="Private">
    <nodeSuccessors name="next" next="CreateUUID0"/>
    <parameters name="PromotionForm" type="com.intershop.beehive.core.capi.webform.Form"/>
    <parameters name="SelectedLocale" type="com.intershop.beehive.core.capi.localization.LocaleInformation"/>
    <parameters name="CurrencyMnemonic" type="java.lang.String"/>
  </nodes>
<!--@Location 1,23-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateUUID0">
    <pipelet href="enfinity:/bc_foundation/pipelets/CreateUUID.xml"/>
    <nodeSuccessors name="next" next="AddMultipleEntriesToMap0"/>
    <returnValueBindings name="UUID" objectPath="DefaultID"/>
  </nodes>
<!--@Location 1,24-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddMultipleEntriesToMap0">
    <configurationValues name="Mode" value="OverwriteValue"/>
    <configurationValues name="ValueSeparatorChar" value=","/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddMultipleEntriesToMap.xml"/>
    <nodeSuccessors name="next" next="SetFormParameterValues0"/>
    <parameterBindings name="InMap" objectPath="FormParameters"/>
    <parameterBindings name="Key1" objectPath="PromotionForm:Name"/>
    <parameterBindings name="Key2" objectPath="PromotionForm:PID"/>
    <parameterBindings name="Key3" objectPath="PromotionForm:Description"/>
    <parameterBindings name="Key4" objectPath="PromotionForm:Currency"/>
    <parameterBindings name="Value1" constant=""/>
    <parameterBindings name="Value2" objectPath="DefaultID"/>
    <parameterBindings name="Value3" constant=""/>
    <parameterBindings name="Value4" objectPath="CurrencyMnemonic"/>
    <parameterBindings name="Value5" constant=""/>
    <returnValueBindings name="OutMap" objectPath="FormParameters"/>
  </nodes>
<!--@Location 1,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValues0">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValues.xml"/>
    <nodeSuccessors name="next" next="CallNode11"/>
    <parameterBindings name="FormParameterValuesMap" objectPath="FormParameters"/>
  </nodes>
<!--@Location 1,26-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode11">
    <nodeSuccessors name="next" next="EndNode1"/>
    <startNode referencedName="ViewPromotion-DefaultStartEndDate"/>
  </nodes>
<!--@Location 1,27-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode1" strict="true">
    <returnValues name="StartDate" type="java.util.Date"/>
    <returnValues name="EndDate" type="java.util.Date"/>
    <returnValues name="PromotionForm" type="com.intershop.beehive.core.capi.webform.Form"/>
  </nodes>
<!--@Location 2,4-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode9" name="JumpToList">
    <nodeSuccessors name="next" next="GetPageLocator0"/>
  </nodes>
<!--@Location 2,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetPageLocator0">
    <configurationValues name="DefaultPageLocatorName" value="PromotionList"/>
    <configurationValues name="RestorePageLocatorDictionary" value="False"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetPageLocator.xml"/>
    <nodeSuccessors name="next" next="JumpNode2"/>
<!--@BendPoints 7,11-->
    <nodeSuccessors name="pipelet_error" next="JumpNode3"/>
  </nodes>
<!--@Location 2,6-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode2" callModePermissions="Private">
    <startNode objectPath="PageLocator:Pipeline"/>
  </nodes>
<!--@Location 3,6-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode3">
    <startNode referencedName="ViewPromotionList-Paging"/>
  </nodes>
<!--@Location 8,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode3" name="New">
    <nodeSuccessors name="next" next="CallNode9"/>
  </nodes>
<!--@Location 8,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode9">
    <nodeSuccessors name="next" next="GetLocale0"/>
    <startNode referencedName="This:Prefix"/>
  </nodes>
<!--@Location 8,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetLocale0">
    <configurationValues name="LocaleFallback" value="Lead Locale"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetLocale.xml"/>
    <nodeSuccessors name="next" next="CreateForm1"/>
    <parameterBindings name="LocaleId" objectPath="LocaleID"/>
    <returnValueBindings name="Locale" objectPath="SelectedLocale"/>
  </nodes>
<!--@Location 8,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateForm1">
    <configurationValues name="FormName" value="CreatePromotionBaseTemplate-CreatePromotionBaseTemplate"/>
    <configurationValues name="FormResource" value="CreatePromotionBaseTemplate"/>
    <pipelet href="enfinity:/core/pipelets/CreateForm.xml"/>
    <nodeSuccessors name="next" next="GetPromotionTemplateByName1"/>
    <returnValueBindings name="Form" objectPath="PromotionForm"/>
  </nodes>
<!--@Location 8,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetPromotionTemplateByName1">
    <pipelet href="enfinity:/bc_marketing/pipelets/GetPromotionTemplateByName.xml"/>
    <nodeSuccessors name="next" next="DecisionNode15"/>
    <parameterBindings name="TemplateName" objectPath="promotionTemplate"/>
  </nodes>
<!--@Location 8,5-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode15" conditionKey="TemplateConfig">
    <nodeSuccessors name="decision_yes" next="CreateForm5"/>
    <nodeSuccessors name="decision_no" next="LogMessage0"/>
  </nodes>
<!--@Location 8,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateForm5">
    <pipelet href="enfinity:/core/pipelets/CreateForm.xml"/>
    <nodeSuccessors name="next" next="KeyMapper0"/>
    <parameterBindings name="FormName" objectPath="TemplateConfig:FormName"/>
    <parameterBindings name="FormResource" objectPath="TemplateConfig:FormResource"/>
    <returnValueBindings name="Form" objectPath="ActionForm"/>
  </nodes>
<!--@Location 8,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper0">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="CallNode7"/>
    <parameterBindings name="InValue_1" objectPath="ApplicationBO:DefaultCurrency:Mnemonic"/>
    <parameterBindings name="InValue_10" nullBinding="true"/>
    <parameterBindings name="InValue_2" nullBinding="true"/>
    <parameterBindings name="InValue_3" nullBinding="true"/>
    <parameterBindings name="InValue_4" nullBinding="true"/>
    <parameterBindings name="InValue_5" nullBinding="true"/>
    <parameterBindings name="InValue_6" nullBinding="true"/>
    <parameterBindings name="InValue_7" nullBinding="true"/>
    <parameterBindings name="InValue_8" nullBinding="true"/>
    <parameterBindings name="InValue_9" nullBinding="true"/>
    <returnValueBindings name="OutValue_1" objectPath="DefaultCurrencyMnemonic"/>
    <returnValueBindings name="OutValue_10" nullBinding="true"/>
    <returnValueBindings name="OutValue_2" nullBinding="true"/>
    <returnValueBindings name="OutValue_3" nullBinding="true"/>
    <returnValueBindings name="OutValue_4" nullBinding="true"/>
    <returnValueBindings name="OutValue_5" nullBinding="true"/>
    <returnValueBindings name="OutValue_6" nullBinding="true"/>
    <returnValueBindings name="OutValue_7" nullBinding="true"/>
    <returnValueBindings name="OutValue_8" nullBinding="true"/>
    <returnValueBindings name="OutValue_9" nullBinding="true"/>
  </nodes>
<!--@Location 8,8-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode7">
    <nodeSuccessors name="next" next="CallNode18"/>
    <parameterBindings name="CurrencyMnemonic" objectPath="DefaultCurrencyMnemonic"/>
    <startNode referencedName="ViewPromotionTemplate-InitTemplatePromotionForm"/>
  </nodes>
<!--@Location 8,9-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode18">
    <nodeSuccessors name="next" next="JoinNode7"/>
    <startNode referencedName="ViewPromotionTemplate-SetDefaultSelectionInPromotionAppAssignmentForm"/>
  </nodes>
<!--@Location 9,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="LogMessage0">
    <configurationValues name="Level" value="Error"/>
    <pipelet href="enfinity:/core/pipelets/LogMessage.xml"/>
    <nodeSuccessors name="next" next="JumpNode5"/>
    <parameterBindings name="MessageParam0" constant="promotionTemplate"/>
    <parameterBindings name="MessageParam1" objectPath="promotionTemplate"/>
    <parameterBindings name="MessageParam2" objectPath="CurrentPipelineName"/>
    <parameterBindings name="MessageParam3" objectPath="CurrentStartNodeName"/>
    <parameterBindings name="MessageText" constant="{3}-{4}: Variable {0} contains invalid value. ({1})"/>
  </nodes>
<!--@Location 10,5-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode5">
    <startNode referencedName="Error-Start"/>
  </nodes>
<!--@Location 0,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode0" name="Prefix" callMode="Private">
    <nodeSuccessors name="next" next="DecisionNode1"/>
  </nodes>
<!--@Location 0,1-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode1" conditionKey="PrefixDone"
      operator="undef">
    <nodeSuccessors name="decision_yes" next="GetLocale1"/>
<!--@BendPoints 2,3-->
    <nodeSuccessors name="decision_no" next="EndNode2"/>
  </nodes>
<!--@Location 0,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetLocale1">
    <configurationValues name="LocaleFallback" value="Lead Locale"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/GetLocale.xml"/>
    <nodeSuccessors name="next" next="SetDictionaryValue0"/>
    <parameterBindings name="LocaleId" objectPath="LocaleID"/>
    <returnValueBindings name="Locale" objectPath="SelectedLocale"/>
  </nodes>
<!--@Location 0,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetDictionaryValue0">
    <configurationValues name="Name" value="PrefixDone"/>
    <configurationValues name="Value" value="true"/>
    <configurationValues name="ValueType" value="Dictionary Value"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetDictionaryValue.xml"/>
    <nodeSuccessors name="next" next="KeyMapper1"/>
  </nodes>
<!--@Location 0,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper1">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="KeyMapper2"/>
    <parameterBindings name="InValue_1" objectPath="ApplicationBO:Repository(&quot;PromotionBORepository&quot;):PromotionActionPriorityHandler:SortedDescriptorsByPriority"/>
    <returnValueBindings name="OutValue_1" objectPath="ActionDescriptors"/>
  </nodes>
<!--@Location 0,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper2">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="EndNode0"/>
    <parameterBindings name="InValue_1" objectPath="ApplicationBO:Repository(&quot;PromotionBORepository&quot;):PromotionActionPriorityHandler"/>
    <returnValueBindings name="OutValue_1" objectPath="PromotionActionPriorityHandler"/>
  </nodes>
<!--@Location 0,6-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode0"/>
<!--@Location 1,1-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode2"/>
<!--@Location 4,29-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode6" name="SetDefaultSelectionInPromotionAppAssignmentForm"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode12"/>
  </nodes>
<!--@Location 4,30-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode12">
    <nodeSuccessors name="next" next="LoopNode0"/>
    <startNode referencedName="ViewPromotionTemplate-CreatePromotionAppAssignmentForm"/>
  </nodes>
<!--@Location 4,31-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode0" loop="Apps">
    <nodeSuccessors name="next" next="EndNode4"/>
    <entry key="App">
<!--@BendPoints 9,64-->
      <nodeSuccessors name="loop_entry_next" next="DecisionNode3"/>
    </entry>
  </nodes>
<!--@Location 4,32-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode3" conditionKey="App:Default">
    <nodeSuccessors name="decision_yes" next="DecisionNode4"/>
<!--@BendPoints 11,65-->
    <nodeSuccessors name="decision_no" next="JoinNode3"/>
  </nodes>
<!--@Location 4,33-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode4" conditionKey="App:Default"
      operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="SetFormParameterValue0"/>
    <nodeSuccessors name="decision_no" next="JoinNode3"/>
  </nodes>
<!--@Location 4,34-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValue0">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode2"/>
    <parameterBindings name="FormParameter" objectPath="PromotionAppAssignmentForm:get(App:UUID):Selection"/>
    <parameterBindings name="Value" constant="(Boolean)true"/>
  </nodes>
<!--@Location 4,35-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode2">
<!--@BendPoints 8,71 8,63-->
    <nodeSuccessors name="next" next="LoopNode0_Entry"/>
  </nodes>
<!--@Location 5,33-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode3">
<!--@BendPoints 11,71-->
    <nodeSuccessors name="next" next="JoinNode2"/>
  </nodes>
<!--@Location 5,31-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode4"/>
<!--@Location 8,22-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode14" strict="true" name="SetFormErrors"
      callMode="Private">
    <nodeSuccessors name="next" next="SetFormError0"/>
<!--the error message will be set to targt object-->
    <parameters name="ErrorMsg" type="java.lang.String"/>
<!--the target object for the error message-->
    <parameters name="TargetObject" type="com.intershop.beehive.core.capi.webform.ValidationElement"/>
  </nodes>
<!--@Location 8,23-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormError0">
    <pipelet href="enfinity:/core/pipelets/SetFormError.xml"/>
    <nodeSuccessors name="next" next="EndNode12"/>
  </nodes>
<!--@Location 8,24-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode12" strict="true"/>
<!--@Location 9,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode1" name="SetLocaleEdit">
<!--@BendPoints 19,2-->
    <nodeSuccessors name="next" next="CallNode1"/>
  </nodes>
<!--@Location 9,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode1">
    <nodeSuccessors name="next" next="CallNode3"/>
    <startNode referencedName="This:Prefix"/>
  </nodes>
<!--@Location 9,2-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode3">
    <nodeSuccessors name="next" next="JumpNode0"/>
    <startNode referencedName="ViewPromotionTemplate-ValidateAppAssignmentForm"/>
  </nodes>
<!--@Location 9,3-->
  <nodes xsi:type="pipeline:JumpNode" nodeID="JumpNode0">
    <startNode referencedName="ViewPromotionTemplate-New"/>
  </nodes>
<!--@Location 12,22-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode18" name="SetPromotionDefaultValues"
      callMode="Private">
    <nodeSuccessors name="next" next="AddMultipleEntriesToMap3"/>
  </nodes>
<!--@Location 12,23-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddMultipleEntriesToMap3">
    <configurationValues name="Mode" value="OverwriteValue"/>
    <configurationValues name="ValueSeparatorChar" value=","/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddMultipleEntriesToMap.xml"/>
    <nodeSuccessors name="next" next="AddMultipleEntriesToMap4"/>
    <parameterBindings name="InMap" objectPath="FormParameters"/>
    <parameterBindings name="Key1" objectPath="PromotionForm:BudgetSource"/>
    <parameterBindings name="Key2" objectPath="PromotionForm:Enabled"/>
    <parameterBindings name="Key3" objectPath="PromotionForm:RankSelection"/>
    <parameterBindings name="Key4" objectPath="PromotionForm:TargetGroup"/>
    <parameterBindings name="Key5" objectPath="PromotionForm:UseCampaignTargetGroup"/>
    <parameterBindings name="Value1" objectPath="DefaultPromotionConfiguration:promotion.budget.id"/>
    <parameterBindings name="Value2" objectPath="DefaultPromotionConfiguration:promotion.active"/>
    <parameterBindings name="Value3" objectPath="DefaultPromotionConfiguration:promotion.default.rank"/>
    <parameterBindings name="Value4" objectPath="DefaultPromotionConfiguration:promotion.targetgroup.id"/>
    <parameterBindings name="Value5" objectPath="DefaultPromotionConfiguration:promotion.use.campaign.target.group"/>
    <returnValueBindings name="OutMap" objectPath="FormParameters"/>
  </nodes>
<!--@Location 12,24-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddMultipleEntriesToMap4">
    <configurationValues name="Mode" value="OverwriteValue"/>
    <configurationValues name="ValueSeparatorChar" value=","/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddMultipleEntriesToMap.xml"/>
    <nodeSuccessors name="next" next="SetFormParameterValues1"/>
    <parameterBindings name="InMap" objectPath="FormParameters"/>
    <parameterBindings name="Key1" objectPath="PromotionForm:UseCampaignTimeFrame"/>
    <parameterBindings name="Key2" objectPath="PromotionForm:Description"/>
    <parameterBindings name="Key3" objectPath="PromotionForm:EffectDiscountLevel"/>
    <parameterBindings name="Value1" objectPath="DefaultPromotionConfiguration:promotion.use.campaign.time.frame"/>
    <parameterBindings name="Value2" objectPath="DefaultPromotionConfiguration:promotion.custom.attribute.description"/>
    <parameterBindings name="Value3" objectPath="DefaultPromotionConfiguration:promotion.effect.discount.level"/>
    <returnValueBindings name="OutMap" objectPath="FormParameters"/>
  </nodes>
<!--@Location 12,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetFormParameterValues1">
    <pipelet href="enfinity:/core/pipelets/SetFormParameterValues.xml"/>
    <nodeSuccessors name="next" next="EndNode16"/>
    <parameterBindings name="FormParameterValuesMap" objectPath="FormParameters"/>
  </nodes>
<!--@Location 12,26-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode16"/>
<!--@Location 13,29-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode13" name="ShowApplicationSelectionError"
      callMode="Private">
    <nodeSuccessors name="next" next="DecisionNode12"/>
  </nodes>
<!--@Location 13,30-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode12" conditionKey="Apps">
    <nodeSuccessors name="decision_yes" next="DecisionNode13"/>
<!--@BendPoints 31,61-->
    <nodeSuccessors name="decision_no" next="JoinNode9"/>
  </nodes>
<!--@Location 13,31-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode13" conditionKey="Apps"
      operator="has_elements">
    <nodeSuccessors name="decision_yes" next="LoopNode2"/>
    <nodeSuccessors name="decision_no" next="JoinNode9"/>
  </nodes>
<!--@Location 13,32-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode2" loop="Apps">
<!--@BendPoints 28,65-->
    <nodeSuccessors name="next" next="EndNode10"/>
    <entry key="App">
<!--@BendPoints 27,66-->
      <nodeSuccessors name="loop_entry_next" next="DecisionNode0"/>
    </entry>
  </nodes>
<!--@Location 13,33-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode0" conditionKey="PromotionAppAssignmentForm:get(App:UUID):Selection:Value"
      operator="str_neq" conditionValue="true">
<!--@BendPoints 27,68 26,68 26,65-->
    <nodeSuccessors name="decision_yes" next="LoopNode2_Entry"/>
    <nodeSuccessors name="decision_no" next="JoinNode12"/>
  </nodes>
<!--@Location 15,33-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode12">
<!--@BendPoints 31,69 29,69-->
    <nodeSuccessors name="next" next="EndNode11"/>
  </nodes>
<!--@Location 14,35-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode11" name="NO"/>
<!--@Location 14,32-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode10" name="YES"/>
<!--@Location 15,31-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode9">
    <nodeSuccessors name="next" next="JoinNode12"/>
  </nodes>
<!--@Location 10,29-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode11" name="UpdateAppAssignments"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode25"/>
  </nodes>
<!--@Location 10,30-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode25">
    <nodeSuccessors name="next" next="LoopNode1"/>
    <parameterBindings name="Channel" objectPath="CurrentChannel"/>
    <startNode referencedName="ProcessPromotion-GetPromotionDomainByChannel"/>
  </nodes>
<!--@Location 10,31-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode1" loop="Apps">
<!--@BendPoints 22,63 25,63 25,71 21,71 21,72-->
    <nodeSuccessors name="next" next="EndNode8"/>
    <entry key="App">
<!--@BendPoints 21,64-->
      <nodeSuccessors name="loop_entry_next" next="DecisionNode10"/>
    </entry>
  </nodes>
<!--@Location 10,32-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode10" conditionKey="PromotionAppAssignmentForm:get(App:UUID):Selection:Value"
      operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="AssignPromotionToApplication0"/>
<!--@BendPoints 23,65-->
    <nodeSuccessors name="decision_no" next="UnassignPromotionFromApplication0"/>
  </nodes>
<!--@Location 10,33-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AssignPromotionToApplication0">
    <pipelet href="enfinity:/bc_marketing/pipelets/AssignPromotionToApplication.xml"/>
    <nodeSuccessors name="next" next="JoinNode8"/>
    <parameterBindings name="Application" objectPath="App"/>
    <parameterBindings name="Domain" objectPath="PromotionDomain"/>
  </nodes>
<!--@Location 10,34-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode8">
<!--@BendPoints 19,69 19,63 20,63-->
    <nodeSuccessors name="next" next="LoopNode1_Entry"/>
  </nodes>
<!--@Location 11,33-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UnassignPromotionFromApplication0">
    <pipelet href="enfinity:/bc_marketing/pipelets/UnassignPromotionFromApplication.xml"/>
<!--@BendPoints 23,69 22,69-->
    <nodeSuccessors name="next" next="JoinNode8"/>
    <parameterBindings name="Application" objectPath="App"/>
    <parameterBindings name="Domain" objectPath="PromotionDomain"/>
  </nodes>
<!--@Location 10,36-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode8"/>
<!--@Location 7,29-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode7" name="ValidateAppAssignmentForm"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode13"/>
  </nodes>
<!--@Location 7,30-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode13">
    <nodeSuccessors name="next" next="DecisionNode5"/>
    <startNode referencedName="ViewPromotionTemplate-CreatePromotionAppAssignmentForm"/>
  </nodes>
<!--@Location 7,31-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode5" conditionKey="Apps"
      operator="has_elements">
    <nodeSuccessors name="decision_yes" next="ValidateForm0"/>
<!--@BendPoints 17,63 17,69-->
    <nodeSuccessors name="decision_no" next="JoinNode4"/>
  </nodes>
<!--@Location 7,32-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ValidateForm0">
    <pipelet href="enfinity:/core/pipelets/ValidateForm.xml"/>
    <nodeSuccessors name="next" next="JoinNode5"/>
<!--@BendPoints 16,65 16,67-->
    <nodeSuccessors name="pipelet_error" next="JoinNode5"/>
    <parameterBindings name="Form" objectPath="PromotionAppAssignmentForm"/>
  </nodes>
<!--@Location 7,33-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode5">
    <nodeSuccessors name="next" next="JoinNode4"/>
  </nodes>
<!--@Location 7,34-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode4">
<!--@BendPoints 15,70-->
    <nodeSuccessors name="next" next="EndNode5"/>
  </nodes>
<!--@Location 7,35-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode5"/>
<!--@displayNearNode@This node validates all form fields using
 the validation framework and performs 
 some additional checks to find all form 
errors. If an error has occured, the 
execution paths leaves via the ERROR exit, 
otherwise it uses the normal one.
@Location 11,1-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode10" name="ValidateForm" callMode="Private">
<!--@BendPoints 23,4-->
    <nodeSuccessors name="next" next="CreateForm2"/>
  </nodes>
<!--@Location 11,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateForm2">
    <configurationValues name="FormName" value="CreatePromotionBaseTemplate-CreatePromotionBaseTemplate"/>
    <configurationValues name="FormResource" value="CreatePromotionBaseTemplate"/>
    <pipelet href="enfinity:/core/pipelets/CreateForm.xml"/>
    <nodeSuccessors name="next" next="ValidateForm1"/>
    <returnValueBindings name="Form" objectPath="PromotionForm"/>
  </nodes>
<!--@Location 11,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ValidateForm1">
    <pipelet href="enfinity:/core/pipelets/ValidateForm.xml"/>
    <nodeSuccessors name="next" next="JoinNode6"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode6"/>
    <parameterBindings name="Form" objectPath="PromotionForm"/>
  </nodes>
<!--@Location 11,4-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode6">
    <nodeSuccessors name="next" next="CreateForm4"/>
  </nodes>
<!--@Location 11,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateForm4">
    <pipelet href="enfinity:/core/pipelets/CreateForm.xml"/>
    <nodeSuccessors name="next" next="ValidateForm3"/>
    <parameterBindings name="FormName" objectPath="TemplateConfig:FormName"/>
    <parameterBindings name="FormResource" objectPath="TemplateConfig:FormResource"/>
    <returnValueBindings name="Form" objectPath="ActionForm"/>
  </nodes>
<!--@Location 11,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ValidateForm3">
    <pipelet href="enfinity:/core/pipelets/ValidateForm.xml"/>
    <nodeSuccessors name="next" next="JoinNode15"/>
<!--@BendPoints 24,15 24,17-->
    <nodeSuccessors name="pipelet_error" next="JoinNode15"/>
    <parameterBindings name="Form" objectPath="ActionForm"/>
  </nodes>
<!--@Location 11,8-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode15">
    <nodeSuccessors name="next" next="CallNode19"/>
  </nodes>
<!--@Location 11,10-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode19">
    <nodeSuccessors name="next" next="CallNode24"/>
    <startNode referencedName="ViewPromotionTemplate-ValidateAppAssignmentForm"/>
  </nodes>
<!--@Location 11,11-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode24">
    <nodeSuccessors name="NO" next="DecisionNode6"/>
    <nodeSuccessors name="YES" next="CallNode21"/>
    <startNode referencedName="ViewPromotionTemplate-ShowApplicationSelectionError"/>
  </nodes>
<!--@Location 11,13-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode6" conditionKey="PromotionAppAssignmentForm:Invalid"
      operator="str_eq" conditionValue="false">
    <nodeSuccessors name="decision_yes" next="DecisionNode7"/>
<!--@BendPoints 25,27 25,30-->
    <nodeSuccessors name="decision_no" next="EndNode7"/>
  </nodes>
<!--@Location 11,14-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode7" conditionKey="PromotionForm:Invalid"
      operator="str_eq" conditionValue="false">
    <nodeSuccessors name="decision_yes" next="DecisionNode14"/>
<!--@BendPoints 24,29-->
    <nodeSuccessors name="decision_no" next="EndNode7"/>
  </nodes>
<!--@Location 11,15-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode14" conditionKey="ActionForm:Invalid"
      operator="str_eq" conditionValue="false">
    <nodeSuccessors name="decision_yes" next="EndNode6"/>
    <nodeSuccessors name="decision_no" next="EndNode7"/>
  </nodes>
<!--@Location 11,16-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode6"/>
<!--@Location 12,16-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode7" name="Error"/>
<!--@Location 12,12-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode21">
    <nodeSuccessors name="next" next="DecisionNode6"/>
    <parameterBindings name="ErrorMsg" constant="error.Application"/>
    <parameterBindings name="TargetObject" objectPath="PromotionAppAssignmentForm"/>
    <startNode referencedName="ViewPromotionTemplate-SetFormErrors"/>
  </nodes>
</pipeline:Pipeline>
