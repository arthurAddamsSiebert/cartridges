<?xml version="1.0" encoding="UTF-8"?>
<!--Provides processes related to product sharing administration.
@Group Sharing-->

<pipeline:Pipeline xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:pipeline="http://www.intershop.de/pipeline/2010"
    name="ProcessProductSharing" type="process">
<!--@Location 12,22-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode19" strict="true" name="BatchDelete"
      callMode="Private">
    <nodeSuccessors name="next" next="GetApplicationBO3"/>
    <parameters name="Repository" type="com.intershop.component.mvc.capi.catalog.Repository"/>
    <parameters name="ProductSetID" type="java.lang.String"/>
    <parameters name="CurrentApplication" type="com.intershop.beehive.core.capi.domain.Application"/>
  </nodes>
<!--@Location 12,23-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetApplicationBO3">
    <pipelet href="enfinity:/bc_application/pipelets/GetApplicationBO.xml"/>
    <nodeSuccessors name="next" next="GetProductSet2"/>
  </nodes>
<!--@Location 12,24-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetProductSet2">
    <pipelet href="enfinity:/xcs/pipelets/GetProductSet.xml"/>
    <nodeSuccessors name="next" next="AddObjectToCollection2"/>
    <nodeSuccessors name="pipelet_error" next="EndNode19"/>
  </nodes>
<!--@Location 12,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToCollection2">
    <pipelet href="enfinity:/core/pipelets/AddObjectToCollection.xml"/>
    <nodeSuccessors name="next" next="AddObjectToVector12"/>
    <parameterBindings name="InCollection" nullBinding="true"/>
    <parameterBindings name="InObject" objectPath="ProductSet"/>
    <returnValueBindings name="OutCollection" objectPath="ProductSets"/>
    <returnValueBindings name="OutIterator" nullBinding="true"/>
  </nodes>
<!--@Location 12,26-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector12">
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
    <nodeSuccessors name="next" next="CallNode21"/>
    <parameterBindings name="InVector" nullBinding="true"/>
    <parameterBindings name="Object" nullBinding="true"/>
    <parameterBindings name="Objects" objectPath="ProductSet:Domains"/>
    <returnValueBindings name="Iterator" nullBinding="true"/>
    <returnValueBindings name="OutVector" objectPath="AssignedDomains"/>
  </nodes>
<!--@Location 12,27-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode21">
    <nodeSuccessors name="next" next="CallNode28"/>
    <parameterBindings name="FromMultipleDomains" objectPath="AssignedDomains"/>
    <parameterBindings name="MultipleProducts" objectPath="ProductSet:Products"/>
    <parameterBindings name="PageletModelRepository" objectPath="ApplicationBO:Extension(&quot;(Class)com.intershop.sellside.pmc.capi.modelrepository.ApplicationBOPageletModelRepository&quot;)"/>
    <parameterBindings name="SourceDomain" objectPath="ProductSet:Domain"/>
    <parameterBindings name="TargetDomains" objectPath="AssignedDomains"/>
    <startNode referencedName="ProcessProductSharing-TriggerUnshareConsequences"/>
  </nodes>
<!--@Location 12,28-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode28">
    <nodeSuccessors name="next" next="CallNode25"/>
    <parameterBindings name="Application" objectPath="CurrentApplication"/>
    <parameterBindings name="SourceDomain" objectPath="Repository:RepositoryDomain"/>
    <startNode referencedName="ProcessProductSharing-DeleteProductSets"/>
  </nodes>
<!--@Location 12,29-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode25">
    <nodeSuccessors name="next" next="EndNode18"/>
    <startNode referencedName="ViewProductSharing-NoProductsProductSetAssignment"/>
  </nodes>
<!--@Location 12,30-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode18" strict="true"/>
<!--@Location 13,24-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode19" strict="true"/>
<!--@Location 6,19-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode17" strict="true" name="BatchDeleteChannelAssignments"
      callMode="Private">
    <nodeSuccessors name="next" next="GetApplicationBO1"/>
    <parameters name="SourceDomain" type="com.intershop.beehive.core.capi.domain.Domain"/>
    <parameters name="SourceRepository" type="com.intershop.component.mvc.capi.catalog.Repository"/>
    <parameters name="RepositoryUUIDIterator" type="java.util.Iterator&lt;java.lang.String>"/>
  </nodes>
<!--@Location 6,20-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetApplicationBO1">
    <pipelet href="enfinity:/bc_application/pipelets/GetApplicationBO.xml"/>
    <nodeSuccessors name="next" next="LoopNode21" action="begin"/>
  </nodes>
<!--@Location 6,21-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode21" loop="RepositoryUUIDIterator">
    <nodeSuccessors name="next" next="EndNode16" action="commit"/>
    <entry key="RepositoryUUID">
      <nodeSuccessors name="loop_entry_next" next="GetRepositoryByUUID0"/>
    </entry>
  </nodes>
<!--@Location 6,22-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetRepositoryByUUID0">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetRepositoryByUUID.xml"/>
    <nodeSuccessors name="next" next="AddObjectToVector10"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode27"/>
    <parameterBindings name="UUID" objectPath="RepositoryUUID"/>
    <returnValueBindings name="Repository" objectPath="ChannelRepository"/>
  </nodes>
<!--@Location 6,23-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector10">
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
    <nodeSuccessors name="next" next="CallNode16"/>
    <parameterBindings name="InVector" nullBinding="true"/>
    <parameterBindings name="Object" objectPath="ChannelRepository:RepositoryDomain"/>
    <parameterBindings name="Objects" nullBinding="true"/>
    <returnValueBindings name="Iterator" objectPath="ChannelRepositoryDomainsIterator"/>
    <returnValueBindings name="OutVector" objectPath="ChannelRepositoryDomains"/>
  </nodes>
<!--@Location 6,24-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode16">
    <nodeSuccessors name="next" next="GetAssignedProductSets0"/>
    <parameterBindings name="PageletModelRepository" objectPath="ApplicationBO:Extension(&quot;(Class)com.intershop.sellside.pmc.capi.modelrepository.ApplicationBOPageletModelRepository&quot;)"/>
    <parameterBindings name="SourceDomain" objectPath="SourceRepository:RepositoryDomain"/>
    <parameterBindings name="TargetDomains" objectPath="ChannelRepositoryDomainsIterator"/>
    <parameterBindings name="UnsharedProducts" nullBinding="true"/>
    <startNode referencedName="ProcessProductConfigurationParameters-ProcessUnshare"/>
  </nodes>
<!--@Location 6,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetAssignedProductSets0">
    <pipelet href="enfinity:/xcs/pipelets/GetAssignedProductSets.xml"/>
    <nodeSuccessors name="next" next="LoopNode20"/>
    <parameterBindings name="Domain" objectPath="ChannelRepository:RepositoryDomain"/>
  </nodes>
<!--@Location 6,26-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode20" loop="ProductSets">
<!--@BendPoints 15,53-->
    <nodeSuccessors name="next" next="CallNode15"/>
    <entry key="ProductSet">
      <nodeSuccessors name="loop_entry_next" next="DecisionNode16"/>
    </entry>
  </nodes>
<!--@Location 6,27-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode16" conditionKey="ProductSet:DomainID"
      operator="str_eq" conditionItem="SourceRepository:RepositoryDomain:DomainID">
    <nodeSuccessors name="decision_yes" next="CallNode13"/>
    <nodeSuccessors name="decision_no" next="JoinNode26"/>
  </nodes>
<!--@Location 6,28-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode13">
    <nodeSuccessors name="next" next="JoinNode26"/>
    <parameterBindings name="MultipleProducts" objectPath="ProductSet:Products"/>
    <parameterBindings name="PageletModelRepository" objectPath="ApplicationBO:Extension(&quot;(Class)com.intershop.sellside.pmc.capi.modelrepository.ApplicationBOPageletModelRepository&quot;)"/>
    <parameterBindings name="SourceDomain" objectPath="SourceRepository:RepositoryDomain"/>
    <parameterBindings name="TargetDomains" objectPath="ChannelRepositoryDomains"/>
    <startNode referencedName="ProcessProductSharing-TriggerUnshareConsequences"/>
  </nodes>
<!--@Location 5,28-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode26">
<!--@BendPoints 11,56 11,53-->
    <nodeSuccessors name="next" next="LoopNode20_Entry"/>
  </nodes>
<!--@Location 7,28-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode15">
    <nodeSuccessors name="next" next="CallNode19"/>
    <parameterBindings name="TargetRepository" objectPath="ChannelRepository"/>
    <startNode referencedName="ProcessProductSharing-RemoveAllPEPAs"/>
  </nodes>
<!--@Location 7,29-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode19">
    <nodeSuccessors name="next" next="CallNode17" action="savepoint"/>
    <parameterBindings name="TargetDomain" objectPath="ChannelRepository:RepositoryDomain"/>
    <startNode referencedName="ProcessProductSharing-UnshareDomain"/>
  </nodes>
<!--@Location 6,29-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode17">
<!--@BendPoints 9,59-->
    <nodeSuccessors name="next" next="JoinNode27"/>
    <parameterBindings name="TargetDomains" objectPath="ChannelRepositoryDomains"/>
    <startNode referencedName="ProcessProductSharing-DeleteSharingRelatedEntries"/>
  </nodes>
<!--@Location 4,22-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode27">
<!--@BendPoints 9,43-->
    <nodeSuccessors name="next" next="LoopNode21_Entry"/>
  </nodes>
<!--@Location 8,21-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode16" strict="true"/>
<!--@Location 17,22-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode21" strict="true" name="BatchDeleteChannelAssignmentsFromProductSet"
      callMode="Private">
    <nodeSuccessors name="next" next="GetProductSet4"/>
    <parameters name="RepositoryUUIDIterator" type="java.util.Iterator&lt;java.lang.String>"/>
    <parameters name="ProductSetID" type="java.lang.String"/>
    <parameters name="Repository" type="com.intershop.component.mvc.capi.catalog.Repository"/>
    <parameters name="CurrentApplication" type="com.intershop.beehive.core.capi.domain.Application"/>
  </nodes>
<!--@Location 17,23-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetProductSet4">
    <pipelet href="enfinity:/xcs/pipelets/GetProductSet.xml"/>
    <nodeSuccessors name="next" next="GetApplicationBO5"/>
<!--@BendPoints 39,47-->
    <nodeSuccessors name="pipelet_error" next="JoinNode38"/>
  </nodes>
<!--@Location 17,24-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetApplicationBO5">
    <pipelet href="enfinity:/bc_application/pipelets/GetApplicationBO.xml"/>
    <nodeSuccessors name="next" next="DecisionNode20"/>
  </nodes>
<!--@Location 17,25-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode20" conditionKey="RepositoryUUIDIterator"
      operator="has_elements">
    <nodeSuccessors name="decision_yes" next="LoopNode26"/>
    <nodeSuccessors name="decision_no" next="JoinNode38"/>
  </nodes>
<!--@Location 17,26-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode26" loop="RepositoryUUIDIterator">
<!--@BendPoints 37,53-->
    <nodeSuccessors name="next" next="AddObjectToCollection4"/>
    <entry key="RepositoryUUID">
      <nodeSuccessors name="loop_entry_next" next="GetRepositoryByUUID2"/>
    </entry>
  </nodes>
<!--@Location 17,27-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetRepositoryByUUID2">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetRepositoryByUUID.xml"/>
    <nodeSuccessors name="next" next="AddObjectToCollection3"/>
<!--@BendPoints 36,55 36,61-->
    <nodeSuccessors name="pipelet_error" next="JoinNode34"/>
    <parameterBindings name="UUID" objectPath="RepositoryUUID"/>
    <returnValueBindings name="Repository" objectPath="SelectedChannel"/>
  </nodes>
<!--@Location 17,28-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToCollection3">
    <pipelet href="enfinity:/core/pipelets/AddObjectToCollection.xml"/>
    <nodeSuccessors name="next" next="AddObjectToCollection5"/>
    <parameterBindings name="InCollection" objectPath="SelectedChannels"/>
    <parameterBindings name="InObject" objectPath="SelectedChannel"/>
    <returnValueBindings name="OutCollection" objectPath="SelectedChannels"/>
    <returnValueBindings name="OutIterator" nullBinding="true"/>
  </nodes>
<!--@Location 17,29-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToCollection5">
    <pipelet href="enfinity:/core/pipelets/AddObjectToCollection.xml"/>
    <nodeSuccessors name="next" next="JoinNode34"/>
    <parameterBindings name="InCollection" objectPath="SelectedChannelDomains"/>
    <parameterBindings name="InObject" objectPath="SelectedChannel:RepositoryDomain"/>
    <returnValueBindings name="OutCollection" objectPath="SelectedChannelDomains"/>
    <returnValueBindings name="OutIterator" nullBinding="true"/>
  </nodes>
<!--@Location 17,30-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode34">
<!--@BendPoints 34,61 34,53-->
    <nodeSuccessors name="next" next="LoopNode26_Entry"/>
  </nodes>
<!--@Location 18,27-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToCollection4">
    <pipelet href="enfinity:/core/pipelets/AddObjectToCollection.xml"/>
    <nodeSuccessors name="next" next="GetProductsToUnshareFromProductSets2"/>
    <parameterBindings name="InCollection" nullBinding="true"/>
    <parameterBindings name="InObject" objectPath="ProductSet"/>
    <returnValueBindings name="OutCollection" objectPath="ProductSetCollection"/>
    <returnValueBindings name="OutIterator" nullBinding="true"/>
  </nodes>
<!--@Location 18,28-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetProductsToUnshareFromProductSets2">
    <pipelet href="enfinity:/xcs/pipelets/GetProductsToUnshareFromProductSets.xml"/>
    <nodeSuccessors name="next" next="CallNode31"/>
    <parameterBindings name="ProductSets" objectPath="ProductSetCollection"/>
    <parameterBindings name="SourceDomain" objectPath="Repository:RepositoryDomain"/>
    <parameterBindings name="TargetDomains" objectPath="SelectedChannelDomains"/>
  </nodes>
<!--@Location 18,29-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode31">
<!--@BendPoints 37,62 35,62-->
    <nodeSuccessors name="next" next="LoopNode25" action="begin"/>
    <parameterBindings name="SourceDomain" objectPath="Repository:RepositoryDomain"/>
    <startNode referencedName="ProcessProductSharing-CleanupProductAssignments"/>
  </nodes>
<!--@Location 17,31-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode25" loop="SelectedChannels">
    <nodeSuccessors name="next" next="JoinNode37" action="commit"/>
    <entry key="ChannelRepository">
      <nodeSuccessors name="loop_entry_next" next="AddObjectToVector13"/>
    </entry>
  </nodes>
<!--@Location 17,32-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector13">
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
    <nodeSuccessors name="next" next="CallNode33"/>
    <parameterBindings name="InVector" nullBinding="true"/>
    <parameterBindings name="Object" objectPath="ChannelRepository:RepositoryDomain"/>
    <parameterBindings name="Objects" nullBinding="true"/>
    <returnValueBindings name="Iterator" nullBinding="true"/>
    <returnValueBindings name="OutVector" objectPath="TargetDomains"/>
  </nodes>
<!--@Location 17,33-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode33">
    <nodeSuccessors name="next" next="UnassignProductSetFromDomain1"/>
    <parameterBindings name="FromSingleDomain" objectPath="ChannelRepository:RepositoryDomain"/>
    <parameterBindings name="MultipleProducts" objectPath="ProductSet:Products"/>
    <parameterBindings name="PageletModelRepository" objectPath="ApplicationBO:Extension(&quot;(Class)com.intershop.sellside.pmc.capi.modelrepository.ApplicationBOPageletModelRepository&quot;)"/>
    <parameterBindings name="SourceDomain" objectPath="ProductSet:Domain"/>
    <parameterBindings name="TargetDomains" objectPath="TargetDomains"/>
    <startNode referencedName="ProcessProductSharing-TriggerUnshareConsequences"/>
  </nodes>
<!--@Location 17,34-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UnassignProductSetFromDomain1">
    <pipelet href="enfinity:/xcs/pipelets/UnassignProductSetFromDomain.xml"/>
    <nodeSuccessors name="next" next="CallNode32" action="savepoint"/>
    <parameterBindings name="Domain" objectPath="ChannelRepository:RepositoryDomain"/>
  </nodes>
<!--@Location 17,35-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode32">
    <nodeSuccessors name="next" next="GetAssignedProductSets3"/>
    <startNode referencedName="ProcessProductSharing-DeleteSharingRelatedEntries"/>
  </nodes>
<!--@Location 17,36-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetAssignedProductSets3">
    <pipelet href="enfinity:/xcs/pipelets/GetAssignedProductSets.xml"/>
    <nodeSuccessors name="next" next="DecisionNode19"/>
    <parameterBindings name="Domain" objectPath="ChannelRepository:RepositoryDomain"/>
  </nodes>
<!--@Location 17,37-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode19" conditionKey="ProductSets"
      operator="has_elements">
    <nodeSuccessors name="decision_yes" next="JoinNode31"/>
<!--@BendPoints 36,75-->
    <nodeSuccessors name="decision_no" next="CallNode30"/>
  </nodes>
<!--@Location 17,38-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode31">
<!--@BendPoints 33,77 33,63-->
    <nodeSuccessors name="next" next="LoopNode25_Entry"/>
  </nodes>
<!--@Location 18,37-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode30">
    <nodeSuccessors name="next" next="AssignProductSetToDomain1"/>
    <parameterBindings name="Domain" objectPath="Repository:RepositoryDomain"/>
    <startNode referencedName="ProcessProductSharing-DetermineNoProductsProductSet"/>
  </nodes>
<!--@Location 18,38-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AssignProductSetToDomain1">
    <pipelet href="enfinity:/xcs/pipelets/AssignProductSetToDomain.xml"/>
<!--@BendPoints 36,77-->
    <nodeSuccessors name="next" next="JoinNode31"/>
    <parameterBindings name="Domain" objectPath="ChannelRepository:RepositoryDomain"/>
    <parameterBindings name="ProductSet" objectPath="NoProductsProductSet"/>
  </nodes>
<!--@Location 19,31-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode37">
    <nodeSuccessors name="next" next="EndNode21"/>
  </nodes>
<!--@Location 19,32-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode21" strict="true"/>
<!--@Location 19,25-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode38">
    <nodeSuccessors name="next" next="JoinNode37"/>
  </nodes>
<!--@Location 1,19-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode16" strict="true" name="BatchDeleteProductSets"
      callMode="Private">
    <nodeSuccessors name="next" next="GetApplicationBO0"/>
    <parameters name="ProductSetUUIDIterator" type="java.util.Iterator&lt;java.lang.String>"/>
    <parameters name="CurrentApplication" type="com.intershop.beehive.core.capi.domain.Application"/>
    <parameters name="SourceDomain" type="com.intershop.beehive.core.capi.domain.Domain"/>
  </nodes>
<!--@Location 1,20-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetApplicationBO0">
    <pipelet href="enfinity:/bc_application/pipelets/GetApplicationBO.xml"/>
    <nodeSuccessors name="next" next="KeyMapper5"/>
  </nodes>
<!--@Location 1,21-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper5">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="LoopNode19"/>
    <parameterBindings name="InValue_1" objectPath="ApplicationBO:Extension(&quot;(Class)com.intershop.sellside.pmc.capi.modelrepository.ApplicationBOPageletModelRepository&quot;)"/>
    <returnValueBindings name="OutValue_1" objectPath="PageletModelRepository"/>
  </nodes>
<!--@Location 1,22-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode19" loop="ProductSetUUIDIterator">
<!--@BendPoints 5,45-->
    <nodeSuccessors name="next" next="DecisionNode15"/>
    <entry key="ProductSetID">
      <nodeSuccessors name="loop_entry_next" next="GetProductSet0"/>
    </entry>
  </nodes>
<!--@Location 1,23-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetProductSet0">
    <pipelet href="enfinity:/xcs/pipelets/GetProductSet.xml"/>
    <nodeSuccessors name="next" next="KeyMapper4"/>
<!--@BendPoints 4,47 4,57-->
    <nodeSuccessors name="pipelet_error" next="JoinNode23"/>
  </nodes>
<!--@Location 1,24-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper4">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="CallNode12"/>
    <parameterBindings name="InValue_1" objectPath="ProductSet:Domains"/>
    <returnValueBindings name="OutValue_1" objectPath="TargetDomains"/>
  </nodes>
<!--@Location 1,25-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode12">
    <nodeSuccessors name="End" next="AddObjectToVector8"/>
    <parameterBindings name="FromMultipleDomains" objectPath="TargetDomains"/>
    <parameterBindings name="MultipleProducts" objectPath="ProductSet:Products"/>
    <parameterBindings name="SourceDomain" objectPath="ProductSet:Domain"/>
    <startNode referencedName="ProcessProductSharing-TriggerUnshareConsequences"/>
  </nodes>
<!--@Location 1,26-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector8">
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
    <nodeSuccessors name="next" next="AddObjectToVector9"/>
    <parameterBindings name="InVector" objectPath="ProductSets"/>
    <parameterBindings name="Object" objectPath="ProductSet"/>
    <parameterBindings name="Objects" nullBinding="true"/>
    <returnValueBindings name="Iterator" nullBinding="true"/>
    <returnValueBindings name="OutVector" objectPath="ProductSets"/>
  </nodes>
<!--@Location 1,27-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector9">
    <configurationValues name="Mode" value="Forbid Duplicates"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
    <nodeSuccessors name="next" next="JoinNode23"/>
    <parameterBindings name="InVector" objectPath="AssignedDomains"/>
    <parameterBindings name="Object" nullBinding="true"/>
    <parameterBindings name="Objects" objectPath="ProductSet:Domains"/>
    <returnValueBindings name="Iterator" nullBinding="true"/>
    <returnValueBindings name="OutVector" objectPath="AssignedDomains"/>
  </nodes>
<!--@Location 1,28-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode23">
<!--@BendPoints 1,57 1,45-->
    <nodeSuccessors name="next" next="LoopNode19_Entry"/>
  </nodes>
<!--@Location 2,23-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode15" conditionKey="ProductSets"
      operator="has_elements">
    <nodeSuccessors name="decision_yes" next="CallNode10"/>
<!--@BendPoints 7,47-->
    <nodeSuccessors name="decision_no" next="JoinNode24"/>
  </nodes>
<!--@Location 2,24-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode10">
    <nodeSuccessors name="next" next="DecisionNode14"/>
    <parameterBindings name="Application" objectPath="CurrentApplication"/>
    <startNode referencedName="ProcessProductSharing-DeleteProductSets"/>
  </nodes>
<!--@Location 2,25-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode14" conditionKey="AssignedDomains"
      operator="has_elements">
    <nodeSuccessors name="decision_yes" next="GetRepositoryByRepositoryDomain_gU8ZkFEUEeejmZeC5hpOXA"/>
    <nodeSuccessors name="decision_no" next="JoinNode24"/>
  </nodes>
<!--@Location 2,26-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetRepositoryByRepositoryDomain_gU8ZkFEUEeejmZeC5hpOXA">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetRepositoryByRepositoryDomain.xml"/>
    <nodeSuccessors name="next" next="CallNode14"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode_jC-GEFEUEeejmZeC5hpOXA"/>
    <parameterBindings name="RepositoryDomain" objectPath="SourceDomain"/>
  </nodes>
<!--@Location 2,27-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode14">
    <nodeSuccessors name="next" next="JoinNode25"/>
    <startNode referencedName="ViewProductSharing-NoProductsProductSetAssignment"/>
  </nodes>
<!--@Location 2,28-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode25">
    <nodeSuccessors name="next" next="EndNode15"/>
  </nodes>
<!--@Location 2,29-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode15" strict="true"/>
<!--@Location 3,26-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode_jC-GEFEUEeejmZeC5hpOXA">
<!--@BendPoints 7,57-->
    <nodeSuccessors name="next" next="JoinNode25"/>
  </nodes>
<!--@Location 3,25-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode24">
    <nodeSuccessors name="next" next="JoinNode_jC-GEFEUEeejmZeC5hpOXA"/>
  </nodes>
<!--@Location 10,22-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode18" strict="true" name="BatchUnassignProductSetsFromChannel"
      callMode="Private">
    <nodeSuccessors name="next" next="GetApplicationBO2"/>
    <parameters name="Repository" type="com.intershop.component.mvc.capi.catalog.Repository"/>
    <parameters name="ProductSetUUIDIterator" type="java.util.Iterator&lt;java.lang.String>"/>
    <parameters name="SharingTargetChannelID" type="java.lang.String"/>
    <parameters name="CurrentApplication" type="com.intershop.beehive.core.capi.domain.Application"/>
<!--UUID of the job configuration.-->
    <parameters name="JobConfigurationUUID" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 10,23-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetApplicationBO2">
    <pipelet href="enfinity:/bc_application/pipelets/GetApplicationBO.xml"/>
    <nodeSuccessors name="next" next="GetRepositoryByUUID1"/>
  </nodes>
<!--@Location 10,24-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetRepositoryByUUID1">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetRepositoryByUUID.xml"/>
    <nodeSuccessors name="next" next="AddObjectToVector11"/>
<!--@BendPoints 22,49 22,53-->
    <nodeSuccessors name="pipelet_error" next="JoinNode30"/>
    <parameterBindings name="UUID" objectPath="SharingTargetChannelID"/>
    <returnValueBindings name="Repository" objectPath="Channel"/>
  </nodes>
<!--@Location 10,25-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector11">
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
    <nodeSuccessors name="next" next="JoinNode30"/>
    <parameterBindings name="InVector" nullBinding="true"/>
    <parameterBindings name="Object" objectPath="Channel:RepositoryDomain"/>
    <parameterBindings name="Objects" nullBinding="true"/>
    <returnValueBindings name="Iterator" nullBinding="true"/>
    <returnValueBindings name="OutVector" objectPath="TargetDomains"/>
  </nodes>
<!--@Location 10,26-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode30">
    <nodeSuccessors name="next" next="DecisionNode18"/>
  </nodes>
<!--@Location 10,27-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode18" conditionKey="ProductSetUUIDIterator"
      operator="has_elements">
    <nodeSuccessors name="decision_yes" next="LoopNode23"/>
<!--@BendPoints 19,55 19,73 19,87-->
    <nodeSuccessors name="decision_no" next="JoinNode29"/>
  </nodes>
<!--@Location 10,28-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode23" loop="ProductSetUUIDIterator">
<!--@BendPoints 23,57 23,64 21,64-->
    <nodeSuccessors name="next" next="DecisionNode21"/>
    <entry key="ProductSetID">
      <nodeSuccessors name="loop_entry_next" next="GetProductSet1"/>
    </entry>
  </nodes>
<!--@Location 10,29-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetProductSet1">
    <pipelet href="enfinity:/xcs/pipelets/GetProductSet.xml"/>
    <nodeSuccessors name="next" next="AddObjectToCollection1"/>
<!--@BendPoints 22,59 22,63-->
    <nodeSuccessors name="pipelet_error" next="JoinNode28"/>
    <returnValueBindings name="ProductSet" objectPath="SelectedProductSet"/>
  </nodes>
<!--@Location 10,30-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToCollection1">
    <pipelet href="enfinity:/core/pipelets/AddObjectToCollection.xml"/>
    <nodeSuccessors name="next" next="JoinNode28"/>
    <parameterBindings name="InCollection" objectPath="SelectedProductSetsCollection"/>
    <parameterBindings name="InObject" objectPath="SelectedProductSet"/>
    <returnValueBindings name="OutCollection" objectPath="SelectedProductSetsCollection"/>
    <returnValueBindings name="OutIterator" nullBinding="true"/>
  </nodes>
<!--@Location 10,31-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode28">
<!--@BendPoints 20,63 20,57-->
    <nodeSuccessors name="next" next="LoopNode23_Entry"/>
  </nodes>
<!--@Location 10,32-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode21" conditionKey="JobConfigurationUUID">
    <nodeSuccessors name="decision_yes" next="GetJobConfiguration1"/>
<!--@BendPoints 23,65-->
    <nodeSuccessors name="decision_no" next="JoinNode40"/>
  </nodes>
<!--@Location 10,33-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetJobConfiguration1">
    <pipelet href="enfinity:/core/pipelets/GetJobConfiguration.xml"/>
    <nodeSuccessors name="next" next="CreatePageableFromCollection0"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode40"/>
    <parameterBindings name="JobUUID" objectPath="JobConfigurationUUID"/>
  </nodes>
<!--@Location 10,34-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreatePageableFromCollection0">
    <pipelet href="enfinity:/bc_foundation/pipelets/CreatePageableFromCollection.xml"/>
    <nodeSuccessors name="next" next="MonitorPageable0"/>
    <parameterBindings name="Collection" objectPath="SelectedProductSetsCollection"/>
    <returnValueBindings name="Pageable" objectPath="SelectedProductSets"/>
  </nodes>
<!--@Location 10,35-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="MonitorPageable0">
    <pipelet href="enfinity:/core/pipelets/MonitorPageable.xml"/>
    <nodeSuccessors name="next" next="JoinNode41"/>
    <parameterBindings name="PageableIterator" objectPath="SelectedProductSets"/>
    <parameterBindings name="ProgressMonitor" objectPath="JobConfiguration:CurrentProcess"/>
  </nodes>
<!--@Location 10,36-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode41">
    <nodeSuccessors name="next" next="GetProductsToUnshareFromProductSets1"/>
  </nodes>
<!--@Location 10,37-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetProductsToUnshareFromProductSets1">
    <pipelet href="enfinity:/xcs/pipelets/GetProductsToUnshareFromProductSets.xml"/>
    <nodeSuccessors name="next" next="CallNode18"/>
    <parameterBindings name="ProductSets" objectPath="SelectedProductSetsCollection"/>
    <parameterBindings name="SourceDomain" objectPath="Repository:RepositoryDomain"/>
  </nodes>
<!--@Location 10,38-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode18">
    <nodeSuccessors name="next" next="LoopNode22" action="begin"/>
    <parameterBindings name="SourceDomain" objectPath="Repository:RepositoryDomain"/>
    <startNode referencedName="ProcessProductSharing-CleanupProductAssignments"/>
  </nodes>
<!--@Location 10,39-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode22" loop="SelectedProductSets">
<!--@BendPoints 23,79-->
    <nodeSuccessors name="next" next="GetAssignedProductSets2" action="commit"/>
    <entry key="ProductSet">
      <nodeSuccessors name="loop_entry_next" next="CallNode24"/>
    </entry>
  </nodes>
<!--@Location 10,40-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode24">
    <nodeSuccessors name="next" next="UnassignProductSetFromDomain0"/>
    <parameterBindings name="FromSingleDomain" objectPath="Channel:RepositoryDomain"/>
    <parameterBindings name="MultipleProducts" objectPath="ProductSet:Products"/>
    <parameterBindings name="PageletModelRepository" objectPath="ApplicationBO:Extension(&quot;(Class)com.intershop.sellside.pmc.capi.modelrepository.ApplicationBOPageletModelRepository&quot;)"/>
    <parameterBindings name="SourceDomain" objectPath="ProductSet:Domain"/>
    <parameterBindings name="TargetDomains" objectPath="TargetDomains"/>
    <startNode referencedName="ProcessProductSharing-TriggerUnshareConsequences"/>
  </nodes>
<!--@Location 10,41-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UnassignProductSetFromDomain0">
    <pipelet href="enfinity:/xcs/pipelets/UnassignProductSetFromDomain.xml"/>
    <nodeSuccessors name="next" next="CallNode23" action="savepoint"/>
    <parameterBindings name="Domain" objectPath="Channel:RepositoryDomain"/>
  </nodes>
<!--@Location 10,42-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode23">
<!--@BendPoints 21,86 20,86 20,79-->
    <nodeSuccessors name="next" next="LoopNode22_Entry"/>
    <startNode referencedName="ProcessProductSharing-DeleteSharingRelatedEntries"/>
  </nodes>
<!--@Location 11,40-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetAssignedProductSets2">
    <pipelet href="enfinity:/xcs/pipelets/GetAssignedProductSets.xml"/>
    <nodeSuccessors name="next" next="DecisionNode17"/>
    <parameterBindings name="Domain" objectPath="Channel:RepositoryDomain"/>
  </nodes>
<!--@Location 11,41-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode17" conditionKey="ProductSets"
      operator="has_elements">
    <nodeSuccessors name="decision_yes" next="JoinNode29"/>
    <nodeSuccessors name="decision_no" next="CallNode20"/>
  </nodes>
<!--@Location 11,43-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode29">
    <nodeSuccessors name="next" next="EndNode17"/>
  </nodes>
<!--@Location 11,44-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode17" strict="true"/>
<!--@Location 12,41-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode20">
    <nodeSuccessors name="next" next="AssignProductSetToDomain0"/>
    <parameterBindings name="Domain" objectPath="Repository:RepositoryDomain"/>
    <startNode referencedName="ProcessProductSharing-DetermineNoProductsProductSet"/>
  </nodes>
<!--@Location 12,42-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AssignProductSetToDomain0">
    <pipelet href="enfinity:/xcs/pipelets/AssignProductSetToDomain.xml"/>
<!--@BendPoints 25,87-->
    <nodeSuccessors name="next" next="JoinNode29"/>
    <parameterBindings name="Domain" objectPath="Channel:RepositoryDomain"/>
    <parameterBindings name="ProductSet" objectPath="NoProductsProductSet"/>
  </nodes>
<!--@Location 11,33-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode40">
    <nodeSuccessors name="next" next="KeyMapper7"/>
  </nodes>
<!--@Location 11,34-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper7">
    <pipelet href="enfinity:/core/pipelets/KeyMapper.xml"/>
<!--@BendPoints 23,73-->
    <nodeSuccessors name="next" next="JoinNode41"/>
    <parameterBindings name="InValue_1" objectPath="SelectedProductSetsCollection"/>
    <returnValueBindings name="OutValue_1" objectPath="SelectedProductSets"/>
  </nodes>
<!--@Location 14,22-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode20" strict="true" name="BatchUnassignProducts"
      callMode="Include">
    <nodeSuccessors name="next" next="GetApplicationBO4"/>
    <parameters name="Repository" type="com.intershop.component.mvc.capi.catalog.Repository"/>
    <parameters name="ProductUUIDIterator" type="java.util.Iterator&lt;java.lang.String>"/>
    <parameters name="ProductSetID" type="java.lang.String"/>
  </nodes>
<!--@Location 14,23-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetApplicationBO4">
    <pipelet href="enfinity:/bc_application/pipelets/GetApplicationBO.xml"/>
    <nodeSuccessors name="next" next="GetProductSet3"/>
  </nodes>
<!--@Location 14,24-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetProductSet3">
    <pipelet href="enfinity:/xcs/pipelets/GetProductSet.xml"/>
    <nodeSuccessors name="next" next="LoopNode24" action="begin"/>
<!--@BendPoints 31,49-->
    <nodeSuccessors name="pipelet_error" next="JoinNode33"/>
  </nodes>
<!--@Location 14,25-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode24" loop="ProductUUIDIterator">
    <nodeSuccessors name="next" next="JoinNode33" action="commit"/>
    <entry key="ProductUUID">
      <nodeSuccessors name="loop_entry_next" next="GetProductByUUID1"/>
    </entry>
  </nodes>
<!--@Location 14,26-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetProductByUUID1">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetProductByUUID.xml"/>
    <nodeSuccessors name="next" next="UnassignProductFromProductSet0"/>
<!--@BendPoints 30,53 30,63-->
    <nodeSuccessors name="pipelet_error" next="JoinNode32"/>
    <parameterBindings name="ProductDomain" objectPath="Repository:RepositoryDomain"/>
  </nodes>
<!--@Location 14,27-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UnassignProductFromProductSet0">
    <pipelet href="enfinity:/xcs/pipelets/UnassignProductFromProductSet.xml"/>
    <nodeSuccessors name="next" next="UnshareBundleAssignments0" action="savepoint"/>
  </nodes>
<!--@Location 14,28-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UnshareBundleAssignments0">
    <configurationValues name="CheckSharing" value="true"/>
    <pipelet href="enfinity:/xcs/pipelets/UnshareBundleAssignments.xml"/>
    <nodeSuccessors name="next" next="CallNode29"/>
    <parameterBindings name="ProductID" objectPath="ProductUUID"/>
    <parameterBindings name="TargetDomains" objectPath="ProductSet:Domains"/>
  </nodes>
<!--@Location 14,29-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode29">
    <nodeSuccessors name="next" next="CallNode26"/>
    <parameterBindings name="FromMultipleDomains" objectPath="ProductSet:Domains"/>
    <parameterBindings name="PageletModelRepository" objectPath="ApplicationBO:Extension(&quot;(Class)com.intershop.sellside.pmc.capi.modelrepository.ApplicationBOPageletModelRepository&quot;)"/>
    <parameterBindings name="SingleProduct" objectPath="Product"/>
    <parameterBindings name="SourceDomain" objectPath="ProductSet:Domain"/>
    <parameterBindings name="TargetDomains" objectPath="ProductSet:Domains"/>
    <startNode referencedName="ProcessProductSharing-TriggerUnshareConsequences"/>
  </nodes>
<!--@Location 14,30-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode26">
    <nodeSuccessors name="next" next="JoinNode32"/>
    <parameterBindings name="TargetDomains" objectPath="ProductSet:Domains"/>
    <startNode referencedName="ProcessProductSharing-DeleteSharingRelatedEntries"/>
  </nodes>
<!--@Location 14,31-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode32">
<!--@BendPoints 28,63 28,53-->
    <nodeSuccessors name="next" next="LoopNode24_Entry"/>
  </nodes>
<!--@Location 15,25-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode33">
<!--@BendPoints 32,51-->
    <nodeSuccessors name="next" next="EndNode20"/>
  </nodes>
<!--@Location 16,25-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode20" strict="true"/>
<!--@Location 14,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode5" strict="true" name="CheckIsSharingEnableForChannel"
      callMode="Private">
    <nodeSuccessors name="next" next="CreateProductSharingHelper1"/>
    <parameters name="RepositoryDomain" type="com.intershop.beehive.core.capi.domain.Domain"
        optional="true"/>
  </nodes>
<!--@Location 14,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateProductSharingHelper1">
    <pipelet href="enfinity:/xcs/pipelets/CreateProductSharingHelper.xml"/>
    <nodeSuccessors name="next" next="KeyMapper1"/>
    <parameterBindings name="Domain" objectPath="RepositoryDomain"/>
  </nodes>
<!--@Location 14,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper1">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="EndNode6"/>
    <parameterBindings name="InValue_1" objectPath="ProductSharingHelper:Enabled"/>
    <returnValueBindings name="OutValue_1" objectPath="SharingIsEnabled"/>
  </nodes>
<!--@Location 14,3-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode6" name="" strict="true">
    <returnValues name="SharingIsEnabled" type="java.lang.Boolean" optional="true"/>
  </nodes>
<!--@Location 24,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode11" strict="true" visibility="Private"
      name="CleanupProductAssignments" callMode="Private">
    <nodeSuccessors name="next" next="LoopNode16"/>
<!--Map<productUUID, Collection<Domain>>-->
    <parameters name="ProductsToUnshare" type="java.util.Map"/>
    <parameters name="SourceDomain" type="com.intershop.beehive.core.capi.domain.Domain"/>
  </nodes>
<!--@Location 24,1-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode16" loop="ProductsToUnshare:EntrySet">
    <nodeSuccessors name="next" next="EndNode11"/>
    <entry key="Entry">
      <nodeSuccessors name="loop_entry_next" next="KeyMapper2"/>
    </entry>
  </nodes>
<!--@Location 24,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper2">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="GetProductByUUID0"/>
    <parameterBindings name="InValue_1" objectPath="Entry:Key"/>
    <parameterBindings name="InValue_2" objectPath="Entry:Value"/>
    <returnValueBindings name="OutValue_1" objectPath="ProductUUID"/>
    <returnValueBindings name="OutValue_2" objectPath="Domains"/>
  </nodes>
<!--@Location 24,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetProductByUUID0">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetProductByUUID.xml"/>
    <nodeSuccessors name="next" next="CallNode8"/>
<!--@BendPoints 51,7 51,11-->
    <nodeSuccessors name="pipelet_error" next="JoinNode36"/>
    <parameterBindings name="ProductDomain" objectPath="SourceDomain"/>
  </nodes>
<!--@Location 24,4-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode8">
    <nodeSuccessors name="next" next="JoinNode36"/>
    <startNode referencedName="ProcessProductDeletion-CleanUpProductAssignments"/>
  </nodes>
<!--@Location 24,5-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode36">
<!--@BendPoints 48,11 48,3-->
    <nodeSuccessors name="next" next="LoopNode16_Entry"/>
  </nodes>
<!--@Location 25,1-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode11" strict="true"/>
<!--@Location 0,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode12" strict="true" name="CreateChannelSearchParameters"
      callMode="Private">
    <nodeSuccessors name="next" next="VerifySearchTerm2"/>
    <parameters name="SearchChannelID" type="java.lang.String" optional="true"/>
    <parameters name="SearchOrganizationID" type="java.lang.String" optional="true"/>
  </nodes>
<!--@Location 0,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="VerifySearchTerm2">
    <pipelet href="enfinity:/bc_foundation/pipelets/VerifySearchTerm.xml"/>
    <nodeSuccessors name="next" next="DecisionNode1"/>
<!--@BendPoints 5,3-->
    <nodeSuccessors name="pipelet_error" next="JoinNode11"/>
    <parameterBindings name="UserSearchTerm" objectPath="SearchChannelID"/>
    <returnValueBindings name="ErrorCode" objectPath="SearchChannelIDError"/>
    <returnValueBindings name="SearchExpression" objectPath="ChannelIDExpression"/>
  </nodes>
<!--@Location 0,2-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode1" conditionKey="SearchOrganizationID"
      operator="str_neq" conditionValue="all">
    <nodeSuccessors name="decision_yes" next="GetOrganization1"/>
<!--@BendPoints 2,5 2,9-->
    <nodeSuccessors name="decision_no" next="JoinNode13"/>
  </nodes>
<!--@Location 0,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetOrganization1">
    <configurationValues name="Source" value="PipelineDictionary"/>
    <pipelet href="enfinity:/bc_organization/pipelets/GetOrganization.xml"/>
    <nodeSuccessors name="next" next="JoinNode13"/>
    <nodeSuccessors name="pipelet_error" next="SetDictionaryValue1"/>
    <parameterBindings name="OrganizationUUID" objectPath="SearchOrganizationID"/>
    <returnValueBindings name="Organization" objectPath="SearchOrganization"/>
  </nodes>
<!--@Location 0,4-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode13">
<!--@BendPoints 1,10-->
    <nodeSuccessors name="next" next="UpdateDictionary2"/>
  </nodes>
<!--@Location 0,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateDictionary2">
    <configurationValues name="Name_01" value="ChannelIDExpression"/>
    <configurationValues name="Name_02" value="Organization"/>
    <pipelet href="enfinity:/core/pipelets/UpdateDictionary.xml"/>
    <nodeSuccessors name="next" next="JoinNode12"/>
    <parameterBindings name="Value_01" objectPath="ChannelIDExpression"/>
    <parameterBindings name="Value_02" objectPath="SearchOrganization"/>
    <returnValueBindings name="OutDictionary" objectPath="SearchParameters"/>
  </nodes>
<!--@Location 0,6-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode12">
<!--@BendPoints 1,14-->
    <nodeSuccessors name="next" next="EndNode3"/>
  </nodes>
<!--@Location 0,7-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode3" strict="true">
    <returnValues name="SearchChannelIDError" type="java.lang.String" optional="true"/>
    <returnValues name="SearchOrganizationIDError" type="java.lang.String" optional="true"/>
    <returnValues name="SearchParameters" type="java.util.Map"/>
  </nodes>
<!--@Location 1,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SetDictionaryValue1">
    <configurationValues name="Name" value="SearchOrganizationIDError"/>
    <configurationValues name="Value" value="NotFound"/>
    <configurationValues name="ValueType" value="Dictionary Value"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/SetDictionaryValue.xml"/>
    <nodeSuccessors name="next" next="JoinNode11"/>
  </nodes>
<!--@Location 2,3-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode11">
<!--@BendPoints 5,13-->
    <nodeSuccessors name="next" next="JoinNode12"/>
  </nodes>
<!--@Location 27,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode13" strict="true" name="DeleteProductSets"
      callMode="Private">
    <nodeSuccessors name="next" next="GetProductsToUnshareFromProductSets0"/>
    <parameters name="ProductSets" type="java.util.Collection"/>
    <parameters name="Application" type="com.intershop.beehive.core.capi.domain.Application"/>
    <parameters name="SourceDomain" type="com.intershop.beehive.core.capi.domain.Domain"/>
  </nodes>
<!--@Location 27,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetProductsToUnshareFromProductSets0">
    <pipelet href="enfinity:/xcs/pipelets/GetProductsToUnshareFromProductSets.xml"/>
    <nodeSuccessors name="next" next="CallNode7"/>
    <parameterBindings name="CurrentApplication" objectPath="Application"/>
  </nodes>
<!--@Location 27,2-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode7">
    <nodeSuccessors name="next" next="LoopNode15"/>
    <startNode referencedName="ProcessProductSharing-CleanupProductAssignments"/>
  </nodes>
<!--@Location 27,3-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode15" loop="ProductSets">
    <nodeSuccessors name="next" next="EndNode12"/>
    <entry key="ProductSet">
      <nodeSuccessors name="loop_entry_next" next="KeyMapper3"/>
    </entry>
  </nodes>
<!--@Location 27,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper3">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="CreateCollectionFromIterator0"/>
    <parameterBindings name="InValue_1" objectPath="ProductSet:Domains"/>
    <returnValueBindings name="OutValue_1" objectPath="TargetDomains"/>
  </nodes>
<!--@Location 27,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateCollectionFromIterator0">
    <pipelet href="enfinity:/bc_foundation/pipelets/CreateCollectionFromIterator.xml"/>
    <nodeSuccessors name="next" next="RemoveProductSet0"/>
    <parameterBindings name="ObjectIterator" objectPath="TargetDomains:Iterator"/>
    <returnValueBindings name="ObjectCollection" objectPath="TargetDomainsCollection"/>
  </nodes>
<!--@Location 27,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemoveProductSet0">
    <pipelet href="enfinity:/xcs/pipelets/RemoveProductSet.xml"/>
    <nodeSuccessors name="next" next="CallNode9"/>
  </nodes>
<!--@Location 27,7-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode9">
<!--@BendPoints 53,15 53,7-->
    <nodeSuccessors name="End" next="LoopNode15_Entry"/>
    <parameterBindings name="TargetDomains" objectPath="TargetDomainsCollection"/>
    <startNode referencedName="ProcessProductSharing-DeleteSharingRelatedEntries"/>
  </nodes>
<!--@Location 28,3-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode12" strict="true"/>
<!--@Location 22,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode8" strict="true" visibility="Private"
      name="DeleteSharingRelatedEntries" callMode="Private">
    <nodeSuccessors name="next" next="AddObjectToVector7"/>
    <parameters name="TargetDomains" type="java.util.Collection" optional="true"/>
    <parameters name="TargetDomain" type="com.intershop.beehive.core.capi.domain.Domain"
        optional="true"/>
  </nodes>
<!--@Location 22,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector7">
    <configurationValues name="Mode" value="Forbid Duplicates"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
    <nodeSuccessors name="next" next="LoopNode8"/>
    <parameterBindings name="Object" objectPath="TargetDomain"/>
    <parameterBindings name="Objects" objectPath="TargetDomains"/>
    <returnValueBindings name="Iterator" objectPath="TargetDomains"/>
  </nodes>
<!--@Location 22,2-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode8" loop="TargetDomains">
    <nodeSuccessors name="next" next="EndNode9"/>
    <entry key="TargetDomain">
      <nodeSuccessors name="loop_entry_next" next="AddEntryToMap2"/>
    </entry>
  </nodes>
<!--@Location 22,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddEntryToMap2">
    <pipelet href="enfinity:/bc_foundation/pipelets/AddEntryToMap.xml"/>
    <nodeSuccessors name="next" next="ExecuteObjectsQuery4"/>
    <parameterBindings name="Key" constant="ProductDomain"/>
    <parameterBindings name="Value" objectPath="TargetDomain"/>
    <returnValueBindings name="OutMap" objectPath="Parameters"/>
  </nodes>
<!--@Location 22,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ExecuteObjectsQuery4">
    <configurationValues name="Datasource" value="current ORM connection"/>
    <configurationValues name="QueryName" value="product/GetDerivedProductEntriesOfUnsharedProducts"/>
    <pipelet href="enfinity:/core/pipelets/ExecuteObjectsQuery.xml"/>
    <nodeSuccessors name="next" next="LoopNode12"/>
<!--@BendPoints 47,9 47,15-->
    <nodeSuccessors name="pipelet_error" next="JoinNode19"/>
    <returnValueBindings name="SearchResult" objectPath="DerivedProducts"/>
  </nodes>
<!--@Location 22,5-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode12" loop="DerivedProducts">
<!--@BendPoints 46,11 46,14-->
    <nodeSuccessors name="next" next="JoinNode19"/>
    <entry key="DerivedProduct">
      <nodeSuccessors name="loop_entry_next" next="RemoveDerivedProduct0"/>
    </entry>
  </nodes>
<!--@Location 22,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemoveDerivedProduct0">
    <pipelet href="enfinity:/xcs/pipelets/RemoveDerivedProduct.xml"/>
<!--@BendPoints 44,13 44,11-->
    <nodeSuccessors name="next" next="LoopNode12_Entry"/>
  </nodes>
<!--@Location 22,7-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode19">
    <nodeSuccessors name="next" next="ExecuteObjectsQuery2"/>
  </nodes>
<!--@Location 22,8-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ExecuteObjectsQuery2">
    <configurationValues name="Datasource" value="current ORM connection"/>
    <configurationValues name="QueryName" value="product/GetDerivedProductListPriceEntriesOfUnsharedProducts"/>
    <pipelet href="enfinity:/core/pipelets/ExecuteObjectsQuery.xml"/>
    <nodeSuccessors name="next" next="LoopNode9"/>
<!--@BendPoints 47,17 47,23-->
    <nodeSuccessors name="pipelet_error" next="JoinNode16"/>
    <returnValueBindings name="SearchResult" objectPath="ListPrices"/>
  </nodes>
<!--@Location 22,9-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode9" loop="ListPrices">
<!--@BendPoints 46,19 46,22-->
    <nodeSuccessors name="next" next="JoinNode16"/>
    <entry key="ListPrice">
      <nodeSuccessors name="loop_entry_next" next="RemoveProductListPrice0"/>
    </entry>
  </nodes>
<!--@Location 22,10-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemoveProductListPrice0">
    <pipelet href="enfinity:/bc_pricing/pipelets/RemoveProductListPrice.xml"/>
<!--@BendPoints 44,21 44,19-->
    <nodeSuccessors name="next" next="LoopNode9_Entry"/>
    <parameterBindings name="ProductListPrice" objectPath="ListPrice"/>
  </nodes>
<!--@Location 22,11-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode16">
    <nodeSuccessors name="next" next="ExecuteObjectsQuery3"/>
  </nodes>
<!--@Location 22,12-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ExecuteObjectsQuery3">
    <configurationValues name="Datasource" value="current ORM connection"/>
    <configurationValues name="QueryName" value="product/GetDerivedProductCostPriceEntriesOfUnsharedProducts"/>
    <pipelet href="enfinity:/core/pipelets/ExecuteObjectsQuery.xml"/>
    <nodeSuccessors name="next" next="LoopNode11"/>
    <parameterBindings name="Query" objectPath="product/GetDerivedProductCostPriceEntriesOfUnsharedProducts"/>
    <returnValueBindings name="SearchResult" objectPath="CostPrices"/>
  </nodes>
<!--@Location 22,13-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode11" loop="CostPrices">
<!--@BendPoints 47,27 47,29-->
    <nodeSuccessors name="next" next="ExecuteObjectsQuery1"/>
    <entry key="CostPrice">
      <nodeSuccessors name="loop_entry_next" next="RemoveProductCostPrice0"/>
    </entry>
  </nodes>
<!--@Location 22,14-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemoveProductCostPrice0">
    <pipelet href="enfinity:/bc_pricing/pipelets/RemoveProductCostPrice.xml"/>
<!--@BendPoints 44,29 44,27-->
    <nodeSuccessors name="next" next="LoopNode11_Entry"/>
    <parameterBindings name="ProductCostPrice" objectPath="CostPrice"/>
  </nodes>
<!--@Location 22,15-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ExecuteObjectsQuery1">
    <configurationValues name="Datasource" value="current ORM connection"/>
    <configurationValues name="QueryName" value="product/GetProductCompletenessOfUnsharedProducts"/>
    <pipelet href="enfinity:/core/pipelets/ExecuteObjectsQuery.xml"/>
    <nodeSuccessors name="next" next="LoopNode10"/>
    <parameterBindings name="Query" objectPath="product/GetProductCompletenessOfUnsharedProducts"/>
    <returnValueBindings name="SearchResult" objectPath="ProductCompletenesses"/>
  </nodes>
<!--@Location 22,16-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode10" loop="ProductCompletenesses">
<!--@BendPoints 47,33 47,37-->
    <nodeSuccessors name="next" next="ExecuteUpdateQuery0"/>
    <entry key="ProductCompleteness">
      <nodeSuccessors name="loop_entry_next" next="RemoveORMObject0"/>
    </entry>
  </nodes>
<!--@Location 22,17-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemoveORMObject0">
    <pipelet href="enfinity:/core/pipelets/RemoveORMObject.xml"/>
    <nodeSuccessors name="next" next="JoinNode14"/>
<!--@BendPoints 45,36 43,36-->
    <nodeSuccessors name="pipelet_error" next="JoinNode14"/>
    <parameterBindings name="ORMObject" objectPath="ProductCompleteness"/>
  </nodes>
<!--@Location 21,17-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode14">
<!--@BendPoints 43,33-->
    <nodeSuccessors name="next" next="LoopNode10_Entry"/>
  </nodes>
<!--@Location 22,18-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ExecuteUpdateQuery0">
    <configurationValues name="QueryName" value="DeleteProductValidationResultEntriesOfUnsharedProducts"/>
    <pipelet href="enfinity:/core/pipelets/ExecuteUpdateQuery.xml"/>
<!--@BendPoints 44,37 42,37 42,5-->
    <nodeSuccessors name="next" next="LoopNode8_Entry"/>
  </nodes>
<!--@Location 23,2-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode9" name="End" strict="true"/>
<!--@Location 7,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode2" strict="true" name="DetermineAllProductsProductSet"
      callMode="Private">
<!--@BendPoints 15,2-->
    <nodeSuccessors name="next" next="GetDomainWideProductSets1"/>
<!--The domain.-->
    <parameters name="Domain" type="com.intershop.beehive.core.capi.domain.Domain"/>
  </nodes>
<!--@Location 7,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetDomainWideProductSets1">
    <configurationValues name="AllProducts" value="true"/>
    <pipelet href="enfinity:/xcs/pipelets/GetDomainWideProductSets.xml"/>
<!--@BendPoints 15,4-->
    <nodeSuccessors name="next" next="DecisionNode2"/>
  </nodes>
<!--@Location 7,2-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode2" conditionKey="AllProductsProductSet">
    <nodeSuccessors name="decision_yes" next="JoinNode17"/>
<!--@BendPoints 17,5 17,6-->
    <nodeSuccessors name="decision_no" next="CreateProductSet1" action="begin"/>
  </nodes>
<!--@Location 7,5-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode17">
<!--@BendPoints 15,12-->
    <nodeSuccessors name="next" next="EndNode1"/>
  </nodes>
<!--@Location 7,6-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode1" strict="true">
<!--The product set for "all products".-->
    <returnValues name="AllProductsProductSet" type="com.intershop.beehive.xcs.capi.productset.ProductSet"/>
  </nodes>
<!--@Location 8,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateProductSet1">
    <configurationValues name="ProductSetType" value="all"/>
    <pipelet href="enfinity:/xcs/pipelets/CreateProductSet.xml"/>
<!--@BendPoints 17,8-->
    <nodeSuccessors name="next" next="UpdateProductSet1"/>
    <returnValueBindings name="ProductSet" objectPath="AllProductsProductSet"/>
  </nodes>
<!--@Location 8,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateProductSet1">
    <pipelet href="enfinity:/xcs/pipelets/UpdateProductSet.xml"/>
<!--@BendPoints 17,11-->
    <nodeSuccessors name="next" next="JoinNode17" action="commit"/>
    <parameterBindings name="Description" constant="All products"/>
    <parameterBindings name="IsActive" constant="true"/>
    <parameterBindings name="Name" objectPath="Domain:DomainName"/>
    <parameterBindings name="ProductSet" objectPath="AllProductsProductSet"/>
  </nodes>
<!--@Location 10,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode4" strict="true" name="DetermineChannelSharingType"
      callMode="Private">
<!--@BendPoints 21,2-->
    <nodeSuccessors name="next" next="GetDomainWideProductSets3"/>
<!--The domain of the current working repository.-->
    <parameters name="Domain" type="com.intershop.beehive.core.capi.domain.Domain"/>
<!--The channel which sharing type should be determined (0 = share nothing; 1 = share all; 2 = share by groups)-->
    <parameters name="Channel" type="com.intershop.component.mvc.capi.catalog.Repository"/>
  </nodes>
<!--@Location 10,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetDomainWideProductSets3">
    <configurationValues name="AllProducts" value="true"/>
    <configurationValues name="NoProducts" value="true"/>
    <pipelet href="enfinity:/xcs/pipelets/GetDomainWideProductSets.xml"/>
<!--@BendPoints 21,4-->
    <nodeSuccessors name="next" next="DecisionNode4"/>
  </nodes>
<!--@Location 10,2-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode4" conditionKey="NoProductsProductSet">
<!--@BendPoints 21,6-->
    <nodeSuccessors name="decision_yes" next="DecisionNode5"/>
<!--@BendPoints 23,5-->
    <nodeSuccessors name="decision_no" next="JoinNode3"/>
  </nodes>
<!--@Location 10,3-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode5" conditionKey="NoProductsProductSet:isInDomains(Channel:RepositoryDomain)"
      operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="VerifyInteger1"/>
    <nodeSuccessors name="decision_no" next="JoinNode3"/>
  </nodes>
<!--@Location 10,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="VerifyInteger1">
    <pipelet href="enfinity:/bc_foundation/pipelets/VerifyInteger.xml"/>
    <nodeSuccessors name="next" next="JoinNode6"/>
    <parameterBindings name="LocalizedString" constant="0"/>
    <returnValueBindings name="IntegerObject" objectPath="ChannelSharingType"/>
  </nodes>
<!--@Location 10,7-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode6">
<!--@BendPoints 21,16-->
    <nodeSuccessors name="next" next="EndNode5"/>
  </nodes>
<!--@Location 10,8-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode5" strict="true">
    <returnValues name="ChannelSharingType" type="java.lang.Integer"/>
  </nodes>
<!--@Location 11,3-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode3">
<!--@BendPoints 23,8-->
    <nodeSuccessors name="next" next="DecisionNode6"/>
  </nodes>
<!--@Location 11,4-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode6" conditionKey="AllProductsProductSet">
<!--@BendPoints 23,10-->
    <nodeSuccessors name="decision_yes" next="DecisionNode7"/>
<!--@BendPoints 25,9-->
    <nodeSuccessors name="decision_no" next="JoinNode5"/>
  </nodes>
<!--@Location 11,5-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode7" conditionKey="AllProductsProductSet:isInDomains(Channel:RepositoryDomain)"
      operator="str_eq" conditionValue="true">
    <nodeSuccessors name="decision_yes" next="VerifyInteger2"/>
    <nodeSuccessors name="decision_no" next="JoinNode5"/>
  </nodes>
<!--@Location 11,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="VerifyInteger2">
    <pipelet href="enfinity:/bc_foundation/pipelets/VerifyInteger.xml"/>
    <nodeSuccessors name="next" next="JoinNode4"/>
    <parameterBindings name="LocalizedString" constant="1"/>
    <returnValueBindings name="IntegerObject" objectPath="ChannelSharingType"/>
  </nodes>
<!--@Location 11,7-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode4">
    <nodeSuccessors name="next" next="JoinNode6"/>
  </nodes>
<!--@Location 12,5-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode5">
<!--@BendPoints 25,12-->
    <nodeSuccessors name="next" next="VerifyInteger3"/>
  </nodes>
<!--@Location 12,6-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="VerifyInteger3">
    <pipelet href="enfinity:/bc_foundation/pipelets/VerifyInteger.xml"/>
<!--@BendPoints 25,15-->
    <nodeSuccessors name="next" next="JoinNode4"/>
    <parameterBindings name="LocalizedString" constant="2"/>
    <returnValueBindings name="IntegerObject" objectPath="ChannelSharingType"/>
  </nodes>
<!--@Location 4,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode10" strict="true" name="DetermineDependentOrganizations"
      callMode="Private">
    <nodeSuccessors name="next" next="AddObjectToVector2"/>
    <parameters name="MasterRepository" type="com.intershop.component.mvc.capi.catalog.Repository"
        optional="true"/>
    <parameters name="Organizations" type="java.util.Vector" optional="true"/>
  </nodes>
<!--@Location 4,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector2">
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
    <nodeSuccessors name="next" next="GetOrganizationByDomain1"/>
    <parameterBindings name="InVector" objectPath="Organizations"/>
    <parameterBindings name="Object" nullBinding="true"/>
    <parameterBindings name="Objects" nullBinding="true"/>
    <returnValueBindings name="OutVector" objectPath="Organizations"/>
  </nodes>
<!--@Location 4,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetOrganizationByDomain1">
    <pipelet href="enfinity:/bc_organization/pipelets/GetOrganizationByDomain.xml"/>
    <nodeSuccessors name="next" next="AddObjectToVector1"/>
<!--@BendPoints 13,5-->
    <nodeSuccessors name="pipelet_error" next="JoinNode9"/>
    <parameterBindings name="OrganizationDomain" objectPath="MasterRepository:OwningDomain"/>
  </nodes>
<!--@Location 4,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector1">
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
<!--@BendPoints 9,8-->
    <nodeSuccessors name="next" next="GetRepositories1"/>
    <parameterBindings name="InVector" objectPath="Organizations"/>
    <parameterBindings name="Object" objectPath="Organization"/>
    <parameterBindings name="Objects" nullBinding="true"/>
    <returnValueBindings name="OutVector" objectPath="Organizations"/>
  </nodes>
<!--@Location 4,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetRepositories1">
    <configurationValues name="CustomRepositoryTypeCode" value="32"/>
    <pipelet href="enfinity:/bc_mvc/pipelets/GetRepositories.xml"/>
    <nodeSuccessors name="next" next="JoinNode1"/>
    <parameterBindings name="OrganizationDomain" objectPath="MasterRepository:OwningDomain"/>
  </nodes>
<!--@Location 4,5-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode1">
<!--@BendPoints 9,12-->
    <nodeSuccessors name="next" next="LoopNode1"/>
  </nodes>
<!--@Location 4,6-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode1" loop="Repositories">
    <nodeSuccessors name="next" next="JoinNode9"/>
    <entry key="Repository">
      <nodeSuccessors name="loop_entry_next" next="GetOrganizations1"/>
    </entry>
  </nodes>
<!--@Location 4,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetOrganizations1">
    <configurationValues name="DefaultOrganizationType" value="30"/>
    <pipelet href="enfinity:/bc_organization/pipelets/GetOrganizations.xml"/>
<!--@BendPoints 9,16-->
    <nodeSuccessors name="next" next="LoopNode2"/>
    <parameterBindings name="Owner" objectPath="Repository:RepositoryDomain"/>
    <returnValueBindings name="Organizations" objectPath="PartnerOrganizations"/>
  </nodes>
<!--@Location 4,8-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode2" loop="PartnerOrganizations">
<!--@BendPoints 11,17 11,24 7,24 7,13-->
    <nodeSuccessors name="next" next="LoopNode1_Entry"/>
    <entry key="PartnerOrganization">
<!--@BendPoints 9,18-->
      <nodeSuccessors name="loop_entry_next" next="GetRepository1"/>
    </entry>
  </nodes>
<!--@Location 4,9-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetRepository1">
    <configurationValues name="CustomRepositoryTypeCode" value="21"/>
    <configurationValues name="Type" value="Custom Repository"/>
    <pipelet href="enfinity:/bc_mvc/pipelets/GetRepository.xml"/>
<!--@BendPoints 9,20-->
    <nodeSuccessors name="next" next="CallNode6"/>
<!--@BendPoints 10,19 10,23-->
    <nodeSuccessors name="pipelet_error" next="JoinNode10"/>
    <parameterBindings name="OrganizationDomain" objectPath="PartnerOrganization:OrganizationDomain"/>
    <returnValueBindings name="Repository" objectPath="PartnerMasterRepository"/>
  </nodes>
<!--@Location 4,10-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode6">
    <nodeSuccessors name="next" next="JoinNode10"/>
    <parameterBindings name="MasterRepository" objectPath="PartnerMasterRepository"/>
    <startNode referencedName="ProcessProductSharing-DetermineDependentOrganizations"/>
  </nodes>
<!--@Location 4,11-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode10">
<!--@BendPoints 8,23 8,17-->
    <nodeSuccessors name="next" next="LoopNode2_Entry"/>
  </nodes>
<!--@Location 6,6-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode9">
<!--@BendPoints 13,22-->
    <nodeSuccessors name="next" next="EndNode2"/>
  </nodes>
<!--@Location 6,11-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode2" strict="true">
    <returnValues name="Organizations" type="java.util.Vector"/>
  </nodes>
<!--@Location 3,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode1" strict="true" name="DetermineDependentOrganizationsFromPartnerChannel"
      callMode="Private">
    <nodeSuccessors name="next" next="AddObjectToVector4"/>
    <parameters name="PartnerChannel" type="com.intershop.component.mvc.capi.catalog.Repository"
        optional="true"/>
  </nodes>
<!--@Location 3,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector4">
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
    <nodeSuccessors name="next" next="AddObjectToVector3"/>
    <parameterBindings name="InVector" nullBinding="true"/>
    <parameterBindings name="Object" nullBinding="true"/>
    <parameterBindings name="Objects" nullBinding="true"/>
    <returnValueBindings name="OutVector" objectPath="Organizations"/>
  </nodes>
<!--@Location 3,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector3">
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
<!--@BendPoints 7,11-->
    <nodeSuccessors name="next" next="JoinNode1"/>
    <parameterBindings name="InVector" nullBinding="true"/>
    <parameterBindings name="Object" objectPath="PartnerChannel"/>
    <parameterBindings name="Objects" nullBinding="true"/>
    <returnValueBindings name="OutVector" objectPath="Repositories"/>
  </nodes>
<!--@Location 7,7-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode3" strict="true" name="DetermineNoProductsProductSet"
      callMode="Private">
<!--@BendPoints 15,16-->
    <nodeSuccessors name="next" next="GetDomainWideProductSets2"/>
<!--The domain.-->
    <parameters name="Domain" type="com.intershop.beehive.core.capi.domain.Domain"/>
  </nodes>
<!--@Location 7,8-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetDomainWideProductSets2">
    <configurationValues name="NoProducts" value="true"/>
    <pipelet href="enfinity:/xcs/pipelets/GetDomainWideProductSets.xml"/>
    <nodeSuccessors name="next" next="DecisionNode3"/>
  </nodes>
<!--@Location 7,9-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode3" conditionKey="NoProductsProductSet">
    <nodeSuccessors name="decision_yes" next="JoinNode2"/>
<!--@BendPoints 17,19 17,20-->
    <nodeSuccessors name="decision_no" next="CreateProductSet2" action="begin"/>
  </nodes>
<!--@Location 7,12-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode2">
<!--@BendPoints 15,26-->
    <nodeSuccessors name="next" next="EndNode4"/>
  </nodes>
<!--@Location 7,13-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode4" strict="true">
<!--The product set for "no products".-->
    <returnValues name="NoProductsProductSet" type="com.intershop.beehive.xcs.capi.productset.ProductSet"/>
  </nodes>
<!--@Location 8,10-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreateProductSet2">
    <configurationValues name="ProductSetType" value="nothing"/>
    <pipelet href="enfinity:/xcs/pipelets/CreateProductSet.xml"/>
<!--@BendPoints 17,22-->
    <nodeSuccessors name="next" next="UpdateProductSet2"/>
    <returnValueBindings name="ProductSet" objectPath="NoProductsProductSet"/>
  </nodes>
<!--@Location 8,11-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateProductSet2">
    <pipelet href="enfinity:/xcs/pipelets/UpdateProductSet.xml"/>
<!--@BendPoints 17,25-->
    <nodeSuccessors name="next" next="JoinNode2" action="commit"/>
    <parameterBindings name="Description" constant="No products"/>
    <parameterBindings name="Name" objectPath="Domain:DomainName"/>
    <parameterBindings name="ProductSet" objectPath="NoProductsProductSet"/>
  </nodes>
<!--@Location 11,10-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode7" strict="true" name="RemoveAllPEPAs"
      callMode="Private">
<!--@BendPoints 23,22-->
    <nodeSuccessors name="next" next="GetAssignedProductSets1"/>
    <parameters name="TargetRepository" type="com.intershop.component.mvc.capi.catalog.Repository"/>
    <parameters name="SourceRepository" type="com.intershop.component.mvc.capi.catalog.Repository"/>
  </nodes>
<!--@Location 11,11-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetAssignedProductSets1">
    <pipelet href="enfinity:/xcs/pipelets/GetAssignedProductSets.xml"/>
<!--@BendPoints 23,24-->
    <nodeSuccessors name="next" next="LoopNode6"/>
    <parameterBindings name="Domain" objectPath="TargetRepository:RepositoryDomain"/>
  </nodes>
<!--@Location 11,12-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode6" loop="ProductSets">
<!--@BendPoints 24,25-->
    <nodeSuccessors name="next" next="EndNode8"/>
    <entry key="ProductSet">
      <nodeSuccessors name="loop_entry_next" next="DecisionNode9"/>
    </entry>
  </nodes>
<!--@Location 11,13-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode9" conditionKey="ProductSet:DomainID"
      operator="str_eq" conditionItem="SourceRepository:RepositoryDomain:DomainID">
    <nodeSuccessors name="decision_yes" next="LoopNode7"/>
<!--@BendPoints 27,27 27,39-->
    <nodeSuccessors name="decision_no" next="JoinNode8"/>
  </nodes>
<!--@Location 11,14-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode7" loop="ProductSet:Products">
<!--@BendPoints 23,30 25,30-->
    <nodeSuccessors name="next" next="JoinNode8"/>
    <entry key="Product">
      <nodeSuccessors name="loop_entry_next" next="GetProductBySKU1"/>
    </entry>
  </nodes>
<!--@Location 11,15-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetProductBySKU1">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetProductBySKU.xml"/>
    <nodeSuccessors name="next" next="CallNode27"/>
<!--@BendPoints 24,31 24,37-->
    <nodeSuccessors name="pipelet_error" next="JoinNode15"/>
    <parameterBindings name="Domain" objectPath="TargetRepository:RepositoryDomain"/>
    <parameterBindings name="SKU" objectPath="Product:SKU"/>
    <returnValueBindings name="Product" objectPath="Product2"/>
  </nodes>
<!--@Location 11,16-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode27">
    <nodeSuccessors name="next" next="CallNode22"/>
    <parameterBindings name="Product" objectPath="Product2"/>
    <startNode referencedName="ProcessProductDeletion-ProcessProductAlert"/>
  </nodes>
<!--@Location 11,17-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode22">
    <nodeSuccessors name="next" next="JoinNode15"/>
    <parameterBindings name="ContextObject" objectPath="Product"/>
    <parameterBindings name="Domain" objectPath="TargetRepository:RepositoryDomain"/>
    <parameterBindings name="Site" objectPath="CurrentDomain"/>
    <startNode referencedName="ProcessPageletEntryPoint-DeletePageletEntryPointsByObject"/>
  </nodes>
<!--@Location 11,18-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode15">
<!--@BendPoints 22,37 22,29-->
    <nodeSuccessors name="next" next="LoopNode7_Entry"/>
  </nodes>
<!--@Location 12,19-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode8">
<!--@BendPoints 21,39 21,25-->
    <nodeSuccessors name="next" next="LoopNode6_Entry"/>
  </nodes>
<!--@Location 12,12-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode8" strict="true"/>
<!--@Location 27,9-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode15" strict="true" name="RemovePCA"
      callMode="Private">
    <nodeSuccessors name="next" next="DecisionNode13"/>
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
    <parameters name="TargetDomains" type="java.util.Collection"/>
  </nodes>
<!--@Location 27,10-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode13" conditionKey="TargetDomains"
      operator="has_elements">
    <nodeSuccessors name="decision_yes" next="LoopNode18"/>
<!--@BendPoints 53,21-->
    <nodeSuccessors name="decision_no" next="JoinNode21"/>
  </nodes>
<!--@Location 27,11-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode18" loop="TargetDomains">
    <nodeSuccessors name="next" next="JoinNode21"/>
    <entry key="TargetDomain">
      <nodeSuccessors name="loop_entry_next" next="GetProductBySKU0"/>
    </entry>
  </nodes>
<!--@Location 27,12-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetProductBySKU0">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetProductBySKU.xml"/>
    <nodeSuccessors name="next" next="UpdateDictionary0"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode22"/>
    <parameterBindings name="Domain" objectPath="TargetDomain"/>
    <parameterBindings name="SKU" objectPath="Product:SKU"/>
    <returnValueBindings name="Product" objectPath="Product2"/>
  </nodes>
<!--@Location 27,13-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UpdateDictionary0">
    <configurationValues name="Name_01" value="Product"/>
    <pipelet href="enfinity:/core/pipelets/UpdateDictionary.xml"/>
    <nodeSuccessors name="next" next="ExecuteObjectsQuery6"/>
    <parameterBindings name="Value_01" objectPath="Product2"/>
    <returnValueBindings name="OutDictionary" objectPath="PCAQueryParameters"/>
  </nodes>
<!--@Location 27,14-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ExecuteObjectsQuery6">
    <configurationValues name="QueryName" value="catalog/GetLocalProductCategoryAssignmentsOfSharedProduct"/>
    <pipelet href="enfinity:/core/pipelets/ExecuteObjectsQuery.xml"/>
    <nodeSuccessors name="next" next="LoopNode17"/>
    <parameterBindings name="Parameters" objectPath="PCAQueryParameters"/>
    <returnValueBindings name="SearchResult" objectPath="PCAs"/>
  </nodes>
<!--@Location 27,15-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode17" loop="PCAs">
<!--@BendPoints 57,31-->
    <nodeSuccessors name="next" next="JoinNode22"/>
    <entry key="PCA">
      <nodeSuccessors name="loop_entry_next" next="DecisionNode12"/>
    </entry>
  </nodes>
<!--@Location 27,16-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode12" conditionKey="PCA:DomainID"
      operator="str_eq" conditionItem="TargetDomain:DomainID">
    <nodeSuccessors name="decision_yes" next="GetCategoryByUUID0"/>
<!--@BendPoints 57,33 57,39-->
    <nodeSuccessors name="decision_no" next="JoinNode18"/>
  </nodes>
<!--@Location 27,17-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetCategoryByUUID0">
    <pipelet href="enfinity:/bc_mvc/pipelets/GetCategoryByUUID.xml"/>
    <nodeSuccessors name="next" next="RemoveProductCategoryBinding0"/>
    <parameterBindings name="CatalogCategoryID" objectPath="PCA:CatalogCategoryID"/>
  </nodes>
<!--@Location 27,18-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemoveProductCategoryBinding0">
    <pipelet href="enfinity:/bc_mvc/pipelets/RemoveProductCategoryBinding.xml"/>
    <nodeSuccessors name="next" next="JoinNode18"/>
    <parameterBindings name="CatalogCategory" objectPath="Category"/>
    <parameterBindings name="Product" objectPath="Product2"/>
  </nodes>
<!--@Location 27,19-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode18">
<!--@BendPoints 54,39 54,31-->
    <nodeSuccessors name="next" next="LoopNode17_Entry"/>
  </nodes>
<!--@Location 28,12-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode22">
<!--@BendPoints 57,23-->
    <nodeSuccessors name="next" next="LoopNode18_Entry"/>
  </nodes>
<!--@Location 26,11-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode21">
    <nodeSuccessors name="next" next="EndNode14"/>
  </nodes>
<!--@Location 25,11-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode14" strict="true"/>
<!--@Location 14,5-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode0" strict="true" name="RemoveSharedVariationAssignments"
      callMode="Private">
    <nodeSuccessors name="next" next="DecisionNode0"/>
    <parameters name="VariationProduct" type="com.intershop.beehive.xcs.capi.product.Product"/>
    <parameters name="TargetDomains" type="java.util.Collection"/>
  </nodes>
<!--@Location 14,6-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode0" conditionKey="TargetDomains"
      operator="has_elements">
    <nodeSuccessors name="decision_yes" next="ExecuteObjectsQuery0"/>
<!--@BendPoints 31,13-->
    <nodeSuccessors name="decision_no" next="JoinNode0"/>
  </nodes>
<!--@Location 14,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ExecuteObjectsQuery0">
    <configurationValues name="ParameterName_01" value="Product"/>
    <configurationValues name="ParameterName_02" value="TargetDomains"/>
    <configurationValues name="QueryName" value="product/GetMasterProductsOfVariationInSharedDomains"/>
    <pipelet href="enfinity:/core/pipelets/ExecuteObjectsQuery.xml"/>
    <nodeSuccessors name="next" next="DecisionNode10"/>
    <parameterBindings name="ParameterValue_01" objectPath="VariationProduct"/>
    <parameterBindings name="ParameterValue_02" objectPath="TargetDomains"/>
    <returnValueBindings name="SearchResult" objectPath="MasterProducts"/>
  </nodes>
<!--@Location 14,8-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode10" conditionKey="MasterProducts"
      operator="has_elements">
    <nodeSuccessors name="decision_yes" next="KeyMapper0"/>
<!--@BendPoints 30,17-->
    <nodeSuccessors name="decision_no" next="JoinNode0"/>
  </nodes>
<!--@Location 14,9-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="KeyMapper0">
    <pipelet href="enfinity:/bc_foundation/pipelets/KeyMapper.xml"/>
    <nodeSuccessors name="next" next="AddObjectToVector0"/>
    <parameterBindings name="InValue_1" objectPath="VariationProduct:Domain"/>
    <returnValueBindings name="OutValue_1" objectPath="ProductDomain"/>
  </nodes>
<!--@Location 14,10-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector0">
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
    <nodeSuccessors name="next" next="LoopNode0"/>
    <parameterBindings name="InVector" nullBinding="true"/>
    <parameterBindings name="Object" objectPath="VariationProduct:UUID"/>
    <parameterBindings name="Objects" nullBinding="true"/>
    <returnValueBindings name="Iterator" objectPath="ProductUUIDs"/>
    <returnValueBindings name="OutVector" nullBinding="true"/>
  </nodes>
<!--@Location 14,11-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode0" loop="MasterProducts">
    <nodeSuccessors name="next" next="JoinNode0"/>
    <entry key="Product">
      <nodeSuccessors name="loop_entry_next" next="CallNode3"/>
    </entry>
  </nodes>
<!--@Location 14,12-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode3">
<!--@BendPoints 28,25 28,23-->
    <nodeSuccessors name="next" next="LoopNode0_Entry"/>
    <startNode referencedName="ProcessProductVariations-Delete"/>
  </nodes>
<!--@Location 15,11-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode0">
    <nodeSuccessors name="next" next="EndNode0"/>
  </nodes>
<!--@Location 15,12-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode0"/>
<!--Handles cleanup / reorganization issues that need to occur when one or more products have been un\-shared from one or more domains (e.g. by removing products from sharing groups, unassigning channels from sharing groups etc.)
@Location 17,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode6" strict="true" name="TriggerUnshareConsequences"
      callMode="Private">
    <nodeSuccessors name="next" next="AddObjectToVector5"/>
    <parameters name="SingleProduct" type="com.intershop.beehive.xcs.capi.product.Product"
        optional="true"/>
    <parameters name="MultipleProducts" type="java.util.Collection" optional="true"/>
    <parameters name="FromSingleDomain" type="com.intershop.beehive.core.capi.domain.Domain"
        optional="true"/>
    <parameters name="FromMultipleDomains" type="java.util.Collection" optional="true"/>
    <parameters name="SourceDomain" type="com.intershop.beehive.core.capi.domain.Domain"/>
    <parameters name="TargetDomains" type="java.util.Collection"/>
    <parameters name="PageletModelRepository" type="com.intershop.component.pmc.capi.model.PageletModelRepository"/>
  </nodes>
<!--@Location 17,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector5">
    <configurationValues name="Mode" value="Forbid Duplicates"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
    <nodeSuccessors name="next" next="AddObjectToVector14"/>
    <parameterBindings name="Object" objectPath="SingleProduct"/>
    <parameterBindings name="Objects" objectPath="MultipleProducts"/>
    <returnValueBindings name="Iterator" objectPath="CombinedProductsIterator"/>
  </nodes>
<!--@Location 17,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector14">
    <configurationValues name="Mode" value="Forbid Duplicates"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
    <nodeSuccessors name="next" next="AddObjectToVector6"/>
    <parameterBindings name="Object" objectPath="SingleProduct"/>
    <parameterBindings name="Objects" objectPath="MultipleProducts"/>
    <returnValueBindings name="OutVector" objectPath="CombinedProductsVector"/>
  </nodes>
<!--@Location 17,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToVector6">
    <configurationValues name="Mode" value="Forbid Duplicates"/>
    <pipelet href="enfinity:/bc_foundation/pipelets/AddObjectToVector.xml"/>
    <nodeSuccessors name="next" next="CreatePageableFromIterator0"/>
    <parameterBindings name="Object" objectPath="FromSingleDomain"/>
    <parameterBindings name="Objects" objectPath="FromMultipleDomains"/>
    <returnValueBindings name="Iterator" objectPath="FromDomainsIterator"/>
  </nodes>
<!--@Location 17,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreatePageableFromIterator0">
    <pipelet href="enfinity:/bc_foundation/pipelets/CreatePageableFromIterator.xml"/>
    <nodeSuccessors name="next" next="LoopNode3"/>
    <parameterBindings name="Iterator" objectPath="CombinedProductsIterator"/>
    <parameterBindings name="PageSize" objectPath=""/>
    <returnValueBindings name="Pageable" objectPath="CombinedProductsPageableIterator"/>
  </nodes>
<!--@Location 17,5-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode3" loop="CombinedProductsVector:Iterator">
<!--@BendPoints 33,11 33,15-->
    <nodeSuccessors name="next" next="ExecutePipeline1"/>
    <entry key="Product">
<!--@BendPoints 37,11 37,13-->
      <nodeSuccessors name="loop_entry_next" next="CallNode4"/>
    </entry>
  </nodes>
<!--@Location 17,6-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode4">
    <nodeSuccessors name="next" next="LoopNode3_Entry"/>
    <parameterBindings name="VariationProduct" objectPath="Product"/>
    <startNode referencedName="This:RemoveSharedVariationAssignments"/>
  </nodes>
<!--@Location 17,7-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ExecutePipeline1">
    <configurationValues name="NumberOfThreads" value="8"/>
    <configurationValues name="PipelineName" value="ProcessProductSharing"/>
    <configurationValues name="PipelineStartNode" value="UnshareProduct"/>
    <configurationValues name="TargetPipelineIteratorName" value="ProductsIterator"/>
    <pipelet href="enfinity:/xcs/pipelets/ExecutePipeline.xml"/>
    <nodeSuccessors name="next" next="JoinNode35"/>
    <nodeSuccessors name="pipelet_error" next="JoinNode35"/>
    <parameterBindings name="NumberOfThreads" nullBinding="true"/>
    <parameterBindings name="PageableIterator" objectPath="CombinedProductsPageableIterator"/>
    <parameterBindings name="PipelineName" nullBinding="true"/>
    <parameterBindings name="PipelineStartNode" nullBinding="true"/>
    <parameterBindings name="TargetPipelineIteratorName" nullBinding="true"/>
  </nodes>
<!--@Location 17,8-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode35">
    <nodeSuccessors name="next" next="EndNode7"/>
  </nodes>
<!--@Location 17,9-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode7" name="End" strict="true"/>
<!--@Location 14,13-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode9" strict="true" name="UnassignProductFromPromotions"
      callMode="Private">
    <nodeSuccessors name="next" next="DecisionNode11"/>
    <parameters name="TargetDomains" type="java.util.Collection"/>
    <parameters name="Product" type="com.intershop.beehive.xcs.capi.product.Product"/>
  </nodes>
<!--@Location 14,14-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode11" conditionKey="TargetDomains"
      operator="has_elements">
    <nodeSuccessors name="decision_yes" next="LoopNode13"/>
<!--@BendPoints 31,29-->
    <nodeSuccessors name="decision_no" next="JoinNode20"/>
  </nodes>
<!--@Location 14,15-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode13" loop="TargetDomains">
    <nodeSuccessors name="next" next="JoinNode20"/>
    <entry key="ProductDomain">
      <nodeSuccessors name="loop_entry_next" next="UnassignProductFromPromotions0"/>
    </entry>
  </nodes>
<!--@Location 14,16-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UnassignProductFromPromotions0">
    <pipelet href="enfinity:/bc_marketing/pipelets/UnassignProductFromPromotions.xml"/>
<!--@BendPoints 28,33 28,31-->
    <nodeSuccessors name="next" next="LoopNode13_Entry"/>
    <parameterBindings name="ProductID" objectPath="Product:UUID"/>
  </nodes>
<!--@Location 15,15-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode20">
    <nodeSuccessors name="next" next="EndNode10"/>
  </nodes>
<!--@Location 15,16-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode10" strict="true"/>
<!--@Location 30,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode14" strict="true" name="UnshareDomain"
      callMode="Private">
    <nodeSuccessors name="next" next="ExecutePageableQuery0"/>
    <parameters name="TargetDomain" type="com.intershop.beehive.core.capi.domain.Domain"/>
    <parameters name="SourceDomain" type="com.intershop.beehive.core.capi.domain.Domain"/>
  </nodes>
<!--@Location 30,1-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="ExecutePageableQuery0">
    <configurationValues name="Datasource" value="default"/>
    <configurationValues name="DefaultPageSize" value="100"/>
    <configurationValues name="ParameterName_01" value="Domain"/>
    <configurationValues name="QueryName" value="product/GetAllLocalProducts"/>
    <pipelet href="enfinity:/core/pipelets/ExecutePageableQuery.xml"/>
    <nodeSuccessors name="next" next="CreatePageableSequence0"/>
    <parameterBindings name="ParameterValue_01" objectPath="SourceDomain"/>
    <returnValueBindings name="SearchResult" objectPath="Products"/>
  </nodes>
<!--@Location 30,2-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="CreatePageableSequence0">
    <pipelet href="enfinity:/bc_foundation/pipelets/CreatePageableSequence.xml"/>
    <nodeSuccessors name="next" next="AddObjectToCollection0"/>
    <parameterBindings name="PageableIterator" objectPath="Products"/>
    <returnValueBindings name="PageableSequence" objectPath="Products"/>
  </nodes>
<!--@Location 30,3-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="AddObjectToCollection0">
    <pipelet href="enfinity:/core/pipelets/AddObjectToCollection.xml"/>
    <nodeSuccessors name="next" next="LoopNode14"/>
    <parameterBindings name="InCollection" nullBinding="true"/>
    <parameterBindings name="InObject" objectPath="TargetDomain"/>
    <returnValueBindings name="OutCollection" objectPath="Domains"/>
    <returnValueBindings name="OutIterator" nullBinding="true"/>
  </nodes>
<!--@Location 30,4-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode14" loop="Products">
    <nodeSuccessors name="next" next="SwitchToNextPage0"/>
    <entry key="Product">
      <nodeSuccessors name="loop_entry_next" next="CallNode11"/>
    </entry>
  </nodes>
<!--@Location 30,5-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode11">
<!--@BendPoints 59,11 59,9-->
    <nodeSuccessors name="next" next="LoopNode14_Entry"/>
    <startNode referencedName="ProcessProductDeletion-CleanUpProductAssignments"/>
  </nodes>
<!--@Location 31,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="SwitchToNextPage0">
    <pipelet href="enfinity:/bc_foundation/pipelets/SwitchToNextPage.xml"/>
<!--@BendPoints 63,10 62,10-->
    <nodeSuccessors name="next" next="LoopNode14"/>
    <nodeSuccessors name="pipelet_error" next="RemoveAllProductSetDomainAssignments0"/>
    <parameterBindings name="PageableIterator" objectPath="Products"/>
  </nodes>
<!--@Location 33,4-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="RemoveAllProductSetDomainAssignments0">
    <pipelet href="enfinity:/xcs/pipelets/RemoveAllProductSetDomainAssignments.xml"/>
    <nodeSuccessors name="next" next="EndNode13"/>
    <parameterBindings name="AssignedDomain" objectPath="TargetDomain"/>
    <parameterBindings name="ProductSetsDefiningDomain" objectPath="SourceDomain"/>
  </nodes>
<!--@Location 33,5-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode13" strict="true"/>
<!--Unshares products and products related data.
@Location 19,0-->
  <nodes xsi:type="pipeline:StartNode" nodeID="StartNode23" strict="true" name="UnshareProduct"
      callMode="Private">
    <nodeSuccessors name="next" next="CallNode34"/>
    <parameters name="SourceDomain" type="com.intershop.beehive.core.capi.domain.Domain"/>
    <parameters name="TargetDomains" type="java.util.Collection"/>
    <parameters name="PageletModelRepository" type="com.intershop.component.pmc.capi.model.PageletModelRepository"/>
    <parameters name="ProductsIterator" type="java.util.Iterator"/>
    <parameters name="FromDomainsIterator" type="java.util.Iterator"/>
  </nodes>
<!--@Location 19,1-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode34">
    <nodeSuccessors name="next" next="LoopNode27"/>
    <parameterBindings name="SourceDomain" objectPath="SourceDomain"/>
    <parameterBindings name="TargetDomains" objectPath="FromDomainsIterator"/>
    <parameterBindings name="UnsharedProducts" objectPath="ProductsIterator"/>
    <startNode referencedName="ProcessProductConfigurationParameters-ProcessUnshare"/>
  </nodes>
<!--@Location 19,2-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode27" loop="ProductsIterator">
    <nodeSuccessors name="next" next="EndNode22"/>
    <entry key="Product">
      <nodeSuccessors name="loop_entry_next" next="CallNode5"/>
    </entry>
  </nodes>
<!--@Location 19,3-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode5">
    <nodeSuccessors name="next" next="CallNode0"/>
    <startNode referencedName="ProcessProductSharing-UnassignProductFromPromotions"/>
  </nodes>
<!--@Location 19,4-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode0">
    <nodeSuccessors name="next" next="GetLabelsByObject1"/>
    <startNode referencedName="This:RemovePCA"/>
  </nodes>
<!--@Location 19,5-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="GetLabelsByObject1">
    <pipelet href="enfinity:/bc_foundation/pipelets/GetLabelsByObject.xml"/>
    <nodeSuccessors name="next" next="LoopNode4"/>
    <parameterBindings name="Object" objectPath="Product"/>
  </nodes>
<!--@Location 19,6-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode4" loop="FromDomainsIterator">
<!--@BendPoints 38,15 38,5-->
    <nodeSuccessors name="next" next="LoopNode27_Entry"/>
    <entry key="FromDomain">
      <nodeSuccessors name="loop_entry_next" next="CallNode2"/>
    </entry>
  </nodes>
<!--@Location 19,7-->
  <nodes xsi:type="pipeline:CallNode" nodeID="CallNode2">
    <nodeSuccessors name="next" next="LoopNode5"/>
    <parameterBindings name="ContextObject" objectPath="Product"/>
    <parameterBindings name="Domain" objectPath="FromDomain"/>
    <parameterBindings name="Site" objectPath="CurrentDomain"/>
    <startNode referencedName="ProcessPageletEntryPoint-DeletePageletEntryPointsByObject"/>
  </nodes>
<!--@Location 19,8-->
  <nodes xsi:type="pipeline:LoopNode" nodeID="LoopNode5" loop="Labels">
<!--@BendPoints 41,17 41,13-->
    <nodeSuccessors name="next" next="LoopNode4_Entry"/>
    <entry key="Label">
<!--@BendPoints 39,20-->
      <nodeSuccessors name="loop_entry_next" next="DecisionNode8"/>
    </entry>
  </nodes>
<!--@Location 19,9-->
  <nodes xsi:type="pipeline:DecisionNode" nodeID="DecisionNode8" conditionKey="Label:Domain:UUID"
      operator="str_eq" conditionItem="FromDomain:UUID">
<!--@BendPoints 39,20-->
    <nodeSuccessors name="decision_yes" next="UnassignLabel1"/>
<!--@BendPoints 40,19 40,23-->
    <nodeSuccessors name="decision_no" next="JoinNode7"/>
  </nodes>
<!--@Location 19,10-->
  <nodes xsi:type="pipeline:PipeletNode" nodeID="UnassignLabel1">
    <pipelet href="enfinity:/bc_foundation/pipelets/UnassignLabel.xml"/>
    <nodeSuccessors name="next" next="JoinNode7"/>
    <parameterBindings name="Object" objectPath="Product"/>
  </nodes>
<!--@Location 19,11-->
  <nodes xsi:type="pipeline:JoinNode" nodeID="JoinNode7">
<!--@BendPoints 38,23 38,17-->
    <nodeSuccessors name="next" next="LoopNode5_Entry"/>
  </nodes>
<!--@Location 20,2-->
  <nodes xsi:type="pipeline:EndNode" nodeID="EndNode22" name="End" strict="true"/>
</pipeline:Pipeline>
