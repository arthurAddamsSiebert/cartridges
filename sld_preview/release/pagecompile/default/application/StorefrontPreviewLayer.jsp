<%@  page buffer="none" import="java.util.*,java.io.*,com.intershop.beehive.core.internal.template.*,com.intershop.beehive.core.internal.template.isml.*,com.intershop.beehive.core.capi.log.*,com.intershop.beehive.core.capi.resource.*,com.intershop.beehive.core.capi.util.UUIDMgr,com.intershop.beehive.core.capi.util.XMLHelper,com.intershop.beehive.foundation.util.*,com.intershop.beehive.core.internal.url.*,com.intershop.beehive.core.internal.resource.*,com.intershop.beehive.core.internal.wsrp.*,com.intershop.beehive.core.capi.pipeline.PipelineDictionary,com.intershop.beehive.core.capi.naming.NamingMgr,com.intershop.beehive.core.capi.pagecache.PageCacheMgr,com.intershop.beehive.core.capi.request.SessionMgr,com.intershop.beehive.core.internal.request.SessionMgrImpl,com.intershop.beehive.core.pipelet.PipelineConstants" extends="com.intershop.beehive.core.internal.template.AbstractTemplate" %><% 
boolean _boolean_result=false;
TemplateExecutionConfig context = getTemplateExecutionConfig();
createTemplatePageConfig(context.getServletRequest());
printHeader(out);
 %>
<% %><%@ page contentType="text/html;charset=utf-8" %><%setEncodingType("text/html"); %><% {out.flush();processLocalIncludeByServer((com.intershop.beehive.core.capi.request.ServletResponse)response,"preview/Modules.isml", null, "4");} %><% {out.flush();processLocalIncludeByServer((com.intershop.beehive.core.capi.request.ServletResponse)response,"editing/Modules.isml", null, "5");} %><% _boolean_result=false;try {_boolean_result=((Boolean)(getObject("PreviewWebform:Submitted"))).booleanValue();} catch (Exception e) {Logger.debug(this,"Boolean expression in line {} could not be evaluated. False returned. Consider using the 'isDefined' ISML function.",6,e);}if (_boolean_result) { %><!DOCTYPE html><html>
<head><% insertIntershopSignature(request,(com.intershop.beehive.core.capi.request.ServletResponse)response); %><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title><% {out.write(localizeISText("StorefrontPreviewLayer.StorefrontPreviewUpdate.title","",null,null,null,null,null,null,null,null,null,null,null));} %></title><% {out.flush();processLocalIncludeByServer((com.intershop.beehive.core.capi.request.ServletResponse)response,"webcontrols/PlaceholderHead", null, "14");} %><% out.print(context.prepareWAPlacement("JSWebLibraries")); %>jquery.js<% out.print("</waplacement>"); %><% out.print(context.prepareWAPlacement("JSWebLibraries")); %>jquery-migrate-1.2.1.js<% out.print("</waplacement>"); %><% {out.flush();processLocalIncludeByServer((com.intershop.beehive.core.capi.request.ServletResponse)response,"webcontrols/Modules", null, "17");} %></head>
<body><% } %><% _boolean_result=false;try {_boolean_result=((Boolean)((disableErrorMessages().isDefined(getObject("PreviewWebform"))))).booleanValue();} catch (Exception e) {Logger.debug(this,"Boolean expression in line {} could not be evaluated. False returned. Consider using the 'isDefined' ISML function.",22,e);}if (_boolean_result) { %><div id="sfe-configure-layer"><% {out.flush();processLocalIncludeByServer((com.intershop.beehive.core.capi.request.ServletResponse)response,"webcontrols/PlaceholderControls", null, "26");} %><% _boolean_result=false;try {_boolean_result=((Boolean)(getObject("PreviewWebform:Invalid"))).booleanValue();} catch (Exception e) {Logger.debug(this,"Boolean expression in line {} could not be evaluated. False returned. Consider using the 'isDefined' ISML function.",29,e);}if (_boolean_result) { %><script type="text/javascript">var FormValid = false;</script><% while (loop("PreviewWebform:Parameters","WebformParameter",null)) { %><% _boolean_result=false;try {_boolean_result=((Boolean)(getObject("WebformParameter:Invalid"))).booleanValue();} catch (Exception e) {Logger.debug(this,"Boolean expression in line {} could not be evaluated. False returned. Consider using the 'isDefined' ISML function.",32,e);}if (_boolean_result) { %><table border="0" cellspacing="0" cellpadding="4" class="error_box">
<tr valign="top">
<td class="error_icon top">
<img src="<%=context.getFormattedValue(context.webRoot(),null)%>/images/error.gif" width="16" height="15" alt="" border="0"/>
</td>
<td class="error top"><% processOpenTag(response, pageContext, "previewpanelerror", new TagParameter[] {
new TagParameter("previewFormParameter",getObject("WebformParameter"))}, 39); %></td>
</tr>
</table><% } %><% } %><% } else {_boolean_result=false;try {_boolean_result=((Boolean)((disableErrorMessages().isDefined(getObject("PreviewWebform:PreviewLocale"))))).booleanValue();} catch (Exception e) {Logger.debug(this,"Boolean expression in line {} could not be evaluated. False returned. Consider using the 'isDefined' ISML function.",45,e);}if (_boolean_result) { %><script type="text/javascript">
var FormValid = true;
(function($){
KOR.SFE.localeSwitchSelector = "<% {String value = null;try{value=context.getFormattedValue(context.getFormattedValue("#",null) + context.getFormattedValue(getObject("PreviewWebform:PreviewLocale:Locale:QualifiedName"),null),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {49}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %>";
})(jQuery);
</script><% } else { %><script type="text/javascript">var FormValid = true;</script><% }} %><% URLPipelineAction action1 = new URLPipelineAction(context.getFormattedValue(url(true,(new URLPipelineAction(context.getFormattedValue("EditView-Update",null))),(new URLParameterSet().addURLParameter(context.getFormattedValue("TargetSiteUUID",null),context.getFormattedValue(getObject("TargetSite:UUID"),null))).addURLParameter(context.getFormattedValue("PreviewWebform_submit",null),context.getFormattedValue("true",null))),null));String site1 = null;String serverGroup1 = null;String actionValue1 = context.getFormattedValue(url(true,(new URLPipelineAction(context.getFormattedValue("EditView-Update",null))),(new URLParameterSet().addURLParameter(context.getFormattedValue("TargetSiteUUID",null),context.getFormattedValue(getObject("TargetSite:UUID"),null))).addURLParameter(context.getFormattedValue("PreviewWebform_submit",null),context.getFormattedValue("true",null))),null);if (site1 == null){  site1 = action1.getDomain();  if (site1 == null)  {      site1 = com.intershop.beehive.core.capi.request.Request.getCurrent().getRequestSite().getDomainName();  }}if (serverGroup1 == null){  serverGroup1 = action1.getServerGroup();  if (serverGroup1 == null)  {      serverGroup1 = com.intershop.beehive.core.capi.request.Request.getCurrent().getRequestSite().getServerGroup();  }}out.print("<form");out.print(" method=\"");out.print("post");out.print("\"");out.print(" action=\"");out.print(context.getFormattedValue(url(true,(new URLPipelineAction(context.getFormattedValue("EditView-Update",null))),(new URLParameterSet().addURLParameter(context.getFormattedValue("TargetSiteUUID",null),context.getFormattedValue(getObject("TargetSite:UUID"),null))).addURLParameter(context.getFormattedValue("PreviewWebform_submit",null),context.getFormattedValue("true",null))),null));out.print("\"");out.print(" data-form-default-check=\"");out.print("true");out.print("\"");out.print(" data-system-default-check=\"");out.print("true");out.print("\"");out.print(" class=\"");out.print("sfe-configuration-layer-form");out.print("\"");out.print(" id=\"");out.print(context.getFormattedValue(getObject("PreviewWebform:ID"),null));out.print("\"");out.print(">");out.print(context.prepareWACSRFTag(actionValue1, site1, serverGroup1,true)); %><% processOpenTag(response, pageContext, "gettransfertargeturl", new TagParameter[] {
new TagParameter("transferURL","transferUrl"),
new TagParameter("targetSite",getObject("TargetSite")),
new TagParameter("previewContext",getObject("PreviewContextBO")),
new TagParameter("targeturl",url(true,(new URLPipelineAction(context.getFormattedValue("ViewPreviewConfiguration-UpdateSession",null)))))}, 58); %><input type="hidden" id="sfe-configure-layer-configuration-url" value="<% {String value = null;try{value=context.getFormattedValue(getObject("transferUrl"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {59}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %>">
<input type="hidden" id="preview_readonly_if_future" name="preview_readonly_if_future" value="<% {String value = null;try{value=context.getFormattedValue(getObject("ReadonlyPreviewPrefVal"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {60}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %>" />
<input type="hidden" name="PreviewContextID" value="<% {String value = null;try{value=context.getFormattedValue(getObject("PreviewContextBO:ID"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {61}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %>"><% _boolean_result=false;try {_boolean_result=((Boolean)((disableErrorMessages().isDefined(getObject("Transferable"))))).booleanValue();} catch (Exception e) {Logger.debug(this,"Boolean expression in line {} could not be evaluated. False returned. Consider using the 'isDefined' ISML function.",62,e);}if (_boolean_result) { %><div id="sfe-transferable-layer"><% while (loop("Transferable:KeySet","key",null)) { %><input type="hidden" name="<% {String value = null;try{value=context.getFormattedValue(getObject("key"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {65}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %>" value="<% {String value = null;try{value=context.getFormattedValue(getObject("Transferable:get(key)"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {65}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %>" /> 
<% } %><% processOpenTag(response, pageContext, "addsfeparameters", new TagParameter[] {
new TagParameter("prefix","transferablePrefix")}, 67); %></div><% } %><div class="ui-dialog">
<div class="ui-dialog-content">
<!-- Preview-form-id:<% {String value = null;try{value=context.getFormattedValue(getObject("PreviewWebform:ID"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {73}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %> --><% while (loop("PreviewContextBO:PreviewConfigurationAttributeGroups","PreviewConfigurationAttributeGroup",null)) { %><% processOpenTag(response, pageContext, "previewformparametergroup", new TagParameter[] {
new TagParameter("Locale",getObject("Locale")),
new TagParameter("CurrentRequest",getObject("CurrentRequest")),
new TagParameter("EnablePastDateCheck",getObject("isPreviewDateCheckInPastEnabled")),
new TagParameter("previewContext",getObject("PreviewContextBO")),
new TagParameter("webform",getObject("PreviewWebform")),
new TagParameter("group",getObject("PreviewConfigurationAttributeGroup"))}, 75); %><% } %><div class="sfe-preview-form-parameter-group-simple sfe-preview-form-parameter-group-StatusDisplay">
<label for="PreviewSummaryVisible" class="fielditem2 fielditem2-radio" nowrap="nowrap"><% {out.write(localizeISText("StorefrontPreviewLayer.StatusDisplay.label","",null,null,null,null,null,null,null,null,null,null,null));} %>:</label>
<div class="sfe-checkbox-row">
<input name="<% {String value = null;try{value=context.getFormattedValue(getObject("PreviewWebform:PreviewSummaryVisible:QualifiedName"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {80}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %>" 
id="PreviewSummaryVisible"
type="checkbox"
class="last"
<% _boolean_result=false;try {_boolean_result=((Boolean)(((!((Boolean) ((disableErrorMessages().isDefined(getObject("CurrentSession:Object(\"PreviewSummaryVisible\")"))))).booleanValue() || ((Boolean) getObject("CurrentSession:Object(\"PreviewSummaryVisible\")")).booleanValue()) ? Boolean.TRUE : Boolean.FALSE))).booleanValue();} catch (Exception e) {Logger.debug(this,"Boolean expression in line {} could not be evaluated. False returned. Consider using the 'isDefined' ISML function.",84,e);}if (_boolean_result) { %> checked="checked" <% } %> 
value="true" 
/>
<label for="PreviewSummaryVisible" class="fielditem" colspan="4"><% {out.write(localizeISText("StorefrontPreviewLayer.ShowStatusDisplayDuringPreview.label","",null,null,null,null,null,null,null,null,null,null,null));} %></label>
</div>
</div>
</div>
<table width="100%" cellspacing="4" cellpadding="0" border="0" class="sfe-configure-layer-buttons">
<tr>
<td align="left">
<table border="0" cellspacing="4" cellpadding="0">
<tr>
<td class="button">
<input class="button" type="button" id="sfe-configure-layer-system-default-reset" <% _boolean_result=false;try {_boolean_result=((Boolean)(getObject("PreviewContextBO:isDefaultPreviewConfiguration"))).booleanValue();} catch (Exception e) {Logger.debug(this,"Boolean expression in line {} could not be evaluated. False returned. Consider using the 'isDefined' ISML function.",97,e);}if (_boolean_result) { %>disabled="disabled"<% } %> value="<%=context.getFormattedValue(localizeText(context.getFormattedValue("StorefrontPreviewLayer.ResetToDefault.button",null)),null)%>" title="<%=context.getFormattedValue(localizeText(context.getFormattedValue("StorefrontPreviewLayer.ResetsAllValuesToDefaultValuesAndUpdatesThePreview.button",null)),null)%>"/>
</td>
<td class="button">
<a href="<%=context.getFormattedValue(url(true,(new URLPipelineAction(context.getFormattedValue("EditView-EndPreview",null))),(new URLParameterSet().addURLParameter(context.getFormattedValue("TargetSiteUUID",null),context.getFormattedValue(getObject("TargetSite:UUID"),null))).addURLParameter(context.getFormattedValue("PreviewContextID",null),context.getFormattedValue(getObject("PreviewContextBO:ID"),null))),null)%>" class="button" id="sfe-configure-layer-cancel" name="Finish" title="<%=context.getFormattedValue(localizeText(context.getFormattedValue("StorefrontPreviewLayer.ResetAnExistingStorefrontSession.link",null)),null)%>"><% {out.write(localizeISText("StorefrontPreviewLayer.FinishPreview.link","",null,null,null,null,null,null,null,null,null,null,null));} %></a>
</td> 
<td class="button">
<a data-fullsite-preview="<%=context.getFormattedValue(url(true,(new URLPipelineAction(context.getFormattedValue("FullSitePreview-Start",null))),(new URLParameterSet().addURLParameter(context.getFormattedValue("TargetSiteUUID",null),context.getFormattedValue(getObject("TargetSite:DomainID"),null))).addURLParameter(context.getFormattedValue("ContentRepositoryUUID",null),context.getFormattedValue(getObject("ContentRepository:UUID"),null)).addURLParameter(context.getFormattedValue("SynchronizerToken",null),context.getFormattedValue(getObject("SessionSynchronizerToken"),null))),null)%>" class="button" id="sfe-configure-layer-fullsite" name="FullSitePreview" title="<%=context.getFormattedValue(localizeText(context.getFormattedValue("StorefrontPreviewLayer.StartsAFullSitePreviewWithTheSettingsAbove.link",null)),null)%>"><% {out.write(localizeISText("StorefrontPreviewLayer.FullSitePreview.link","",null,null,null,null,null,null,null,null,null,null,null));} %></a>
</td> 
</tr>
</table>
</td>
<td align="right">
<table border="0" cellspacing="4" cellpadding="0">
<tr>
<td class="button">
<input class="button" type="submit" id="sfe-configure-layer-submit" name="<% {String value = null;try{value=context.getFormattedValue(getObject("PreviewWebform:ID"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {112}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %>_submit" value="<%=context.getFormattedValue(localizeText(context.getFormattedValue("StorefrontPreviewLayer.OK.button",null)),null)%>" title="<%=context.getFormattedValue(localizeText(context.getFormattedValue("StorefrontPreviewLayer.StartsThePreviewWithTheAboveSettings.button",null)),null)%>"/>
</td>
<td class="button">
<a href="#" class="button" id="sfe-configure-layer-cancel" name="<% {String value = null;try{value=context.getFormattedValue(getObject("PreviewWebform:ID"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {115}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %>_cancel" title="<%=context.getFormattedValue(localizeText(context.getFormattedValue("StorefrontPreviewLayer.RevertsAllChangedSettings.link",null)),null)%>"><% {out.write(localizeISText("StorefrontPreviewLayer.Cancel.link","",null,null,null,null,null,null,null,null,null,null,null));} %></a>
</td> 
</tr>
</table>
</td>
</tr>
</table>
</div><% out.print("</form>"); %><p class="sfe-preview-loading"><img src="<%=context.getFormattedValue(context.webRoot(),null)%>/images/ajax-loader-small.gif" alt="<%=context.getFormattedValue(context.getFormattedValue(localizeText(context.getFormattedValue("StorefrontPreviewLayer.Loading.alt",null)),null) + context.getFormattedValue("...",null),null)%>" width="32" height="32" /><% {out.write(localizeISText("StorefrontPreviewLayer.Loading","",null,null,null,null,null,null,null,null,null,null,null));} %>...</p>
</div><% } else { %><!-- no PreviewWebform defined--><% } %><% _boolean_result=false;try {_boolean_result=((Boolean)(getObject("PreviewWebform:Submitted"))).booleanValue();} catch (Exception e) {Logger.debug(this,"Boolean expression in line {} could not be evaluated. False returned. Consider using the 'isDefined' ISML function.",129,e);}if (_boolean_result) { %></body>
</html><% } %><% printFooter(out); %>