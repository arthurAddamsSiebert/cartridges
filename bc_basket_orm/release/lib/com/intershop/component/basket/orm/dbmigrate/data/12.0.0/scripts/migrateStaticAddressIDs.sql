BEGIN

	-- ORDER
	UPDATE "ISORDER" o
	SET (o."INVOICETOADDRESSURN", o."SHIPTOADDRESSURN", o."SHIPFROMADDRESSURN", o."SERVICETOADDRESSURN", o."INSTALLTOADDRESSURN") = (
		SELECT
			NVL((SELECT sa."UUID" FROM "STATICADDRESS" sa WHERE o."INVOICETOADDRESSURN" = sa."ADDRESSID" AND o."UUID" = sa."LINEITEMCTNRID" AND ROWNUM = 1), o."INVOICETOADDRESSURN"),
			NVL((SELECT sa."UUID" FROM "STATICADDRESS" sa WHERE o."SHIPTOADDRESSURN" = sa."ADDRESSID" AND o."UUID" = sa."LINEITEMCTNRID" AND ROWNUM = 1), o."SHIPTOADDRESSURN"),
			NVL((SELECT sa."UUID" FROM "STATICADDRESS" sa WHERE o."SHIPFROMADDRESSURN" = sa."ADDRESSID" AND o."UUID" = sa."LINEITEMCTNRID" AND ROWNUM = 1), o."SHIPFROMADDRESSURN"),
			NVL((SELECT sa."UUID" FROM "STATICADDRESS" sa WHERE o."SERVICETOADDRESSURN" = sa."ADDRESSID" AND o."UUID" = sa."LINEITEMCTNRID" AND ROWNUM = 1), o."SERVICETOADDRESSURN"),
			NVL((SELECT sa."UUID" FROM "STATICADDRESS" sa WHERE o."INSTALLTOADDRESSURN" = sa."ADDRESSID" AND o."UUID" = sa."LINEITEMCTNRID" AND ROWNUM = 1), o."INSTALLTOADDRESSURN")
		FROM DUAL
	);


	-- PRODUCTLINEITEM
	UPDATE "PRODUCTLINEITEM" p
	SET (p."SHIPTOADDRESSURN", p."SHIPFROMADDRESSURN") = (
		SELECT
			NVL((SELECT sa."UUID" FROM "STATICADDRESS" sa WHERE p."SHIPTOADDRESSURN" = sa."ADDRESSID" AND p."LINEITEMCTNRID" = sa."LINEITEMCTNRID" AND ROWNUM = 1), p."SHIPTOADDRESSURN"),
			NVL((SELECT sa."UUID" FROM "STATICADDRESS" sa WHERE p."SHIPFROMADDRESSURN" = sa."ADDRESSID" AND p."LINEITEMCTNRID" = sa."LINEITEMCTNRID" AND ROWNUM = 1),  p."SHIPFROMADDRESSURN")
		FROM DUAL
	)
	WHERE EXISTS (
		SELECT 1
		FROM "ISORDER" o
		WHERE p."LINEITEMCTNRID" = o."UUID"
	);

	-- SERVICELINEITEM
	UPDATE "SERVICELINEITEM" s
	SET s."SHIPTOADDRESSURN" = NVL((SELECT sa."UUID" FROM "STATICADDRESS" sa WHERE s."SHIPTOADDRESSURN" = sa."ADDRESSID"	AND s."LINEITEMCTNRID" = sa."LINEITEMCTNRID" AND ROWNUM = 1), s."SHIPTOADDRESSURN")
	WHERE EXISTS (
		SELECT 1
		FROM "ISORDER" o
		WHERE s."LINEITEMCTNRID" = o."UUID"
	);

	COMMIT;

END;
/
