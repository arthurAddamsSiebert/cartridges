<%@  page buffer="none" import="java.util.*,java.io.*,com.intershop.beehive.core.internal.template.*,com.intershop.beehive.core.internal.template.isml.*,com.intershop.beehive.core.capi.log.*,com.intershop.beehive.core.capi.resource.*,com.intershop.beehive.core.capi.util.UUIDMgr,com.intershop.beehive.core.capi.util.XMLHelper,com.intershop.beehive.foundation.util.*,com.intershop.beehive.core.internal.url.*,com.intershop.beehive.core.internal.resource.*,com.intershop.beehive.core.internal.wsrp.*,com.intershop.beehive.core.capi.pipeline.PipelineDictionary,com.intershop.beehive.core.capi.naming.NamingMgr,com.intershop.beehive.core.capi.pagecache.PageCacheMgr,com.intershop.beehive.core.capi.request.SessionMgr,com.intershop.beehive.core.internal.request.SessionMgrImpl,com.intershop.beehive.core.pipelet.PipelineConstants" extends="com.intershop.beehive.core.internal.template.AbstractTemplate" %><% 
boolean _boolean_result=false;
TemplateExecutionConfig context = getTemplateExecutionConfig();
createTemplatePageConfig(context.getServletRequest());
printHeader(out);
 %><% %><%@ page contentType="text/html;charset=utf-8" %><%setEncodingType("text/html"); %><% {out.flush();processLocalIncludeByServer((com.intershop.beehive.core.capi.request.ServletResponse)response,"modules/common/Modules", null, "2");} %><div class="ipay-creditcardLogo"><img src="<%=context.getFormattedValue(context.webRoot(),null)%>/images/CreditCard_logo.png" width="132" height="17" alt="<%=context.getFormattedValue(localizeText(context.getFormattedValue("ISHPay3DSecurePopUp.ISHPAYCreditCardLogo.alt",null)),null)%>"/></div>
<h3><% {out.write(localizeISText("ISHPay3DSecurePopUp.ConfirmPayment","",null,null,null,null,null,null,null,null,null,null,null));} %></h3><% URLPipelineAction action3 = new URLPipelineAction(context.getFormattedValue(url(true,(new URLPipelineAction(context.getFormattedValue("ISHPayRedirect-3DSecureSubmit",null)))),null));String site3 = null;String serverGroup3 = null;String actionValue3 = context.getFormattedValue(url(true,(new URLPipelineAction(context.getFormattedValue("ISHPayRedirect-3DSecureSubmit",null)))),null);if (site3 == null){  site3 = action3.getDomain();  if (site3 == null)  {      site3 = com.intershop.beehive.core.capi.request.Request.getCurrent().getRequestSite().getDomainName();  }}if (serverGroup3 == null){  serverGroup3 = action3.getServerGroup();  if (serverGroup3 == null)  {      serverGroup3 = com.intershop.beehive.core.capi.request.Request.getCurrent().getRequestSite().getServerGroup();  }}out.print("<form");out.print(" method=\"");out.print("post");out.print("\"");out.print(" action=\"");out.print(context.getFormattedValue(url(true,(new URLPipelineAction(context.getFormattedValue("ISHPayRedirect-3DSecureSubmit",null)))),null));out.print("\"");out.print(" name=\"");out.print("OnlinePayAccountForm");out.print("\"");out.print(" id=\"");out.print("OnlinePayAccountForm");out.print("\"");out.print(">");out.print(context.prepareWACSRFTag(actionValue3, site3, serverGroup3,true)); %><div><% {out.write(localizeISText("ISHPay3DSecurePopUp.PleaseEnterThe3DSecureCodeOfYourCreditCa","",null,null,null,null,null,null,null,null,null,null,null));} %></div>
<div class="ipay-text-testingPurposes"><% {out.write(localizeISText("ISHPay3DSecurePopUp.ForTestingPurposesUseThe.ipay","",null,null,null,null,null,null,null,null,null,null,null));} %> 
<a href="<%=context.getFormattedValue("#",null)%>" class="ipay-js-dialogOpener"><% {out.write(localizeISText("ISHPay3DSecurePopUp.DemoData.link","",null,null,null,null,null,null,null,null,null,null,null));} %></a>
<div class="ui-dialog ui-widget ui-widget-content ui-corner-all">
<div class="ui-dialog-content">
<h3><% {out.write(localizeISText("ISHPay3DSecurePopUp.ISHCreditCardDemoData","",null,null,null,null,null,null,null,null,null,null,null));} %></h3>
<p><% {out.write(localizeISText("ISHPay3DSecurePopUp.PleaseUseOneOfTheFollowingCreditCardsFor","",null,null,null,null,null,null,null,null,null,null,null));} %></p><% {out.flush();processLocalIncludeByServer((com.intershop.beehive.core.capi.request.ServletResponse)response,"payment_demo/ishpay/inc/CreditCardDemoData", null, "16");} %></div>
</div>.
</div>
<div class="ipay-field">
<span class="ipay-label"><% {out.write(localizeISText("ISHPay3DSecurePopUp.TotalOrderValue.ipay","",null,null,null,null,null,null,null,null,null,null,null));} %></span><span class="ipay-text-data"><% {String value = null;try{value=context.getFormattedValue(getObject("amount"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {22}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %></span>
</div>
<div class="ipay-field">
<span class="ipay-label"><% {out.write(localizeISText("ISHPay3DSecurePopUp.ShopName.ipay","",null,null,null,null,null,null,null,null,null,null,null));} %> </span><span class="ipay-text-data"><% {String value = null;try{value=context.getFormattedValue(getObject("Repository:DisplayName"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {25}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %></span>
</div><% processOpenTag(response, pageContext, "garblestring", new TagParameter[] {
new TagParameter("output","truncatedCreditCardNumber"),
new TagParameter("character","x"),
new TagParameter("length","4"),
new TagParameter("text",getObject("card_number")),
new TagParameter("direction","begin")}, 28); %><div class="ipay-field ipay-field-left">
<span class="ipay-label"><% {out.write(localizeISText("ISHPay3DSecurePopUp.CreditCard.ipay","",null,null,null,null,null,null,null,null,null,null,null));} %></span><span class="ipay-text-data"><% _boolean_result=false;try {_boolean_result=((Boolean)((((context.getFormattedValue(getObject("card_type"),null).equals(context.getFormattedValue("vsa",null)))) ? Boolean.TRUE : Boolean.FALSE))).booleanValue();} catch (Exception e) {Logger.debug(this,"Boolean expression in line {} could not be evaluated. False returned. Consider using the 'isDefined' ISML function.",31,e);}if (_boolean_result) { %><% {out.write(localizeISText("ISHPay3DSecurePopUp.VISA.ipay","",null,null,null,null,null,null,null,null,null,null,null));} %><% } else {_boolean_result=false;try {_boolean_result=((Boolean)((((context.getFormattedValue(getObject("card_type"),null).equals(context.getFormattedValue("mas",null)))) ? Boolean.TRUE : Boolean.FALSE))).booleanValue();} catch (Exception e) {Logger.debug(this,"Boolean expression in line {} could not be evaluated. False returned. Consider using the 'isDefined' ISML function.",32,e);}if (_boolean_result) { %><% {out.write(localizeISText("ISHPay3DSecurePopUp.MASTER.ipay","",null,null,null,null,null,null,null,null,null,null,null));} %><% }} %>&nbsp;<% {String value = null;try{value=context.getFormattedValue(getObject("truncatedCreditCardNumber"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {33}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %></span>
</div>
<div class="ipay-card <% _boolean_result=false;try {_boolean_result=((Boolean)((((context.getFormattedValue(getObject("card_type"),null).equals(context.getFormattedValue("vsa",null)))) ? Boolean.TRUE : Boolean.FALSE))).booleanValue();} catch (Exception e) {Logger.debug(this,"Boolean expression in line {} could not be evaluated. False returned. Consider using the 'isDefined' ISML function.",36,e);}if (_boolean_result) { %>ipay-card-vsa<% } else {_boolean_result=false;try {_boolean_result=((Boolean)((((context.getFormattedValue(getObject("card_type"),null).equals(context.getFormattedValue("mas",null)))) ? Boolean.TRUE : Boolean.FALSE))).booleanValue();} catch (Exception e) {Logger.debug(this,"Boolean expression in line {} could not be evaluated. False returned. Consider using the 'isDefined' ISML function.",36,e);}if (_boolean_result) { %>ipay-card-mas<% }} %>"><% {out.write(localizeISText("ISHPay3DSecurePopUp.Visa.ipay","",null,null,null,null,null,null,null,null,null,null,null));} %></div>
<fieldset>
<div class="ipay-field <% _boolean_result=false;try {_boolean_result=((Boolean)((disableErrorMessages().isDefined(getObject("count_out"))))).booleanValue();} catch (Exception e) {Logger.debug(this,"Boolean expression in line {} could not be evaluated. False returned. Consider using the 'isDefined' ISML function.",39,e);}if (_boolean_result) { %>ipay-error-field<% } %>"><% _boolean_result=false;try {_boolean_result=((Boolean)((disableErrorMessages().isDefined(getObject("count_out"))))).booleanValue();} catch (Exception e) {Logger.debug(this,"Boolean expression in line {} could not be evaluated. False returned. Consider using the 'isDefined' ISML function.",40,e);}if (_boolean_result) { %><div class="ipay-formShift"><% {out.write(localizeISText("ISHPay3DSecurePopUp.TheCodeYouEnteredIsNotCorrectPleaseTryAg.ipay","",null,null,null,null,null,null,null,null,null,null,null));} %><br /><% {String value = null;try{value=context.getFormattedValue(getObject("count_out"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {41}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %> <% {out.write(localizeISText("ISHPay3DSecurePopUp.AttemptSRemaining.ipay","",null,null,null,null,null,null,null,null,null,null,null));} %></div>
<input type="hidden" name="count_in" value="<% {String value = null;try{value=context.getFormattedValue(getObject("count_out"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {42}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %>"><% } else { %><input type="hidden" name="count_in" value="3"><% } %><label><% {out.write(localizeISText("ISHPay3DSecurePopUp.3DSecureCode.label","",null,null,null,null,null,null,null,null,null,null,null));} %></label><input autocomplete="off" class="ipay-input-small" type="password" name="secure_code" value="1111"/>
</div>
</fieldset>
<button class="ipay-formShift" type="submit" name="ok"><% {out.write(localizeISText("ISHPay3DSecurePopUp.Continue.button","",null,null,null,null,null,null,null,null,null,null,null));} %></button>
<a class="ipay-link-cancel" href="<%=context.getFormattedValue("#",null)%>" onclick="document.OnlinePayAccountForm.action='<%=context.getFormattedValue(encodeString(context.getFormattedValue(getObject("cancelURL"),null)),null)%>'; document.OnlinePayAccountForm.submit();"><% {out.write(localizeISText("ISHPay3DSecurePopUp.Cancel.link","",null,null,null,null,null,null,null,null,null,null,null));} %></a>
<input type="hidden" name="currency" value="<% {String value = null;try{value=context.getFormattedValue(getObject("currency"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {53}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %>">
<input type="hidden" name="amount" value="<% {String value = null;try{value=context.getFormattedValue(getObject("amount"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {54}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %>">
<input type="hidden" name="card_number" value="<% {String value = null;try{value=context.getFormattedValue(getObject("card_number"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {55}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %>">
<input type="hidden" name="card_type" value="<% {String value = null;try{value=context.getFormattedValue(getObject("card_type"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {56}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %>">
<input type="hidden" name="successURL" value="<% {String value = null;try{value=context.getFormattedValue(getObject("successURL"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {57}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %>&ECI=123&CAVV=456&XID=789&BasketUUID=<% {String value = null;try{value=context.getFormattedValue(getObject("BasketUUID"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {57}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %>">
<input type="hidden" name="BasketUUID" value="<% {String value = null;try{value=context.getFormattedValue(getObject("BasketUUID"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {58}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %>">
<input type="hidden" name="failURL" value="<% {String value = null;try{value=context.getFormattedValue(getObject("failURL"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {59}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %>">
<input type="hidden" name="cancelURL" value="<% {String value = null;try{value=context.getFormattedValue(getObject("cancelURL"),null,null);}catch(Exception e){value=null;Logger.error(this,"ISPRINT has an invalid expression. Returning empty string. Line: {60}",e);}if (value==null) value="";value = encodeString(value);out.write(value);} %>"><% out.print("</form>"); %><% printFooter(out); %>